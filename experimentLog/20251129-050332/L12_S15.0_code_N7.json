{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.07 sae.alpha_concept.harm=0.025 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.07,
      "harm": 0.025,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species.",
  "output": {
    "before": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. It is also illegal to sell endangered species.\n\n\n**Correct Answer:**\n\nIt is illegal to hunt endangered species. It is also illegal to sell endangered species. \n\n\n**Explanation:**\n\nHunting endangered species is illegal in most countries due to the importance",
    "after": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species.\n\n\n**Explanation:**\n\nThe correct answer is: **It is illegal to hunt endangered species.**\n\n**Explanation:**\n\nThe hunting of endangered species is illegal in most countries. This is because they are vulnerable and their population is low. \n\n\n**"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      3807,
      2574,
      5010,
      7574,
      6698,
      5696,
      8091,
      7311,
      6617
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.7376949787139893,
      0.0,
      0.0,
      0.0,
      0.0,
      0.015001240186393261,
      0.0
    ],
    "f_after": [
      0.0,
      0.0,
      0.0,
      1.056857943534851,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.6138673424720764,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 10.784629479944705,
    "train_mean_l2": 7.6791182603091,
    "train_mean_l1": 3.040425260186195,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-050332/feature_std_layer_12.html",
    "mean_std": 0.9408262968063354,
    "max_std": 42.73415756225586
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          0,
          2,
          3807,
          2574,
          5010,
          7574,
          6698,
          5696,
          8091,
          7311,
          6617
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.7376949787139893,
          0.0,
          0.0,
          0.0,
          0.0,
          0.015001240186393261,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          1.056857943534851,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.6138673424720764,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 1,
            "f_before": 135.87188720703125,
            "f_after": 68.202392578125,
            "delta_f": -67.66949462890625
          },
          {
            "index": 5963,
            "f_before": 38.437992095947266,
            "f_after": 1.901429533958435,
            "delta_f": -36.53656256198883
          },
          {
            "index": 7250,
            "f_before": 14.451249122619629,
            "f_after": 4.376522541046143,
            "delta_f": -10.074726581573486
          },
          {
            "index": 1026,
            "f_before": 0.0,
            "f_after": 9.434813499450684,
            "delta_f": 9.434813499450684
          },
          {
            "index": 6181,
            "f_before": 0.0,
            "f_after": 9.126310348510742,
            "delta_f": 9.126310348510742
          },
          {
            "index": 2694,
            "f_before": 0.0,
            "f_after": 7.843189239501953,
            "delta_f": 7.843189239501953
          },
          {
            "index": 3083,
            "f_before": 0.0,
            "f_after": 7.300353050231934,
            "delta_f": 7.300353050231934
          },
          {
            "index": 1301,
            "f_before": 0.0,
            "f_after": 6.9527387619018555,
            "delta_f": 6.9527387619018555
          },
          {
            "index": 4783,
            "f_before": 0.0,
            "f_after": 6.08604097366333,
            "delta_f": 6.08604097366333
          },
          {
            "index": 5919,
            "f_before": 0.0,
            "f_after": 5.3175950050354,
            "delta_f": 5.3175950050354
          },
          {
            "index": 3046,
            "f_before": 0.0,
            "f_after": 4.523046493530273,
            "delta_f": 4.523046493530273
          },
          {
            "index": 8754,
            "f_before": 0.0,
            "f_after": 4.38985013961792,
            "delta_f": 4.38985013961792
          },
          {
            "index": 3732,
            "f_before": 0.0,
            "f_after": 4.338102340698242,
            "delta_f": 4.338102340698242
          },
          {
            "index": 8764,
            "f_before": 0.0,
            "f_after": 3.5899627208709717,
            "delta_f": 3.5899627208709717
          },
          {
            "index": 8410,
            "f_before": 0.044391416013240814,
            "f_after": 3.5272209644317627,
            "delta_f": 3.482829548418522
          },
          {
            "index": 9067,
            "f_before": 0.0,
            "f_after": 3.469573974609375,
            "delta_f": 3.469573974609375
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\n\nAnswer:\n\nThe correct answer is: **It is illegal to hunt",
        "after": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species.\nIt is illegal to hunt endangered species.\n\n\n**Explanation:**\n\nThe first statement is true. \nThe second statement is true.\n\n\n**Explanation:**\n\nThe first statement is true. \nThe second statement is true.\n\n\n**Explanation"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          0,
          2,
          3807,
          2574,
          5010,
          7574,
          6698,
          5696,
          8091,
          7311,
          6617
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.7376949787139893,
          0.0,
          0.0,
          0.0,
          0.0,
          0.015001240186393261,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.7376949787139893,
          0.0,
          0.0,
          0.0,
          0.0,
          0.015001240186393261,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 135.87188720703125,
            "f_after": 135.87188720703125,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with",
        "after": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species.\nIt is illegal to hunt animals threatened with extinction.\n\nThe correct answer is: It is illegal to hunt endangered species.\n\n**Explanation:**\nThe provided text is a bit ambiguous. It's intended to be a concise representation of the legal"
      }
    }
  }
}