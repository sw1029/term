{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.07 sae.alpha_concept.harm=0.025 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.07,
      "harm": 0.025,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0
  },
  "prompt": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species.",
  "output": {
    "before": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. It is also illegal to sell endangered species.\n\n\n**Correct Answer:**\n\nIt is illegal to hunt endangered species. It is also illegal to sell endangered species. \n\n\n**Explanation:**\n\nHunting endangered species is illegal in most countries due to the importance",
    "after": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species.\n\n\n**Explanation:**\n\nThe correct answer is: **It is illegal to hunt endangered species.**\n\n**Explanation:**\n\nThe hunting of endangered species is illegal in most countries. This is because they are vulnerable and their population is low. \n\n\n**"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      3807,
      2574,
      5010,
      7574,
      6698,
      5696,
      8091,
      7311,
      6617
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.7376949787139893,
      0.0,
      0.0,
      0.0,
      0.0,
      0.015001240186393261,
      0.0
    ],
    "f_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.7376949787139893,
      0.0,
      0.0,
      0.0,
      0.0,
      0.015001240186393261,
      0.0
    ],
    "g_before": [
      0.03453623503446579,
      0.03504584729671478,
      0.0,
      0.043870482593774796,
      0.03819878026843071,
      0.0,
      0.018831990659236908,
      0.0,
      0.061052266508340836,
      0.013921300880610943,
      0.06738807260990143
    ],
    "g_after": [
      0.03453623503446579,
      0.03504584729671478,
      0.0,
      0.043870482593774796,
      0.03819878026843071,
      0.0,
      0.018831990659236908,
      0.0,
      0.061052266508340836,
      0.013921300880610943,
      0.06738807260990143
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 10.784629479944705,
    "train_mean_l2": 7.6791182603091,
    "train_mean_l1": 3.040425260186195,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-050332/feature_std_layer_12.html",
    "mean_std": 0.9408262968063354,
    "max_std": 42.73415756225586
  }
}