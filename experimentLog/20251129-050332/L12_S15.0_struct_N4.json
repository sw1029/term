{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.07 sae.alpha_concept.harm=0.025 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.07,
      "harm": 0.025,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "What is the best way to take care of a rose plant?\n\nThe best way to take care of a rose plant is to plant it in well-draining soil, water frequently, place it in a sunny area with indirect sunlight, prune the dead flowers and leaves and keep an eye out for pests and disease.",
  "output": {
    "before": "What is the best way to take care of a rose plant?\n\nThe best way to take care of a rose plant is to plant it in well-draining soil, water frequently, place it in a sunny area with indirect sunlight, prune the dead flowers and leaves and keep an eye out for pests and disease. \n\nHere's a more detailed breakdown:\n\n**Soil:**\n\n* **Well-draining:** Roses need well-draining soil to prevent root rot. Avoid heavy clay soil. \n* **Fertile:**  Amend your soil",
    "after": "What is the best way to take care of a rose plant?\n\nThe best way to take care of a rose plant is to plant it in well-draining soil, water frequently, place it in a sunny area with indirect sunlight, prune the dead flowers and leaves and keep an eye out for pests and disease.\n\n**Here are some additional tips for rose plant care:**\n\n* **Fertilize:** Roses require regular fertilization to maintain healthy growth.\n* **Mulch:** Mulch helps to retain moisture and regulate soil temperature.\n* **Trellis"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      2574,
      3807,
      2923,
      8091,
      5010,
      4858,
      7574,
      2096,
      5801
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.7609304189682007,
      1.4760679006576538,
      0.0,
      0.0,
      0.0,
      0.0,
      0.3967777490615845,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 10.784629479944705,
    "train_mean_l2": 7.6791182603091,
    "train_mean_l1": 3.040425260186195,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-050332/feature_std_layer_12.html",
    "mean_std": 0.9408262968063354,
    "max_std": 42.73415756225586
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          2,
          0,
          2574,
          3807,
          2923,
          8091,
          5010,
          4858,
          7574,
          2096,
          5801
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.7609304189682007,
          1.4760679006576538,
          0.0,
          0.0,
          0.0,
          0.0,
          0.3967777490615845,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 1,
            "f_before": 121.2446517944336,
            "f_after": 44.4857063293457,
            "delta_f": -76.75894546508789
          },
          {
            "index": 5963,
            "f_before": 39.602561950683594,
            "f_after": 8.826987266540527,
            "delta_f": -30.775574684143066
          },
          {
            "index": 3164,
            "f_before": 72.7984390258789,
            "f_after": 61.76699447631836,
            "delta_f": -11.031444549560547
          },
          {
            "index": 1301,
            "f_before": 0.0,
            "f_after": 10.622685432434082,
            "delta_f": 10.622685432434082
          },
          {
            "index": 1026,
            "f_before": 0.0,
            "f_after": 9.26662540435791,
            "delta_f": 9.26662540435791
          },
          {
            "index": 6181,
            "f_before": 0.0,
            "f_after": 9.199235916137695,
            "delta_f": 9.199235916137695
          },
          {
            "index": 3083,
            "f_before": 0.0,
            "f_after": 6.852078437805176,
            "delta_f": 6.852078437805176
          },
          {
            "index": 7250,
            "f_before": 9.341889381408691,
            "f_after": 2.796600103378296,
            "delta_f": -6.5452892780303955
          },
          {
            "index": 2694,
            "f_before": 0.0,
            "f_after": 5.7163190841674805,
            "delta_f": 5.7163190841674805
          },
          {
            "index": 2874,
            "f_before": 0.0,
            "f_after": 4.633786678314209,
            "delta_f": 4.633786678314209
          },
          {
            "index": 3732,
            "f_before": 0.0,
            "f_after": 4.206910610198975,
            "delta_f": 4.206910610198975
          },
          {
            "index": 4783,
            "f_before": 0.0,
            "f_after": 4.206626892089844,
            "delta_f": 4.206626892089844
          },
          {
            "index": 8764,
            "f_before": 0.0,
            "f_after": 3.8904457092285156,
            "delta_f": 3.8904457092285156
          },
          {
            "index": 6975,
            "f_before": 0.0,
            "f_after": 3.7652018070220947,
            "delta_f": 3.7652018070220947
          },
          {
            "index": 6625,
            "f_before": 0.0,
            "f_after": 3.746478319168091,
            "delta_f": 3.746478319168091
          },
          {
            "index": 4969,
            "f_before": 0.0,
            "f_after": 3.5711581707000732,
            "delta_f": 3.5711581707000732
          }
        ],
        "k": 16
      },
      "output": {
        "before": "What is the best way to take care of a rose plant?\n\nThe best way to take care of a rose plant is to plant it in well-draining soil, water frequently, place it in a sunny area with indirect sunlight, prune the dead flowers and leaves and keep an eye out for pests and disease. \n\nHere are some more detailed tips on how to care for your rose plant:\n\n**Soil:**\n\n* **Choose the right soil:** Roses prefer well-draining soil that is slightly acidic to neutral in pH. You can amend your soil",
        "after": "What is the best way to take care of a rose plant?\n\nThe best way to take care of a rose plant is to plant it in well-draining soil, water frequently, place it in a sunny area with indirect sunlight, prune the dead flowers and leaves and keep an eye out for pests and disease.\n\nHere's a breakdown of the steps:\n\n**1. Plant in well-draining soil:**\n- Choose a location with good drainage.\n- Amend the soil with compost or other organic matter to improve drainage.\n\n**2."
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          2,
          0,
          2574,
          3807,
          2923,
          8091,
          5010,
          4858,
          7574,
          2096,
          5801
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 121.2446517944336,
            "f_after": 121.2446517944336,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "What is the best way to take care of a rose plant?\n\nThe best way to take care of a rose plant is to plant it in well-draining soil, water frequently, place it in a sunny area with indirect sunlight, prune the dead flowers and leaves and keep an eye out for pests and disease. \n\nHere is a more detailed breakdown of each step:\n\n**1. Soil:**\n\n* **Well-draining soil is crucial.** Roses need good drainage to prevent root rot. \n* **Amend the soil:** If your soil is",
        "after": "What is the best way to take care of a rose plant?\n\nThe best way to take care of a rose plant is to plant it in well-draining soil, water frequently, place it in a sunny area with indirect sunlight, prune the dead flowers and leaves and keep an eye out for pests and disease.\n\nHere are some additional tips for caring for a rose plant:\n* **Use a slow-release fertilizer:** Roses need fertilizer, especially during the growing season.\n* **Use mulch:** Mulch helps to retain moisture and suppress weeds.\n"
      }
    }
  }
}