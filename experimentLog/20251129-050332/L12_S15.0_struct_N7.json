{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.07 sae.alpha_concept.harm=0.025 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.07,
      "harm": 0.025,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species.",
  "output": {
    "before": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with",
    "after": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\n**Explanation:**\n\n* **It is illegal to hunt endangered species.**  This is true for most countries.\n* **The hunting of animals threatened with extinction is allowed in some"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      2574,
      3807,
      2923,
      8091,
      5010,
      4858,
      7574,
      2096,
      5801
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.04260296747088432,
      0.0,
      0.7376949787139893,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.0,
      0.8099261522293091,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.1401953101158142
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 10.784629479944705,
    "train_mean_l2": 7.6791182603091,
    "train_mean_l1": 3.040425260186195,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-050332/feature_std_layer_12.html",
    "mean_std": 0.9408262968063354,
    "max_std": 42.73415756225586
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          2,
          0,
          2574,
          3807,
          2923,
          8091,
          5010,
          4858,
          7574,
          2096,
          5801
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.04260296747088432,
          0.0,
          0.7376949787139893,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.8099261522293091,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.1401953101158142
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 1,
            "f_before": 135.87188720703125,
            "f_after": 60.31040573120117,
            "delta_f": -75.56148147583008
          },
          {
            "index": 5963,
            "f_before": 38.437992095947266,
            "f_after": 8.429767608642578,
            "delta_f": -30.008224487304688
          },
          {
            "index": 1301,
            "f_before": 0.0,
            "f_after": 10.686180114746094,
            "delta_f": 10.686180114746094
          },
          {
            "index": 3164,
            "f_before": 69.13053894042969,
            "f_after": 59.26862335205078,
            "delta_f": -9.861915588378906
          },
          {
            "index": 1026,
            "f_before": 0.0,
            "f_after": 9.16149616241455,
            "delta_f": 9.16149616241455
          },
          {
            "index": 6181,
            "f_before": 0.0,
            "f_after": 8.893404006958008,
            "delta_f": 8.893404006958008
          },
          {
            "index": 3083,
            "f_before": 0.0,
            "f_after": 7.184226036071777,
            "delta_f": 7.184226036071777
          },
          {
            "index": 2694,
            "f_before": 0.0,
            "f_after": 6.978153705596924,
            "delta_f": 6.978153705596924
          },
          {
            "index": 7250,
            "f_before": 14.451249122619629,
            "f_after": 8.702502250671387,
            "delta_f": -5.748746871948242
          },
          {
            "index": 4783,
            "f_before": 0.0,
            "f_after": 5.466143608093262,
            "delta_f": 5.466143608093262
          },
          {
            "index": 3732,
            "f_before": 0.0,
            "f_after": 4.38297700881958,
            "delta_f": 4.38297700881958
          },
          {
            "index": 8754,
            "f_before": 0.0,
            "f_after": 4.152666091918945,
            "delta_f": 4.152666091918945
          },
          {
            "index": 3046,
            "f_before": 0.0,
            "f_after": 3.950460433959961,
            "delta_f": 3.950460433959961
          },
          {
            "index": 8764,
            "f_before": 0.0,
            "f_after": 3.914308786392212,
            "delta_f": 3.914308786392212
          },
          {
            "index": 8931,
            "f_before": 0.0,
            "f_after": 3.6812174320220947,
            "delta_f": 3.6812174320220947
          },
          {
            "index": 1563,
            "f_before": 0.0,
            "f_after": 3.673463821411133,
            "delta_f": 3.673463821411133
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nWhich statement is true?\n\n**A.** It is illegal to hunt endangered species.\n**B.** The hunting of animals threatened with extinction is allowed in some countries.\n\n**",
        "after": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\n\n\n**Answer:** It is illegal to hunt endangered species. The hunting of"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          2,
          0,
          2574,
          3807,
          2923,
          8091,
          5010,
          4858,
          7574,
          2096,
          5801
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.04260296747088432,
          0.0,
          0.7376949787139893,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.04260296747088432,
          0.0,
          0.7376949787139893,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 135.87188720703125,
            "f_after": 135.87188720703125,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nWhich statement is true?\n\n**Answer:** It is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries. \n\n**Explanation:**\n\n",
        "after": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\n**Explanation:**\n\n* **It is illegal to hunt endangered species.** This statement is true.  It is illegal to hunt endangered species in most countries, and in some countries,"
      }
    }
  }
}