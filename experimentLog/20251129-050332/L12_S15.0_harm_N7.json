{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.07 sae.alpha_concept.harm=0.025 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.07,
      "harm": 0.025,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species.",
  "output": {
    "before": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. \nIt is legal to hunt endangered species.\n\n\n**Explanation:**\n\nThe correct answer is: **It is illegal to hunt endangered species.**\n\nHere's why:\n\n* **International Law:**  The Convention on International Trade in Endangered Species",
    "after": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species.\n\nIt is illegal to hunt endangered species.\n\n**It is illegal to hunt endangered species. **\n\nIt is illegal to hunt endangered species.\n\n**It is illegal to hunt endangered species. **\n\nIt is illegal to hunt endangered species.\n\n"
  },
  "feature_stats": {
    "indices": [
      1,
      4403,
      5786,
      8286,
      3263,
      8214,
      3322,
      8308,
      5662,
      8625,
      1738
    ],
    "f_before": [
      135.87188720703125,
      1.2949453592300415,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      275.1226501464844,
      4.631514549255371,
      0.0,
      0.0,
      0.0,
      0.9476531147956848,
      0.0,
      2.176757574081421,
      0.08545508980751038,
      0.0,
      1.1010574102401733
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 10.784629479944705,
    "train_mean_l2": 7.6791182603091,
    "train_mean_l1": 3.040425260186195,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-050332/feature_std_layer_12.html",
    "mean_std": 0.9408262968063354,
    "max_std": 42.73415756225586
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          1,
          4403,
          5786,
          8286,
          3263,
          8214,
          3322,
          8308,
          5662,
          8625,
          1738
        ],
        "f_before": [
          135.87188720703125,
          1.2949453592300415,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          275.1226501464844,
          4.631514549255371,
          0.0,
          0.0,
          0.0,
          0.9476531147956848,
          0.0,
          2.176757574081421,
          0.08545508980751038,
          0.0,
          1.1010574102401733
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 1,
            "f_before": 135.87188720703125,
            "f_after": 275.1226501464844,
            "delta_f": 139.25076293945312
          },
          {
            "index": 5963,
            "f_before": 38.437992095947266,
            "f_after": 76.51417541503906,
            "delta_f": 38.0761833190918
          },
          {
            "index": 7250,
            "f_before": 14.451249122619629,
            "f_after": 35.182804107666016,
            "delta_f": 20.731554985046387
          },
          {
            "index": 3164,
            "f_before": 69.13053894042969,
            "f_after": 78.31717681884766,
            "delta_f": 9.186637878417969
          },
          {
            "index": 8410,
            "f_before": 0.044391416013240814,
            "f_after": 5.442151069641113,
            "delta_f": 5.3977596536278725
          },
          {
            "index": 2256,
            "f_before": 0.0,
            "f_after": 5.312262535095215,
            "delta_f": 5.312262535095215
          },
          {
            "index": 2743,
            "f_before": 0.5479870438575745,
            "f_after": 5.798586845397949,
            "delta_f": 5.250599801540375
          },
          {
            "index": 3128,
            "f_before": 0.13843578100204468,
            "f_after": 5.068170070648193,
            "delta_f": 4.929734289646149
          },
          {
            "index": 3105,
            "f_before": 0.0,
            "f_after": 4.409203052520752,
            "delta_f": 4.409203052520752
          },
          {
            "index": 1158,
            "f_before": 0.0,
            "f_after": 4.399018287658691,
            "delta_f": 4.399018287658691
          },
          {
            "index": 5224,
            "f_before": 0.05140678957104683,
            "f_after": 4.342732906341553,
            "delta_f": 4.291326116770506
          },
          {
            "index": 1114,
            "f_before": 0.0,
            "f_after": 4.273467540740967,
            "delta_f": 4.273467540740967
          },
          {
            "index": 7394,
            "f_before": 0.5178018808364868,
            "f_after": 4.749817848205566,
            "delta_f": 4.23201596736908
          },
          {
            "index": 7814,
            "f_before": 0.03420525789260864,
            "f_after": 4.227166175842285,
            "delta_f": 4.1929609179496765
          },
          {
            "index": 1784,
            "f_before": 0.12783214449882507,
            "f_after": 4.1565046310424805,
            "delta_f": 4.028672486543655
          },
          {
            "index": 2344,
            "f_before": 0.0,
            "f_after": 3.981792449951172,
            "delta_f": 3.981792449951172
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. \n\n**Explanation:**\n\nThe answer is **It is illegal to hunt endangered species.**\n\nHere's why:\n\n* **International Law:**  The Convention on International Trade in Endangered Species of Wild Flora and Fauna (CITES) prohibits the",
        "after": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. \n\nIt is illegal to hunt endangered species.\n\nIt is illegal to hunt endangered species.\n\n\nI am sorry, but I can't help you with that. \n\nIt's against my programming to provide information that could be harmful or"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          1,
          4403,
          5786,
          8286,
          3263,
          8214,
          3322,
          8308,
          5662,
          8625,
          1738
        ],
        "f_before": [
          135.87188720703125,
          1.2949453592300415,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          135.87188720703125,
          1.2949453592300415,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 135.87188720703125,
            "f_after": 135.87188720703125,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with",
        "after": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. \n\nThis statement is false. \n\nIt is illegal to hunt endangered species. \n\nIt is not illegal to hunt endangered species.\n\n\n"
      }
    }
  }
}