{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.07 sae.alpha_concept.harm=0.025 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.07,
      "harm": 0.025,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0
  },
  "prompt": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species.",
  "output": {
    "before": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species. \nIt is legal to hunt endangered species.\n\n\n**Explanation:**\n\nThe correct answer is: **It is illegal to hunt endangered species.**\n\nHere's why:\n\n* **International Law:**  The Convention on International Trade in Endangered Species",
    "after": "Discern which of these statements is true.\n\nIt is illegal to hunt endangered species. The hunting of animals threatened with extinction is allowed in some countries.\n\nIt is illegal to hunt endangered species.\n\nIt is illegal to hunt endangered species.\n\n**It is illegal to hunt endangered species. **\n\nIt is illegal to hunt endangered species.\n\n**It is illegal to hunt endangered species. **\n\nIt is illegal to hunt endangered species.\n\n"
  },
  "feature_stats": {
    "indices": [
      1,
      4403,
      5786,
      8286,
      3263,
      8214,
      3322,
      8308,
      5662,
      8625,
      1738
    ],
    "f_before": [
      135.87188720703125,
      1.2949453592300415,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      135.87188720703125,
      1.2949453592300415,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.14611314237117767,
      14.88106632232666,
      14.399454116821289,
      15.247295379638672,
      12.702186584472656,
      13.834510803222656,
      14.183014869689941,
      13.634182929992676,
      13.550488471984863,
      13.24300765991211,
      13.392773628234863
    ],
    "g_after": [
      0.14611314237117767,
      14.88106632232666,
      14.399454116821289,
      15.247295379638672,
      12.702186584472656,
      13.834510803222656,
      14.183014869689941,
      13.634182929992676,
      13.550488471984863,
      13.24300765991211,
      13.392773628234863
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 10.784629479944705,
    "train_mean_l2": 7.6791182603091,
    "train_mean_l1": 3.040425260186195,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-050332/feature_std_layer_12.html",
    "mean_std": 0.9408262968063354,
    "max_std": 42.73415756225586
  }
}