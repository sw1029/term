{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "#!/usr/bin/env python3\n# -*- coding: utf-8 -*-\n#\n# michael a.g. aïvázis\n# orthologue\n# (c) 1998-2018 all rights reserved\n#\n\n\n\"\"\"\nSanity check: verify that the selector factory is accessible\n\"\"\"\n\n\ndef test():\n    from pyre.ipc import selector\n    return\n\n\n# main\nif __name__ == \"__main__\":\n    test()\n\n\n# end of file\n",
  "output": {
    "before": "#!/usr/bin/env python3\n# -*- coding: utf-8 -*-\n#\n# michael a.g. aïvázis\n# orthologue\n# (c) 1998-2018 all rights reserved\n#\n\n\n\"\"\"\nSanity check: verify that the selector factory is accessible\n\"\"\"\n\n\ndef test():\n    from pyre.ipc import selector\n    return\n\n\n# main\nif __name__ == \"__main__\":\n    test()\n\n\n# end of file\n```\n\n**Explanation:**\n\n* The code defines a simple function called `test()`.\n* The `test()` function attempts to import the `selector` module from the `pyre.ipc` package.\n* If the import is successful",
    "after": "#!/usr/bin/env python3\n# -*- coding: utf-8 -*-\n#\n# michael a.g. aïvázis\n# orthologue\n# (c) 1998-2018 all rights reserved\n#\n\n\n\"\"\"\nSanity check: verify that the selector factory is accessible\n\"\"\"\n\n\ndef test():\n    from pyre.ipc import selector\n    return\n\n\n# main\nif __name__ == \"__main__\":\n    test()\n\n\n# end of file\n```\n```python\n# -*- coding: utf-8 -*-\n#\n# michael a.g. aïvázis\n# orthologue\n# (c) 1998-2018 all rights reserved\n#"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      1910,
      1252,
      2402,
      7685,
      4960,
      2596,
      3032,
      9158,
      3117
    ],
    "f_before": [
      0.0,
      1.7688255310058594,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      8.21074104309082,
      0.0,
      0.0,
      0.0,
      0.0,
      0.9467049241065979,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 6.939608341667801,
    "train_mean_l2": 4.443336398821324,
    "train_mean_l1": 2.1083986597806215,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-111552/feature_std_layer_12.html",
    "mean_std": 0.8172351121902466,
    "max_std": 19.625080108642578
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          2,
          0,
          1910,
          1252,
          2402,
          7685,
          4960,
          2596,
          3032,
          9158,
          3117
        ],
        "f_before": [
          0.0,
          1.7688255310058594,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          8.21074104309082,
          0.0,
          0.0,
          0.0,
          0.0,
          0.9467049241065979,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 2718,
            "f_before": 0.0,
            "f_after": 11.046487808227539,
            "delta_f": 11.046487808227539
          },
          {
            "index": 2158,
            "f_before": 0.0,
            "f_after": 8.523699760437012,
            "delta_f": 8.523699760437012
          },
          {
            "index": 6011,
            "f_before": 0.0,
            "f_after": 8.41835880279541,
            "delta_f": 8.41835880279541
          },
          {
            "index": 1462,
            "f_before": 7.219725608825684,
            "f_after": 15.231324195861816,
            "delta_f": 8.011598587036133
          },
          {
            "index": 130,
            "f_before": 0.0,
            "f_after": 7.4797492027282715,
            "delta_f": 7.4797492027282715
          },
          {
            "index": 5244,
            "f_before": 0.0,
            "f_after": 7.474708080291748,
            "delta_f": 7.474708080291748
          },
          {
            "index": 2091,
            "f_before": 0.0,
            "f_after": 7.456870079040527,
            "delta_f": 7.456870079040527
          },
          {
            "index": 9004,
            "f_before": 0.0,
            "f_after": 7.0739030838012695,
            "delta_f": 7.0739030838012695
          },
          {
            "index": 8310,
            "f_before": 0.0,
            "f_after": 6.532405376434326,
            "delta_f": 6.532405376434326
          },
          {
            "index": 0,
            "f_before": 1.7688255310058594,
            "f_after": 8.21074104309082,
            "delta_f": 6.441915512084961
          },
          {
            "index": 7966,
            "f_before": 0.0,
            "f_after": 6.059134483337402,
            "delta_f": 6.059134483337402
          },
          {
            "index": 8171,
            "f_before": 0.0,
            "f_after": 5.865888595581055,
            "delta_f": 5.865888595581055
          },
          {
            "index": 783,
            "f_before": 31.921117782592773,
            "f_after": 37.691776275634766,
            "delta_f": 5.770658493041992
          },
          {
            "index": 5433,
            "f_before": 0.0,
            "f_after": 5.695941925048828,
            "delta_f": 5.695941925048828
          },
          {
            "index": 9142,
            "f_before": 5.329286575317383,
            "f_after": 0.0,
            "delta_f": -5.329286575317383
          },
          {
            "index": 3001,
            "f_before": 0.0,
            "f_after": 5.018558979034424,
            "delta_f": 5.018558979034424
          }
        ],
        "k": 16
      },
      "output": {
        "before": "#!/usr/bin/env python3\n# -*- coding: utf-8 -*-\n#\n# michael a.g. aïvázis\n# orthologue\n# (c) 1998-2018 all rights reserved\n#\n\n\n\"\"\"\nSanity check: verify that the selector factory is accessible\n\"\"\"\n\n\ndef test():\n    from pyre.ipc import selector\n    return\n\n\n# main\nif __name__ == \"__main__\":\n    test()\n\n\n# end of file\n```\n",
        "after": "#!/usr/bin/env python3\n# -*- coding: utf-8 -*-\n#\n# michael a.g. aïvázis\n# orthologue\n# (c) 1998-2018 all rights reserved\n#\n\n\n\"\"\"\nSanity check: verify that the selector factory is accessible\n\"\"\"\n\n\ndef test():\n    from pyre.ipc import selector\n    return\n\n\n# main\nif __name__ == \"__main__\":\n    test()\n\n\n# end of file\n```\n\n**Explanation:**\n\n* **Imports:** The code starts by importing the necessary modules:\n    * `pyre.ipc`: This module provides the IPC (Inter-Process Communication) interface, which allows communication between processes.\n    *"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          2,
          0,
          1910,
          1252,
          2402,
          7685,
          4960,
          2596,
          3032,
          9158,
          3117
        ],
        "f_before": [
          0.0,
          1.7688255310058594,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          1.7688255310058594,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 1.7688255310058594,
            "f_after": 1.7688255310058594,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "#!/usr/bin/env python3\n# -*- coding: utf-8 -*-\n#\n# michael a.g. aïvázis\n# orthologue\n# (c) 1998-2018 all rights reserved\n#\n\n\n\"\"\"\nSanity check: verify that the selector factory is accessible\n\"\"\"\n\n\ndef test():\n    from pyre.ipc import selector\n    return\n\n\n# main\nif __name__ == \"__main__\":\n    test()\n\n\n# end of file\n\"\"\"\n\nThis script tests whether the selector factory is accessible. It does this by importing the selector module from the pyre.ipc package and then calling the test function. \n\n\nHere's how it works:\n1. **Import the Selector",
        "after": "#!/usr/bin/env python3\n# -*- coding: utf-8 -*-\n#\n# michael a.g. aïvázis\n# orthologue\n# (c) 1998-2018 all rights reserved\n#\n\n\n\"\"\"\nSanity check: verify that the selector factory is accessible\n\"\"\"\n\n\ndef test():\n    from pyre.ipc import selector\n    return\n\n\n# main\nif __name__ == \"__main__\":\n    test()\n\n\n# end of file\n```\nThis is a simple Python script that checks if the selector factory is accessible.\n\n\nThe script uses the following code:\n- `from pyre.ipc import selector`: This line imports the `selector` module from the `pyre."
      }
    }
  }
}