{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "python main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035 sae.alpha_concept.code=0.08499999999999999 sae.alpha_concept.harm=0.005 sae.alpha_concept.struct=0.0",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.08499999999999999,
      "harm": 0.005,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Based on the provided input paragraph, provide a summary of its content.\n\nThe number of wildfires have dramatically increased in the last decade due to climate change. The fires are often spread in remote areas and the infrastructures can't control them. The consequences of these fires lead to loss of flora and hazardous air quality.\n\nWildfires have been increasing in recent years due to climate change, affecting remote areas and causing destruction of flora, as well as unhealthy air quality. Infrastructures are ill-equipped to handle the growing number of fires.",
  "output": {
    "before": "Based on the provided input paragraph, provide a summary of its content.\n\nThe number of wildfires have dramatically increased in the last decade due to climate change. The fires are often spread in remote areas and the infrastructures can't control them. The consequences of these fires lead to loss of flora and hazardous air quality.\n\nWildfires have been increasing in recent years due to climate change, affecting remote areas and causing destruction of flora, as well as unhealthy air quality. Infrastructures are ill-equipped to handle the growing number of fires. \n\n\n**Summary:**\n\nWildfires are becoming increasingly common due to climate change, particularly in remote areas.  This causes damage to vegetation and produces poor air quality. The current infrastructure is insufficient to manage the rising number of wildfires. \n\n\n**",
    "after": "Based on the provided input paragraph, provide a summary of its content.\n\nThe number of wildfires have dramatically increased in the last decade due to climate change. The fires are often spread in remote areas and the infrastructures can't control them. The consequences of these fires lead to loss of flora and hazardous air quality.\n\nWildfires have been increasing in recent years due to climate change, affecting remote areas and causing destruction of flora, as well as unhealthy air quality. Infrastructures are ill-equipped to handle the growing number of fires.\n```\n"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      319,
      4644,
      5581,
      8045,
      5260,
      5865,
      3340,
      1219,
      1926
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      167.5652618408203,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 7.917636237114202,
    "train_mean_l2": 7.317154650665819,
    "train_mean_l1": 3.294309435009956,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-062652/feature_std_layer_12.html",
    "mean_std": 1.9138238430023193,
    "max_std": 59.75885772705078
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          0,
          2,
          319,
          4644,
          5581,
          8045,
          5260,
          5865,
          3340,
          1219,
          1926
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          167.5652618408203,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 167.5652618408203,
            "delta_f": 167.5652618408203
          },
          {
            "index": 5467,
            "f_before": 51.24641036987305,
            "f_after": 11.530561447143555,
            "delta_f": -39.71584892272949
          },
          {
            "index": 6441,
            "f_before": 30.08844566345215,
            "f_after": 0.0,
            "delta_f": -30.08844566345215
          },
          {
            "index": 1710,
            "f_before": 134.83111572265625,
            "f_after": 156.7261962890625,
            "delta_f": 21.89508056640625
          },
          {
            "index": 188,
            "f_before": 0.0,
            "f_after": 13.24887752532959,
            "delta_f": 13.24887752532959
          },
          {
            "index": 231,
            "f_before": 0.0,
            "f_after": 13.032308578491211,
            "delta_f": 13.032308578491211
          },
          {
            "index": 5531,
            "f_before": 0.0,
            "f_after": 10.304837226867676,
            "delta_f": 10.304837226867676
          },
          {
            "index": 2049,
            "f_before": 0.0,
            "f_after": 9.184032440185547,
            "delta_f": 9.184032440185547
          },
          {
            "index": 5119,
            "f_before": 0.0,
            "f_after": 7.338152885437012,
            "delta_f": 7.338152885437012
          },
          {
            "index": 4864,
            "f_before": 0.0,
            "f_after": 7.02902364730835,
            "delta_f": 7.02902364730835
          },
          {
            "index": 6250,
            "f_before": 0.0,
            "f_after": 6.780826568603516,
            "delta_f": 6.780826568603516
          },
          {
            "index": 4464,
            "f_before": 0.0,
            "f_after": 6.597808837890625,
            "delta_f": 6.597808837890625
          },
          {
            "index": 1,
            "f_before": 20.32989501953125,
            "f_after": 14.023421287536621,
            "delta_f": -6.306473731994629
          },
          {
            "index": 7695,
            "f_before": 0.0,
            "f_after": 5.8203864097595215,
            "delta_f": 5.8203864097595215
          },
          {
            "index": 9015,
            "f_before": 0.0,
            "f_after": 5.779488563537598,
            "delta_f": 5.779488563537598
          },
          {
            "index": 5032,
            "f_before": 0.0,
            "f_after": 5.536172389984131,
            "delta_f": 5.536172389984131
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Based on the provided input paragraph, provide a summary of its content.\n\nThe number of wildfires have dramatically increased in the last decade due to climate change. The fires are often spread in remote areas and the infrastructures can't control them. The consequences of these fires lead to loss of flora and hazardous air quality.\n\nWildfires have been increasing in recent years due to climate change, affecting remote areas and causing destruction of flora, as well as unhealthy air quality. Infrastructures are ill-equipped to handle the growing number of fires. \n",
        "after": "Based on the provided input paragraph, provide a summary of its content.\n\nThe number of wildfires have dramatically increased in the last decade due to climate change. The fires are often spread in remote areas and the infrastructures can't control them. The consequences of these fires lead to loss of flora and hazardous air quality.\n\nWildfires have been increasing in recent years due to climate change, affecting remote areas and causing destruction of flora, as well as unhealthy air quality. Infrastructures are ill-equipped to handle the growing number of fires.\n\n\n**Please note:** This code is designed to be used for the purpose of providing a summary of the provided input paragraph. \n\n\n**Please Note:**\n* The code is designed to be used for the purpose of providing a summary of the provided"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          0,
          2,
          319,
          4644,
          5581,
          8045,
          5260,
          5865,
          3340,
          1219,
          1926
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 20.32989501953125,
            "f_after": 20.32989501953125,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Based on the provided input paragraph, provide a summary of its content.\n\nThe number of wildfires have dramatically increased in the last decade due to climate change. The fires are often spread in remote areas and the infrastructures can't control them. The consequences of these fires lead to loss of flora and hazardous air quality.\n\nWildfires have been increasing in recent years due to climate change, affecting remote areas and causing destruction of flora, as well as unhealthy air quality. Infrastructures are ill-equipped to handle the growing number of fires. \n",
        "after": "Based on the provided input paragraph, provide a summary of its content.\n\nThe number of wildfires have dramatically increased in the last decade due to climate change. The fires are often spread in remote areas and the infrastructures can't control them. The consequences of these fires lead to loss of flora and hazardous air quality.\n\nWildfires have been increasing in recent years due to climate change, affecting remote areas and causing destruction of flora, as well as unhealthy air quality. Infrastructures are ill-equipped to handle the growing number of fires. \n"
      }
    }
  }
}