{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "python main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035 sae.alpha_concept.code=0.08499999999999999 sae.alpha_concept.harm=0.005 sae.alpha_concept.struct=0.0",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.08499999999999999,
      "harm": 0.005,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Explain how customer segmentation is used in marketing.\n\nCustomer segmentation is the process of dividing customers into groups based on their characteristics, behaviors and preferences. Marketers use this segmentation to create targeted campaigns designed to appeal to each demographic segment's wants, needs and interests in order to increase response rates and conversions. With customer segmentation, marketers can more accurately identify customer needs, better target campaigns and tailor messages to different target audiences, resulting in higher response rates, greater engagement, and ultimately more conversions.",
  "output": {
    "before": "Explain how customer segmentation is used in marketing.\n\nCustomer segmentation is the process of dividing customers into groups based on their characteristics, behaviors and preferences. Marketers use this segmentation to create targeted campaigns designed to appeal to each demographic segment's wants, needs and interests in order to increase response rates and conversions. With customer segmentation, marketers can more accurately identify customer needs, better target campaigns and tailor messages to different target audiences, resulting in higher response rates, greater engagement, and ultimately more conversions. \n\nHere's a breakdown of how customer segmentation is used in marketing:\n\n**1. Identifying Customer Segments:**\n   * **Demographic:** Age, gender, location, income, education, occupation, family size, etc.\n   *",
    "after": "Explain how customer segmentation is used in marketing.\n\nCustomer segmentation is the process of dividing customers into groups based on their characteristics, behaviors and preferences. Marketers use this segmentation to create targeted campaigns designed to appeal to each demographic segment's wants, needs and interests in order to increase response rates and conversions. With customer segmentation, marketers can more accurately identify customer needs, better target campaigns and tailor messages to different target audiences, resulting in higher response rates, greater engagement, and ultimately more conversions.\n\nHere's a breakdown of how customer segmentation is used in marketing:\n\n**1. Identify key customer segments:**\n   - Define the characteristics of each segment based on demographics, behaviors, preferences, and other relevant factors.\n\n**2."
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      3252,
      5126,
      5581,
      7650,
      3340,
      6104,
      2706,
      9211,
      8960
    ],
    "f_before": [
      0.0,
      0.0,
      0.45552077889442444,
      0.0,
      0.12381495535373688,
      0.0,
      0.0,
      0.2924291789531708,
      0.0,
      0.0,
      1.1216458082199097
    ],
    "f_after": [
      0.0,
      129.1972198486328,
      1.1471264362335205,
      0.0,
      0.0,
      0.0,
      0.0,
      0.14781005680561066,
      0.0,
      0.0,
      1.338458776473999
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 7.917636237114202,
    "train_mean_l2": 7.317154650665819,
    "train_mean_l1": 3.294309435009956,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-062652/feature_std_layer_12.html",
    "mean_std": 1.9138238430023193,
    "max_std": 59.75885772705078
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          2,
          0,
          3252,
          5126,
          5581,
          7650,
          3340,
          6104,
          2706,
          9211,
          8960
        ],
        "f_before": [
          0.0,
          0.0,
          0.45552077889442444,
          0.0,
          0.12381495535373688,
          0.0,
          0.0,
          0.2924291789531708,
          0.0,
          0.0,
          1.1216458082199097
        ],
        "f_after": [
          0.0,
          129.1972198486328,
          1.1471264362335205,
          0.0,
          0.0,
          0.0,
          0.0,
          0.14781005680561066,
          0.0,
          0.0,
          1.338458776473999
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 129.1972198486328,
            "delta_f": 129.1972198486328
          },
          {
            "index": 5467,
            "f_before": 34.82366180419922,
            "f_after": 0.0,
            "delta_f": -34.82366180419922
          },
          {
            "index": 6441,
            "f_before": 23.049175262451172,
            "f_after": 0.22217552363872528,
            "delta_f": -22.826999738812447
          },
          {
            "index": 188,
            "f_before": 0.0,
            "f_after": 19.427091598510742,
            "delta_f": 19.427091598510742
          },
          {
            "index": 231,
            "f_before": 0.0,
            "f_after": 14.522298812866211,
            "delta_f": 14.522298812866211
          },
          {
            "index": 5531,
            "f_before": 0.0,
            "f_after": 10.398813247680664,
            "delta_f": 10.398813247680664
          },
          {
            "index": 2049,
            "f_before": 0.0,
            "f_after": 9.22869873046875,
            "delta_f": 9.22869873046875
          },
          {
            "index": 4864,
            "f_before": 0.0,
            "f_after": 7.057713031768799,
            "delta_f": 7.057713031768799
          },
          {
            "index": 6250,
            "f_before": 0.0,
            "f_after": 6.841133117675781,
            "delta_f": 6.841133117675781
          },
          {
            "index": 4464,
            "f_before": 0.0,
            "f_after": 6.795812129974365,
            "delta_f": 6.795812129974365
          },
          {
            "index": 9015,
            "f_before": 0.0,
            "f_after": 6.389277935028076,
            "delta_f": 6.389277935028076
          },
          {
            "index": 7289,
            "f_before": 0.0,
            "f_after": 5.670265197753906,
            "delta_f": 5.670265197753906
          },
          {
            "index": 252,
            "f_before": 0.0,
            "f_after": 5.633481979370117,
            "delta_f": 5.633481979370117
          },
          {
            "index": 2898,
            "f_before": 0.0,
            "f_after": 5.576473236083984,
            "delta_f": 5.576473236083984
          },
          {
            "index": 1,
            "f_before": 20.011396408081055,
            "f_after": 14.584454536437988,
            "delta_f": -5.426941871643066
          },
          {
            "index": 5119,
            "f_before": 0.0,
            "f_after": 5.240619659423828,
            "delta_f": 5.240619659423828
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Explain how customer segmentation is used in marketing.\n\nCustomer segmentation is the process of dividing customers into groups based on their characteristics, behaviors and preferences. Marketers use this segmentation to create targeted campaigns designed to appeal to each demographic segment's wants, needs and interests in order to increase response rates and conversions. With customer segmentation, marketers can more accurately identify customer needs, better target campaigns and tailor messages to different target audiences, resulting in higher response rates, greater engagement, and ultimately more conversions.\n\nHere's a breakdown of how customer segmentation is used in marketing:\n\n**1. Identify key customer segments:**\n- **Demographic segmentation:** Age, gender, location, income, education, occupation, etc.\n- **Psychographic segmentation",
        "after": "Explain how customer segmentation is used in marketing.\n\nCustomer segmentation is the process of dividing customers into groups based on their characteristics, behaviors and preferences. Marketers use this segmentation to create targeted campaigns designed to appeal to each demographic segment's wants, needs and interests in order to increase response rates and conversions. With customer segmentation, marketers can more accurately identify customer needs, better target campaigns and tailor messages to different target audiences, resulting in higher response rates, greater engagement, and ultimately more conversions. \n\nHere's how customer segmentation is used in marketing:\n\n* **Identify Target Customers:** Segmentation allows marketers to identify their target customers and understand their needs and preferences. This helps to focus marketing efforts on the right customers.\n* **Develop"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          2,
          0,
          3252,
          5126,
          5581,
          7650,
          3340,
          6104,
          2706,
          9211,
          8960
        ],
        "f_before": [
          0.0,
          0.0,
          0.45552077889442444,
          0.0,
          0.12381495535373688,
          0.0,
          0.0,
          0.2924291789531708,
          0.0,
          0.0,
          1.1216458082199097
        ],
        "f_after": [
          0.0,
          0.0,
          0.45552077889442444,
          0.0,
          0.12381495535373688,
          0.0,
          0.0,
          0.2924291789531708,
          0.0,
          0.0,
          1.1216458082199097
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 20.011396408081055,
            "f_after": 20.011396408081055,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 1.2947183847427368,
            "f_after": 1.2947183847427368,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Explain how customer segmentation is used in marketing.\n\nCustomer segmentation is the process of dividing customers into groups based on their characteristics, behaviors and preferences. Marketers use this segmentation to create targeted campaigns designed to appeal to each demographic segment's wants, needs and interests in order to increase response rates and conversions. With customer segmentation, marketers can more accurately identify customer needs, better target campaigns and tailor messages to different target audiences, resulting in higher response rates, greater engagement, and ultimately more conversions.\n\n**Here's a breakdown of how it's used:**\n\n**1. Identify Key Customer Segments:**\n\n* **Demographic Segmentation:** Age, gender, location, income, education, occupation.\n* **Psychographic Segmentation:** Lifestyle,",
        "after": "Explain how customer segmentation is used in marketing.\n\nCustomer segmentation is the process of dividing customers into groups based on their characteristics, behaviors and preferences. Marketers use this segmentation to create targeted campaigns designed to appeal to each demographic segment's wants, needs and interests in order to increase response rates and conversions. With customer segmentation, marketers can more accurately identify customer needs, better target campaigns and tailor messages to different target audiences, resulting in higher response rates, greater engagement, and ultimately more conversions.\n\n**Here's how customer segmentation is used in marketing:**\n\n**1. Identifying Customer Segments:**\n- **Demographic Segmentation:** Age, gender, location, income, education, etc.\n- **Behavioral Segmentation:** Purchasing behavior, website usage"
      }
    }
  }
}