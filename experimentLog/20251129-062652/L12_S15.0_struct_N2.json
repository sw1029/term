{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "python main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035 sae.alpha_concept.code=0.08499999999999999 sae.alpha_concept.harm=0.005 sae.alpha_concept.struct=0.0",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.08499999999999999,
      "harm": 0.005,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Create a limerick about cats.\n\nA cat who lived at a monast'ry\nSaw hunting as a pleasurable past'ry\nBut the mice all ran\nFrom this feisty young man\nAnd thought better than to tangle with him fast'ry!",
  "output": {
    "before": "Create a limerick about cats.\n\nA cat who lived at a monast'ry\nSaw hunting as a pleasurable past'ry\nBut the mice all ran\nFrom this feisty young man\nAnd thought better than to tangle with him fast'ry! \n\nLet me know if you'd like me to try another limerick! \n",
    "after": "Create a limerick about cats.\n\nA cat who lived at a monast'ry\nSaw hunting as a pleasurable past'ry\nBut the mice all ran\nFrom this feisty young man\nAnd thought better than to tangle with him fast'ry!\n\n**Please note:**  This limerick is for your amusement.\n\n\nThis is the Limericks.\nThis is the Limericks.\n\n\nPlease let me know if you have any other requests."
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      3252,
      5126,
      5581,
      7650,
      3340,
      6104,
      2706,
      9211,
      8960
    ],
    "f_before": [
      0.0,
      13.776054382324219,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      155.884521484375,
      0.0,
      0.2389538735151291,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 7.917636237114202,
    "train_mean_l2": 7.317154650665819,
    "train_mean_l1": 3.294309435009956,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-062652/feature_std_layer_12.html",
    "mean_std": 1.9138238430023193,
    "max_std": 59.75885772705078
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          2,
          0,
          3252,
          5126,
          5581,
          7650,
          3340,
          6104,
          2706,
          9211,
          8960
        ],
        "f_before": [
          0.0,
          13.776054382324219,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          155.884521484375,
          0.0,
          0.2389538735151291,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 0,
            "f_before": 13.776054382324219,
            "f_after": 155.884521484375,
            "delta_f": 142.10846710205078
          },
          {
            "index": 5467,
            "f_before": 31.591753005981445,
            "f_after": 0.0,
            "delta_f": -31.591753005981445
          },
          {
            "index": 188,
            "f_before": 0.0,
            "f_after": 25.340133666992188,
            "delta_f": 25.340133666992188
          },
          {
            "index": 6441,
            "f_before": 21.656145095825195,
            "f_after": 0.0,
            "delta_f": -21.656145095825195
          },
          {
            "index": 231,
            "f_before": 0.0,
            "f_after": 15.704062461853027,
            "delta_f": 15.704062461853027
          },
          {
            "index": 5531,
            "f_before": 0.0,
            "f_after": 10.28602123260498,
            "delta_f": 10.28602123260498
          },
          {
            "index": 2049,
            "f_before": 0.0,
            "f_after": 9.689111709594727,
            "delta_f": 9.689111709594727
          },
          {
            "index": 6250,
            "f_before": 0.0,
            "f_after": 7.206161975860596,
            "delta_f": 7.206161975860596
          },
          {
            "index": 4464,
            "f_before": 0.0,
            "f_after": 7.1437554359436035,
            "delta_f": 7.1437554359436035
          },
          {
            "index": 7695,
            "f_before": 0.0,
            "f_after": 6.676770210266113,
            "delta_f": 6.676770210266113
          },
          {
            "index": 4864,
            "f_before": 0.0,
            "f_after": 6.17359733581543,
            "delta_f": 6.17359733581543
          },
          {
            "index": 1,
            "f_before": 21.574642181396484,
            "f_after": 15.61279010772705,
            "delta_f": -5.961852073669434
          },
          {
            "index": 9015,
            "f_before": 0.0,
            "f_after": 5.776865482330322,
            "delta_f": 5.776865482330322
          },
          {
            "index": 5119,
            "f_before": 0.0,
            "f_after": 5.696951866149902,
            "delta_f": 5.696951866149902
          },
          {
            "index": 2562,
            "f_before": 0.0,
            "f_after": 5.430534362792969,
            "delta_f": 5.430534362792969
          },
          {
            "index": 8710,
            "f_before": 0.0,
            "f_after": 5.2631330490112305,
            "delta_f": 5.2631330490112305
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Create a limerick about cats.\n\nA cat who lived at a monast'ry\nSaw hunting as a pleasurable past'ry\nBut the mice all ran\nFrom this feisty young man\nAnd thought better than to tangle with him fast'ry! \n\n**Explanation:**\n\n* **Rhyme scheme:** The limerick follows the AABBA rhyme scheme. \n* **Rhythm:** The rhythm is typically iambic, with an emphasis on the first and third syllables of each line.",
        "after": "Create a limerick about cats.\n\nA cat who lived at a monast'ry\nSaw hunting as a pleasurable past'ry\nBut the mice all ran\nFrom this feisty young man\nAnd thought better than to tangle with him fast'ry!\n\n\n**Explanation:**\n\n* **A cat who lived at a monast'ry:**  Establishes the location of the cat.\n* **Saw hunting as a pleasurable past'ry:**  Highlights the cat's hunting habits.\n* **"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          2,
          0,
          3252,
          5126,
          5581,
          7650,
          3340,
          6104,
          2706,
          9211,
          8960
        ],
        "f_before": [
          0.0,
          13.776054382324219,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          13.776054382324219,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.6149458289146423,
            "f_after": 0.6149458289146423,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.39525315165519714,
            "f_after": 0.39525315165519714,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 21.574642181396484,
            "f_after": 21.574642181396484,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.8286535143852234,
            "f_after": 0.8286535143852234,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 13.776054382324219,
            "f_after": 13.776054382324219,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Create a limerick about cats.\n\nA cat who lived at a monast'ry\nSaw hunting as a pleasurable past'ry\nBut the mice all ran\nFrom this feisty young man\nAnd thought better than to tangle with him fast'ry! \n",
        "after": "Create a limerick about cats.\n\nA cat who lived at a monast'ry\nSaw hunting as a pleasurable past'ry\nBut the mice all ran\nFrom this feisty young man\nAnd thought better than to tangle with him fast'ry!\n\nThis is a sample, you can use it as a starting point, \nand customize it to your liking.\n\n**Key:**\n* **Limerick Structure:**  5 lines with 8-12 characters per line.\n*"
      }
    }
  }
}