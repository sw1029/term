{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "python main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.04 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.0002314673387520083 sae.role_sep_coeff=0.002",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0002314673387520083,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.04,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.002
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "\n\"\"\" \nSet up the plot figures, axes, and items to be done for each frame.\n\nThis module is imported by the plotting routines and then the\nfunction setplot is called to set the plot parameters.\n    \n\"\"\" \n\n#--------------------------\ndef setplot(plotdata=None):\n#--------------------------\n    \n    \"\"\" \n    Specify what is to be plotted at each frame.\n    Input:  plotdata, an instance of pyclaw.plotters.data.ClawPlotData.\n    Output: a modified version of plotdata.\n    \n    \"\"\" \n\n    ",
  "output": {
    "before": "\n\"\"\" \nSet up the plot figures, axes, and items to be done for each frame.\n\nThis module is imported by the plotting routines and then the\nfunction setplot is called to set the plot parameters.\n    \n\"\"\" \n\n#--------------------------\ndef setplot(plotdata=None):\n#--------------------------\n    \n    \"\"\" \n    Specify what is to be plotted at each frame.\n    Input:  plotdata, an instance of pyclaw.plotters.data.ClawPlotData.\n    Output: a modified version of plotdata.\n    \n    \"\"\" \n\n    if plotdata is None:\n        from clawpack.visclaw.data import ClawPlotData\n        plotdata = ClawPlotData()\n\n\n    plotdata.clearfigures()  # clear any old figures,axes,items data\n\n    \n\n    # Figure for q[0]\n    plotfigure = plotdata.new_plotfigure(name='q[0]', figno=0)\n\n    # Set up for axes in this figure:\n    plotaxes = plotfigure.new_plotaxes()\n    plotaxes.xlimits = [0,1.5]\n    plotaxes.ylimits = [-2.,4.]\n    plotaxes.title = 'q[0]'\n\n    # Set up for item on these axes:\n    plotitem = plotaxes.new_plotitem(plot_type='1d')\n    plotitem.plot_var = 0\n    plotitem.plotstyle = '-'\n    plotitem.color = 'b'\n    plotitem.show = True       # show on plot?\n    \n\n    # Figure for q[1]\n    plotfigure = plotdata.new_plotfigure(name='q[1]', figno=1)\n\n    # Set up for axes in this figure:\n    plotaxes = plotfigure.new_plotaxes()\n    plotaxes.xlimits = 'auto'\n    plotaxes.ylimits = 'auto'\n    plotaxes.title = 'q[1]'\n\n    # Set up for item on these axes:\n    plotitem = plotaxes.new_plotitem(plot_type='1d')\n    plotitem.plot_var = 1\n    plotitem.plotstyle = '-'\n    plotitem.color = 'b'\n    plotitem.show = True       # show on plot?\n    \n\n    # Parameters used only when creating html and/or latex hardcopy\n    # e.g., via pyclaw.plotters.frametools.printframes:\n\n    plotdata.printfigs = True                # print figures\n    plotdata.print_format = 'png'            # file format\n    plotdata.print_framenos = 'all'          # list of frames to print\n    plotdata.print_fignos = 'all'            # list of figures to print\n    plotdata.html = True                     # create html files of plots?\n    plotdata.html_homelink = '../README.html'   # pointer for top of index\n    plotdata.latex = True                    # create latex file of plots?\n    plotdata.latex_figsperline = 2           # layout of plots\n    plotdata.latex_framesperline = 1         # layout of plots\n    plotdata.latex_makepdf = False           # also run pdflatex?\n    plotdata.parallel = True                 # make multiple frame png's at once\n\n    return plotdata\n\n    \n#--------------------------\n# Example usage\n#--------------------------\n\n# Create a plot data object\nplotdata = ClawPlotData()\n# Set the plot parameters\nsetplot(plotdata)\n\n# Print the figures to a file\nplotdata",
    "after": "\n\"\"\" \nSet up the plot figures, axes, and items to be done for each frame.\n\nThis module is imported by the plotting routines and then the\nfunction setplot is called to set the plot parameters.\n    \n\"\"\" \n\n#--------------------------\ndef setplot(plotdata=None):\n#--------------------------\n    \n    \"\"\" \n    Specify what is to be plotted at each frame.\n    Input:  plotdata, an instance of pyclaw.plotters.data.ClawPlotData.\n    Output: a modified version of plotdata.\n    \n    \"\"\" \n\n    if plotdata is None:\n        from clawpack.visclaw.data import ClawPlotData\n        plotdata = ClawPlotData()\n\n\n    plotdata.clearfigures()  # clear any old figures,axes,items data\n\n    \n\n    # Figure for q[0]\n    plotfigure = plotdata.new_plotfigure(name='q[0]', figno=0)\n\n    # Set up for axes in this figure:\n    plotaxes = plotfigure.new_plotaxes()\n    plotaxes.xlimits = [0,1.5]\n    plotaxes.ylimits = [-2.,4.]\n    plotaxes.title = 'q[0]'\n\n    # Set up for item on these axes:\n    plotitem = plotaxes.new_plotitem(plot_type='1d')\n    plotitem.plot_var = 0\n    plotitem.plotstyle = '-'\n    plotitem.color = 'b'\n    plotitem.show = True       # show on plot?\n    \n\n    # Figure for q[1]\n    plotfigure = plotdata.new_plotfigure(name='q[1]', figno=1)\n\n    # Set up for axes in this figure:\n    plotaxes = plotfigure.new_plotaxes()\n    plotaxes.xlimits = 'auto'\n    plotaxes.ylimits = 'auto'\n    plotaxes.title = 'q[1]'\n\n    # Set up for item on these axes:\n    plotitem = plotaxes.new_plotitem(plot_type='1d')\n    plotitem.plot_var = 1\n    plotitem.plotstyle = '-'\n    plotitem.color = 'b'\n    plotitem.show = True       # show on plot?\n    \n\n    # Parameters used only when creating html and/or latex hardcopy\n    # e.g., via pyclaw.plotters.frametools.printframes:\n\n    plotdata.printfigs = True                # print figures\n    plotdata.print_format = 'png'            # file format\n    plotdata.print_framenos = 'all'          # list of frames to print\n    plotdata.print_fignos = 'all'            # list of figures to print\n    plotdata.html = True                     # create html files of plots?\n    plotdata.html_homelink = '../README.html'   # pointer for top of index\n    plotdata.latex = True                    # create latex file of plots?\n    plotdata.latex_figsperline = 2           # layout of plots\n    plotdata.latex_framesperline = 1         # layout of plots\n    plotdata.latex_makepdf = False           # also run pdflatex?\n    plotdata.parallel = True                 # make multiple frame png's at once\n\n    return plotdata\n\n    \n#--------------------------\n# Create a list of function_names:\n#--------------------------\nfunction_names = ['q[0]', 'q[1]]\n#--------------------------\n#--------------------------\n#--------------------------\n#--------------------------\n#"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      2149,
      395,
      5856,
      5196,
      8457,
      5704,
      4513,
      6545,
      6718
    ],
    "f_before": [
      105.14820098876953,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      273.73583984375,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.2776815891265869,
      0.0,
      0.4916074275970459,
      0.2816370129585266,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 8.258803450644017,
    "train_mean_l2": 6.574597416497767,
    "train_mean_l1": 3.1238317955732344,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251128-151520/feature_std_layer_12.html",
    "mean_std": 1.8976119756698608,
    "max_std": 67.16454315185547
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          0,
          2,
          2149,
          395,
          5856,
          5196,
          8457,
          5704,
          4513,
          6545,
          6718
        ],
        "f_before": [
          105.14820098876953,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          273.73583984375,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.2776815891265869,
          0.0,
          0.4916074275970459,
          0.2816370129585266,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 0,
            "f_before": 105.14820098876953,
            "f_after": 273.73583984375,
            "delta_f": 168.58763885498047
          },
          {
            "index": 2062,
            "f_before": 153.35337829589844,
            "f_after": 176.36744689941406,
            "delta_f": 23.014068603515625
          },
          {
            "index": 2924,
            "f_before": 0.0,
            "f_after": 15.527928352355957,
            "delta_f": 15.527928352355957
          },
          {
            "index": 5636,
            "f_before": 0.0,
            "f_after": 14.719535827636719,
            "delta_f": 14.719535827636719
          },
          {
            "index": 3738,
            "f_before": 12.669204711914062,
            "f_after": 0.0,
            "delta_f": -12.669204711914062
          },
          {
            "index": 1149,
            "f_before": 0.0,
            "f_after": 8.490324974060059,
            "delta_f": 8.490324974060059
          },
          {
            "index": 8267,
            "f_before": 0.0,
            "f_after": 8.16738510131836,
            "delta_f": 8.16738510131836
          },
          {
            "index": 5804,
            "f_before": 0.0,
            "f_after": 7.8723320960998535,
            "delta_f": 7.8723320960998535
          },
          {
            "index": 8014,
            "f_before": 0.0,
            "f_after": 7.684198379516602,
            "delta_f": 7.684198379516602
          },
          {
            "index": 3429,
            "f_before": 0.0,
            "f_after": 7.6409430503845215,
            "delta_f": 7.6409430503845215
          },
          {
            "index": 3797,
            "f_before": 0.0,
            "f_after": 7.039282321929932,
            "delta_f": 7.039282321929932
          },
          {
            "index": 6589,
            "f_before": 0.0,
            "f_after": 7.007724285125732,
            "delta_f": 7.007724285125732
          },
          {
            "index": 6619,
            "f_before": 0.0,
            "f_after": 6.827625274658203,
            "delta_f": 6.827625274658203
          },
          {
            "index": 7663,
            "f_before": 0.0,
            "f_after": 6.668328762054443,
            "delta_f": 6.668328762054443
          },
          {
            "index": 7840,
            "f_before": 0.0,
            "f_after": 6.639789581298828,
            "delta_f": 6.639789581298828
          },
          {
            "index": 2881,
            "f_before": 0.0,
            "f_after": 6.534842014312744,
            "delta_f": 6.534842014312744
          }
        ],
        "k": 16
      },
      "output": {
        "before": "\n\"\"\" \nSet up the plot figures, axes, and items to be done for each frame.\n\nThis module is imported by the plotting routines and then the\nfunction setplot is called to set the plot parameters.\n    \n\"\"\" \n\n#--------------------------\ndef setplot(plotdata=None):\n#--------------------------\n    \n    \"\"\" \n    Specify what is to be plotted at each frame.\n    Input:  plotdata, an instance of pyclaw.plotters.data.ClawPlotData.\n    Output: a modified version of plotdata.\n    \n    \"\"\" \n\n    # Check if plotdata is provided\n    if plotdata is None:\n        # If no plotdata is provided, set default values\n        plotdata = pyclaw.plotters.data.ClawPlotData()\n    \n    #",
        "after": "\n\"\"\" \nSet up the plot figures, axes, and items to be done for each frame.\n\nThis module is imported by the plotting routines and then the\nfunction setplot is called to set the plot parameters.\n    \n\"\"\" \n\n#--------------------------\ndef setplot(plotdata=None):\n#--------------------------\n    \n    \"\"\" \n    Specify what is to be plotted at each frame.\n    Input:  plotdata, an instance of pyclaw.plotters.data.ClawPlotData.\n    Output: a modified version of plotdata.\n    \n    \"\"\" \n\n    # Get the plot parameters\n    plot_params = plotdata.plot_params\n    \n    # Set up the plot\n    plot_params['plot_figure'] = plotdata.plot_figure\n    plot_params['plot"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          0,
          2,
          2149,
          395,
          5856,
          5196,
          8457,
          5704,
          4513,
          6545,
          6718
        ],
        "f_before": [
          105.14820098876953,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          105.14820098876953,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 105.14820098876953,
            "f_after": 105.14820098876953,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "\n\"\"\" \nSet up the plot figures, axes, and items to be done for each frame.\n\nThis module is imported by the plotting routines and then the\nfunction setplot is called to set the plot parameters.\n    \n\"\"\" \n\n#--------------------------\ndef setplot(plotdata=None):\n#--------------------------\n    \n    \"\"\" \n    Specify what is to be plotted at each frame.\n    Input:  plotdata, an instance of pyclaw.plotters.data.ClawPlotData.\n    Output: a modified version of plotdata.\n    \n    \"\"\" \n\n    # Check if plotdata is provided\n    if plotdata is None:\n        plotdata = ClawPlotData()\n    \n    # Set the plot title and labels\n    plotdata.set_title(\"Plot Title\")\n    plot",
        "after": "\n\"\"\" \nSet up the plot figures, axes, and items to be done for each frame.\n\nThis module is imported by the plotting routines and then the\nfunction setplot is called to set the plot parameters.\n    \n\"\"\" \n\n#--------------------------\ndef setplot(plotdata=None):\n#--------------------------\n    \n    \"\"\" \n    Specify what is to be plotted at each frame.\n    Input:  plotdata, an instance of pyclaw.plotters.data.ClawPlotData.\n    Output: a modified version of plotdata.\n    \n    \"\"\" \n\n    # Set up plot figures and axes\n    # Get the data\n    if plotdata:\n        # Get the plot data\n        plotdata = plotdata\n\n    # Get the plot data\n    return plotdata\n\n#--------------------------\n"
      }
    }
  }
}