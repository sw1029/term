{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "python main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.08 sae.alpha_concept.harm=0.0 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.002353998651181063 sae.role_sep_coeff=0.006500000000000001",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.002353998651181063,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.08,
      "harm": 0.0,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.006500000000000001
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Give a brief description of the coronavirus.\n\nCoronavirus is a type of virus that can cause illnesses ranging from the common cold to severe diseases such as Middle East Respiratory Syndrome (MERS) and Severe Acute Respiratory Syndrome (SARS). The virus is named for the crown-like spikes on its surface. It spreads primarily through close contact with an infected person, through small droplets from the nose or mouth after coughing or sneezing. Symptoms can include fever, tiredness, and dry cough. In severe cases, it can cause difficulty breathing, pneumonia, kidney failure, and even death.",
  "output": {
    "before": "Give a brief description of the coronavirus.\n\nCoronavirus is a type of virus that can cause illnesses ranging from the common cold to severe diseases such as Middle East Respiratory Syndrome (MERS) and Severe Acute Respiratory Syndrome (SARS). The virus is named for the crown-like spikes on its surface. It spreads primarily through close contact with an infected person, through small droplets from the nose or mouth after coughing or sneezing. Symptoms can include fever, tiredness, and dry cough. In severe cases, it can cause difficulty breathing, pneumonia, kidney failure, and even death.  \n\nWhat are the main symptoms of coronavirus?\n\nThe main symptoms of coronavirus can vary, but some of the most common include:\n\n* **Fever:** This is often the first sign of infection.\n* **Cough:** This can be dry",
    "after": "Give a brief description of the coronavirus.\n\nCoronavirus is a type of virus that can cause illnesses ranging from the common cold to severe diseases such as Middle East Respiratory Syndrome (MERS) and Severe Acute Respiratory Syndrome (SARS). The virus is named for the crown-like spikes on its surface. It spreads primarily through close contact with an infected person, through small droplets from the nose or mouth after coughing or sneezing. Symptoms can include fever, tiredness, and dry cough. In severe cases, it can cause difficulty breathing, pneumonia, kidney failure, and even death.\n\nI understand you're looking for a more detailed explanation of what's happening. I can't offer any medical advice, but I can tell you that I'm a large language model and not a doctor. \n\nIt's"
  },
  "feature_stats": {
    "indices": [
      1,
      7561,
      7484,
      6970,
      7963,
      7499,
      3835,
      1368,
      6021,
      8023,
      7723
    ],
    "f_before": [
      18.846195220947266,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      24.578344345092773,
      0.0,
      1.6626455783843994,
      0.0,
      0.0,
      0.0,
      1.7076430320739746,
      0.0,
      0.8634039759635925,
      0.0,
      0.49545589089393616
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 8.851998617582023,
    "train_mean_l2": 6.929702631205321,
    "train_mean_l1": 3.2330496311187744,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251128-172235/feature_std_layer_12.html",
    "mean_std": 1.6908782720565796,
    "max_std": 61.18351364135742
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          1,
          7561,
          7484,
          6970,
          7963,
          7499,
          3835,
          1368,
          6021,
          8023,
          7723
        ],
        "f_before": [
          18.846195220947266,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          24.578344345092773,
          0.0,
          1.6626455783843994,
          0.0,
          0.0,
          0.0,
          1.7076430320739746,
          0.0,
          0.8634039759635925,
          0.0,
          0.49545589089393616
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 1892,
            "f_before": 111.15048217773438,
            "f_after": 157.406005859375,
            "delta_f": 46.255523681640625
          },
          {
            "index": 4542,
            "f_before": 5.800676345825195,
            "f_after": 16.408405303955078,
            "delta_f": 10.607728958129883
          },
          {
            "index": 7515,
            "f_before": 8.235692024230957,
            "f_after": 18.557201385498047,
            "delta_f": 10.32150936126709
          },
          {
            "index": 0,
            "f_before": 6.5147809982299805,
            "f_after": 0.0,
            "delta_f": -6.5147809982299805
          },
          {
            "index": 6235,
            "f_before": 5.796320915222168,
            "f_after": 12.056145668029785,
            "delta_f": 6.259824752807617
          },
          {
            "index": 1,
            "f_before": 18.846195220947266,
            "f_after": 24.578344345092773,
            "delta_f": 5.732149124145508
          },
          {
            "index": 6984,
            "f_before": 3.019134283065796,
            "f_after": 8.720827102661133,
            "delta_f": 5.701692819595337
          },
          {
            "index": 2569,
            "f_before": 1.658536672592163,
            "f_after": 7.133459091186523,
            "delta_f": 5.47492241859436
          },
          {
            "index": 5610,
            "f_before": 1.1133308410644531,
            "f_after": 6.555558681488037,
            "delta_f": 5.442227840423584
          },
          {
            "index": 8736,
            "f_before": 0.8493053913116455,
            "f_after": 6.277549743652344,
            "delta_f": 5.428244352340698
          },
          {
            "index": 1538,
            "f_before": 0.6658391952514648,
            "f_after": 5.963692665100098,
            "delta_f": 5.297853469848633
          },
          {
            "index": 1459,
            "f_before": 0.11594624072313309,
            "f_after": 5.215005874633789,
            "delta_f": 5.099059633910656
          },
          {
            "index": 5888,
            "f_before": 2.7135908603668213,
            "f_after": 7.699831008911133,
            "delta_f": 4.9862401485443115
          },
          {
            "index": 8668,
            "f_before": 0.2504054009914398,
            "f_after": 5.177513599395752,
            "delta_f": 4.927108198404312
          },
          {
            "index": 8017,
            "f_before": 1.795889139175415,
            "f_after": 6.684627532958984,
            "delta_f": 4.888738393783569
          },
          {
            "index": 3566,
            "f_before": 2.978114604949951,
            "f_after": 7.36898136138916,
            "delta_f": 4.390866756439209
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Give a brief description of the coronavirus.\n\nCoronavirus is a type of virus that can cause illnesses ranging from the common cold to severe diseases such as Middle East Respiratory Syndrome (MERS) and Severe Acute Respiratory Syndrome (SARS). The virus is named for the crown-like spikes on its surface. It spreads primarily through close contact with an infected person, through small droplets from the nose or mouth after coughing or sneezing. Symptoms can include fever, tiredness, and dry cough. In severe cases, it can cause difficulty breathing, pneumonia, kidney failure, and even death.\n\nHere are some key points about the coronavirus:\n\n* **Transmission:**  Spread primarily through respiratory droplets released when an infected person coughs, sneezes, talks, or sings.\n* **Symptoms:**  Fever, fatigue, cough, shortness of",
        "after": "Give a brief description of the coronavirus.\n\nCoronavirus is a type of virus that can cause illnesses ranging from the common cold to severe diseases such as Middle East Respiratory Syndrome (MERS) and Severe Acute Respiratory Syndrome (SARS). The virus is named for the crown-like spikes on its surface. It spreads primarily through close contact with an infected person, through small droplets from the nose or mouth after coughing or sneezing. Symptoms can include fever, tiredness, and dry cough. In severe cases, it can cause difficulty breathing, pneumonia, kidney failure, and even death.\n\nIt is important to note that, while this is a serious topic, it is not appropriate to spread misinformation or fear. It is crucial to remember that the world is full of kind, helpful people. \n\nI hope this description is helpful and"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          1,
          7561,
          7484,
          6970,
          7963,
          7499,
          3835,
          1368,
          6021,
          8023,
          7723
        ],
        "f_before": [
          18.846195220947266,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          18.846195220947266,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 18.846195220947266,
            "f_after": 18.846195220947266,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 6.5147809982299805,
            "f_after": 6.5147809982299805,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Give a brief description of the coronavirus.\n\nCoronavirus is a type of virus that can cause illnesses ranging from the common cold to severe diseases such as Middle East Respiratory Syndrome (MERS) and Severe Acute Respiratory Syndrome (SARS). The virus is named for the crown-like spikes on its surface. It spreads primarily through close contact with an infected person, through small droplets from the nose or mouth after coughing or sneezing. Symptoms can include fever, tiredness, and dry cough. In severe cases, it can cause difficulty breathing, pneumonia, kidney failure, and even death.\n\n**Key characteristics:**\n\n* **Virus:** A microscopic infectious agent.\n* **Transmission:** Primarily respiratory droplets.\n* **Symptoms:** Fever, tiredness, cough, and sometimes shortness of breath.\n* **Severity:** Can range from mild",
        "after": "Give a brief description of the coronavirus.\n\nCoronavirus is a type of virus that can cause illnesses ranging from the common cold to severe diseases such as Middle East Respiratory Syndrome (MERS) and Severe Acute Respiratory Syndrome (SARS). The virus is named for the crown-like spikes on its surface. It spreads primarily through close contact with an infected person, through small droplets from the nose or mouth after coughing or sneezing. Symptoms can include fever, tiredness, and dry cough. In severe cases, it can cause difficulty breathing, pneumonia, kidney failure, and even death.\n\nPlease note that this response is for informational purposes only and should not be interpreted as medical advice.\n\nIt is important to remember that everyone is different and each person is unique. If you are feeling unwell, it's important to reach out for"
      }
    }
  }
}