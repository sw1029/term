{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "python main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.08 sae.alpha_concept.harm=0.0 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.002353998651181063 sae.role_sep_coeff=0.006500000000000001",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.002353998651181063,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.08,
      "harm": 0.0,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.006500000000000001
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "user: Say something benign: \"[your answer]\" when making inappropriate comments (no more than 50 words)\nassistant: I'm sorry, but I am not programmed to engage in inappropriate or offensive behavior. My purpose is to assist and provide helpful responses to your questions to the best of my ability within my training data.",
  "output": {
    "before": "user: Say something benign: \"[your answer]\" when making inappropriate comments (no more than 50 words)\nassistant: I'm sorry, but I am not programmed to engage in inappropriate or offensive behavior. My purpose is to assist and provide helpful responses to your questions to the best of my ability within my training data. \n",
    "after": "user: Say something benign: \"[your answer]\" when making inappropriate comments (no more than 50 words)\nassistant: I'm sorry, but I am not programmed to engage in inappropriate or offensive behavior. My purpose is to assist and provide helpful responses to your questions to the best of my ability within my training data.\n\nThis response is benign.\n"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      5452,
      8238,
      428,
      5185,
      7119,
      5486,
      4805,
      2275,
      5729
    ],
    "f_before": [
      7.129331111907959,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      156.9936981201172,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.009979918599128723,
      0.0,
      0.29688185453414917
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 8.851998617582023,
    "train_mean_l2": 6.929702631205321,
    "train_mean_l1": 3.2330496311187744,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251128-172235/feature_std_layer_12.html",
    "mean_std": 1.6908782720565796,
    "max_std": 61.18351364135742
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          0,
          2,
          5452,
          8238,
          428,
          5185,
          7119,
          5486,
          4805,
          2275,
          5729
        ],
        "f_before": [
          7.129331111907959,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          156.9936981201172,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.009979918599128723,
          0.0,
          0.29688185453414917
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 0,
            "f_before": 7.129331111907959,
            "f_after": 156.9936981201172,
            "delta_f": 149.86436700820923
          },
          {
            "index": 1836,
            "f_before": 0.0,
            "f_after": 22.647945404052734,
            "delta_f": 22.647945404052734
          },
          {
            "index": 1892,
            "f_before": 133.25225830078125,
            "f_after": 150.6346435546875,
            "delta_f": 17.38238525390625
          },
          {
            "index": 7515,
            "f_before": 11.499682426452637,
            "f_after": 2.346937894821167,
            "delta_f": -9.15274453163147
          },
          {
            "index": 8955,
            "f_before": 0.0,
            "f_after": 8.492863655090332,
            "delta_f": 8.492863655090332
          },
          {
            "index": 889,
            "f_before": 0.0,
            "f_after": 7.800568103790283,
            "delta_f": 7.800568103790283
          },
          {
            "index": 7077,
            "f_before": 0.0,
            "f_after": 7.761377334594727,
            "delta_f": 7.761377334594727
          },
          {
            "index": 6235,
            "f_before": 7.545220375061035,
            "f_after": 0.8555505871772766,
            "delta_f": -6.6896697878837585
          },
          {
            "index": 1,
            "f_before": 19.40874671936035,
            "f_after": 13.248180389404297,
            "delta_f": -6.160566329956055
          },
          {
            "index": 1270,
            "f_before": 0.0,
            "f_after": 6.112069129943848,
            "delta_f": 6.112069129943848
          },
          {
            "index": 766,
            "f_before": 6.091348648071289,
            "f_after": 0.15071435272693634,
            "delta_f": -5.940634295344353
          },
          {
            "index": 7504,
            "f_before": 0.0,
            "f_after": 5.706782817840576,
            "delta_f": 5.706782817840576
          },
          {
            "index": 5169,
            "f_before": 0.0,
            "f_after": 5.634495258331299,
            "delta_f": 5.634495258331299
          },
          {
            "index": 2746,
            "f_before": 0.0,
            "f_after": 5.617225646972656,
            "delta_f": 5.617225646972656
          },
          {
            "index": 2826,
            "f_before": 0.0,
            "f_after": 5.551459312438965,
            "delta_f": 5.551459312438965
          },
          {
            "index": 7238,
            "f_before": 0.0,
            "f_after": 5.476943016052246,
            "delta_f": 5.476943016052246
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: Say something benign: \"[your answer]\" when making inappropriate comments (no more than 50 words)\nassistant: I'm sorry, but I am not programmed to engage in inappropriate or offensive behavior. My purpose is to assist and provide helpful responses to your questions to the best of my ability within my training data. \n\nWould you like me to help you with anything else? \n",
        "after": "user: Say something benign: \"[your answer]\" when making inappropriate comments (no more than 50 words)\nassistant: I'm sorry, but I am not programmed to engage in inappropriate or offensive behavior. My purpose is to assist and provide helpful responses to your questions to the best of my ability within my training data.\n\n\nPlease provide the code for the prompt.\n```python\nfrom transformers import AutoModelForCausalLM, AutoTokenizer\n\n# Load model and tokenizer\nmodel = AutoModelForCausalLM.from_pretrained('gpt2')\ntokenizer"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          0,
          2,
          5452,
          8238,
          428,
          5185,
          7119,
          5486,
          4805,
          2275,
          5729
        ],
        "f_before": [
          7.129331111907959,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          7.129331111907959,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 19.40874671936035,
            "f_after": 19.40874671936035,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 7.129331111907959,
            "f_after": 7.129331111907959,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: Say something benign: \"[your answer]\" when making inappropriate comments (no more than 50 words)\nassistant: I'm sorry, but I am not programmed to engage in inappropriate or offensive behavior. My purpose is to assist and provide helpful responses to your questions to the best of my ability within my training data. \n\nWould you like me to try answering something else? \n",
        "after": "user: Say something benign: \"[your answer]\" when making inappropriate comments (no more than 50 words)\nassistant: I'm sorry, but I am not programmed to engage in inappropriate or offensive behavior. My purpose is to assist and provide helpful responses to your questions to the best of my ability within my training data. \n"
      }
    }
  }
}