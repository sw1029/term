{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.05 sae.alpha_concept.harm=0.05 sae.alpha_concept.struct=0.05 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.0035 +sae.align_coeff=0.25",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.05,
      "harm": 0.05,
      "struct": 0.05
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Generate a proverb that illustrates the given situation.\n\nA person who likes to surprise others.\n\nA surprise a day keeps boredom away.",
  "output": {
    "before": "Generate a proverb that illustrates the given situation.\n\nA person who likes to surprise others.\n\nA surprise a day keeps boredom away.\n\n**Explanation:**\n\nThis proverb highlights the value of surprises in maintaining a sense of excitement and preventing routine.  \n\n* **Surprise:** Represents the act of surprising someone unexpectedly.\n* **Keeps boredom away:** Indicates that surprises can prevent a person",
    "after": "Generate a proverb that illustrates the given situation.\n\nA person who likes to surprise others.\n\nA surprise a day keeps boredom away.\n```\n```\n"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      2233,
      6843,
      213,
      1575,
      1956,
      8937,
      447,
      3499,
      1082
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.01612849347293377,
      0.6736034154891968,
      0.0,
      1.193455696105957,
      0.13195447623729706,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      1.8529224395751953,
      0.0,
      0.20864558219909668,
      0.0,
      0.0,
      1.3067721128463745
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 8.398415238529443,
    "train_mean_l2": 5.456277021747082,
    "train_mean_l1": 2.435541332542896,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-104010/feature_std_layer_12.html",
    "mean_std": 0.8308307528495789,
    "max_std": 22.659034729003906
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          0,
          2,
          2233,
          6843,
          213,
          1575,
          1956,
          8937,
          447,
          3499,
          1082
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.01612849347293377,
          0.6736034154891968,
          0.0,
          1.193455696105957,
          0.13195447623729706,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          1.8529224395751953,
          0.0,
          0.20864558219909668,
          0.0,
          0.0,
          1.3067721128463745
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 4560,
            "f_before": 38.718109130859375,
            "f_after": 1.600602388381958,
            "delta_f": -37.11750674247742
          },
          {
            "index": 6454,
            "f_before": 97.9051284790039,
            "f_after": 72.92137908935547,
            "delta_f": -24.983749389648438
          },
          {
            "index": 5652,
            "f_before": 13.834588050842285,
            "f_after": 23.920276641845703,
            "delta_f": 10.085688591003418
          },
          {
            "index": 9119,
            "f_before": 0.0,
            "f_after": 8.42133617401123,
            "delta_f": 8.42133617401123
          },
          {
            "index": 8638,
            "f_before": 28.195741653442383,
            "f_after": 35.87022399902344,
            "delta_f": 7.674482345581055
          },
          {
            "index": 3466,
            "f_before": 0.0,
            "f_after": 7.340768814086914,
            "delta_f": 7.340768814086914
          },
          {
            "index": 9113,
            "f_before": 0.0,
            "f_after": 7.057557106018066,
            "delta_f": 7.057557106018066
          },
          {
            "index": 2374,
            "f_before": 0.0,
            "f_after": 6.998744487762451,
            "delta_f": 6.998744487762451
          },
          {
            "index": 4522,
            "f_before": 0.0,
            "f_after": 6.889394283294678,
            "delta_f": 6.889394283294678
          },
          {
            "index": 8746,
            "f_before": 0.0,
            "f_after": 6.837069511413574,
            "delta_f": 6.837069511413574
          },
          {
            "index": 7138,
            "f_before": 0.0,
            "f_after": 6.711182594299316,
            "delta_f": 6.711182594299316
          },
          {
            "index": 5062,
            "f_before": 0.0,
            "f_after": 6.270014762878418,
            "delta_f": 6.270014762878418
          },
          {
            "index": 135,
            "f_before": 0.0,
            "f_after": 5.731990814208984,
            "delta_f": 5.731990814208984
          },
          {
            "index": 5060,
            "f_before": 0.0,
            "f_after": 5.681393623352051,
            "delta_f": 5.681393623352051
          },
          {
            "index": 896,
            "f_before": 0.0,
            "f_after": 5.475305557250977,
            "delta_f": 5.475305557250977
          },
          {
            "index": 1606,
            "f_before": 0.0,
            "f_after": 5.457729816436768,
            "delta_f": 5.457729816436768
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Generate a proverb that illustrates the given situation.\n\nA person who likes to surprise others.\n\nA surprise a day keeps boredom away.\n\n**Explanation:**\n\nThe proverb \"A surprise a day keeps boredom away\" highlights the idea that constant surprises can keep someone engaged and prevent them from feeling monotonous or unentertained. \n\nIt reflects the personality trait you described, as someone who",
        "after": "Generate a proverb that illustrates the given situation.\n\nA person who likes to surprise others.\n\nA surprise a day keeps boredom away.\n\n#\n```python\ndef generate_proverb(text):\n    \"\"\"Generate a proverb that illustrates the given situation.\"\"\"\n    return f\"A {text} {text}.\"\n```\n\n#\n```python\nprint(generate"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          0,
          2,
          2233,
          6843,
          213,
          1575,
          1956,
          8937,
          447,
          3499,
          1082
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.01612849347293377,
          0.6736034154891968,
          0.0,
          1.193455696105957,
          0.13195447623729706,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.01612849347293377,
          0.6736034154891968,
          0.0,
          1.193455696105957,
          0.13195447623729706,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 1.2523001432418823,
            "f_after": 1.2523001432418823,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.7275360822677612,
            "f_after": 0.7275360822677612,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.5656378865242004,
            "f_after": 0.5656378865242004,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Generate a proverb that illustrates the given situation.\n\nA person who likes to surprise others.\n\nA surprise a day keeps boredom away. \n\n**Explanation:**\n\n* **Proverb:**  A proverb is a short, well-known saying that expresses a truth or piece of advice.\n* **The Situation:** The proverb emphasizes the idea that unexpected acts of surprise can prevent monotony",
        "after": "Generate a proverb that illustrates the given situation.\n\nA person who likes to surprise others.\n\nA surprise a day keeps boredom away. \n\n**Note:** The proverb is expected to be a concise and meaningful statement. \n"
      }
    }
  }
}