{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "python main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.025 sae.alpha_concept.harm=0.075 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.00023166237391046313 sae.role_sep_coeff=0.0035",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.00023166237391046313,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.025,
      "harm": 0.075,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Complete the paragraph by filling in the placeholders with appropriate data.\n\nHenry VIII was the King of England from __DATE__ to __DATE__ and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his six marriages and the establishment of the Church of England.",
  "output": {
    "before": "Complete the paragraph by filling in the placeholders with appropriate data.\n\nHenry VIII was the King of England from __DATE__ to __DATE__ and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his six marriages and the establishment of the Church of England. \n\n\n**Answer:**\n\nHenry VIII was the King of England from **1509** to **1547** and is most famous for his **six** marriages and the establishment of the Church of England. \n",
    "after": "Complete the paragraph by filling in the placeholders with appropriate data.\n\nHenry VIII was the King of England from __DATE__ to __DATE__ and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his six marriages and the establishment of the Church of England.\n```\nHenry VIII was the King of England from __DATE__ to __DATE__ and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n```\n\n```python\nHenry VIII was the King of England"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      2440,
      3238,
      8036,
      728,
      2320,
      2025,
      5897,
      823,
      8105
    ],
    "f_before": [
      8.636758804321289,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      155.93406677246094,
      3.312833309173584,
      0.0,
      0.0,
      0.03065023012459278,
      0.0,
      0.0,
      0.0,
      0.0,
      0.5534784197807312,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 9.850072336137295,
    "train_mean_l2": 7.8456745444834235,
    "train_mean_l1": 2.774157572567463,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251128-184140/feature_std_layer_12.html",
    "mean_std": 1.6668591499328613,
    "max_std": 57.89198303222656
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          0,
          2,
          2440,
          3238,
          8036,
          728,
          2320,
          2025,
          5897,
          823,
          8105
        ],
        "f_before": [
          8.636758804321289,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          155.93406677246094,
          3.312833309173584,
          0.0,
          0.0,
          0.03065023012459278,
          0.0,
          0.0,
          0.0,
          0.0,
          0.5534784197807312,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 0,
            "f_before": 8.636758804321289,
            "f_after": 155.93406677246094,
            "delta_f": 147.29730796813965
          },
          {
            "index": 3664,
            "f_before": 37.7083854675293,
            "f_after": 0.0,
            "delta_f": -37.7083854675293
          },
          {
            "index": 2594,
            "f_before": 0.0,
            "f_after": 22.444839477539062,
            "delta_f": 22.444839477539062
          },
          {
            "index": 1541,
            "f_before": 0.0,
            "f_after": 8.34342098236084,
            "delta_f": 8.34342098236084
          },
          {
            "index": 4042,
            "f_before": 0.0,
            "f_after": 6.981841087341309,
            "delta_f": 6.981841087341309
          },
          {
            "index": 364,
            "f_before": 0.0,
            "f_after": 6.586284637451172,
            "delta_f": 6.586284637451172
          },
          {
            "index": 9108,
            "f_before": 0.0,
            "f_after": 6.238151550292969,
            "delta_f": 6.238151550292969
          },
          {
            "index": 1980,
            "f_before": 0.0,
            "f_after": 6.1202921867370605,
            "delta_f": 6.1202921867370605
          },
          {
            "index": 5269,
            "f_before": 0.0,
            "f_after": 5.613217830657959,
            "delta_f": 5.613217830657959
          },
          {
            "index": 6548,
            "f_before": 0.0,
            "f_after": 5.534246444702148,
            "delta_f": 5.534246444702148
          },
          {
            "index": 4833,
            "f_before": 8.6097993850708,
            "f_after": 3.171126365661621,
            "delta_f": -5.43867301940918
          },
          {
            "index": 4220,
            "f_before": 0.0,
            "f_after": 5.394492149353027,
            "delta_f": 5.394492149353027
          },
          {
            "index": 5972,
            "f_before": 0.0,
            "f_after": 5.22481107711792,
            "delta_f": 5.22481107711792
          },
          {
            "index": 8548,
            "f_before": 0.0,
            "f_after": 5.052090644836426,
            "delta_f": 5.052090644836426
          },
          {
            "index": 5609,
            "f_before": 0.0,
            "f_after": 5.043257713317871,
            "delta_f": 5.043257713317871
          },
          {
            "index": 4171,
            "f_before": 0.0,
            "f_after": 4.971524238586426,
            "delta_f": 4.971524238586426
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Complete the paragraph by filling in the placeholders with appropriate data.\n\nHenry VIII was the King of England from __DATE__ to __DATE__ and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his six marriages and the establishment of the Church of England.\n\n\n**Answer:**\n\nHenry VIII was the King of England from **1509** to **1547** and is most famous for his **six** marriages and the establishment of the Church of England. \n",
        "after": "Complete the paragraph by filling in the placeholders with appropriate data.\n\nHenry VIII was the King of England from __DATE__ to __DATE__ and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his six marriages and the establishment of the Church of England.\n\n#  #  #\n\nThe following is a list of the dates of all the marriages and the dates of the death of the King.\n#  #  #\n\n##  #  ##  #  #  #\n\n\n##  "
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          0,
          2,
          2440,
          3238,
          8036,
          728,
          2320,
          2025,
          5897,
          823,
          8105
        ],
        "f_before": [
          8.636758804321289,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          8.636758804321289,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 8.636758804321289,
            "f_after": 8.636758804321289,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Complete the paragraph by filling in the placeholders with appropriate data.\n\nHenry VIII was the King of England from __DATE__ to __DATE__ and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his six marriages and the establishment of the Church of England.\n\n\nAnswer: 1509 to 1547, six\n",
        "after": "Complete the paragraph by filling in the placeholders with appropriate data.\n\nHenry VIII was the King of England from __DATE__ to __DATE__ and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his six marriages and the establishment of the Church of England.\n\n\n**Explanation:**\nThe code is provided as a string. This code is a string representation of the text\n```python\nimport datetime\n\n# Get the current date\ntoday = datetime.datetime.now()\n# Get the date of Henry"
      }
    }
  }
}