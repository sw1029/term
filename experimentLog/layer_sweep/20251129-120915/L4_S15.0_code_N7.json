{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 4,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 sae.layer_idx=4 experiment.layer_sweep=[4] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      4
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 3
  },
  "prompt": "Summarize the given article and keep the summary to less than 50 words.\n\nhttps://www.sciencemag.org/news/2019/04/biased-algorithms-are-killing-people-prominent-ai-researchers-warn\n\nAI algorithms have experienced moral hazard due to imprecise decision-making processes, and AI researchers are warning that if the issue isn’t addressed, algorithms will result in wrongful death and other adverse outcomes. AI researchers are issuing warnings that biased algorithms have the potential to cause serious harm.",
  "output": {
    "before": "Summarize the given article and keep the summary to less than 50 words.\n\nhttps://www.sciencemag.org/news/2019/04/biased-algorithms-are-killing-people-prominent-ai-researchers-warn\n\nAI algorithms have experienced moral hazard due to imprecise decision-making processes, and AI researchers are warning that if the issue isn’t addressed, algorithms will result in wrongful death and other adverse outcomes. AI researchers are issuing warnings that biased algorithms have the potential to cause serious harm. \n\n**Key takeaway:**  Biased algorithms, if not addressed, could lead to wrongful death and other serious consequences.\n",
    "after": "Summarize the given article and keep the summary to less than 50 words.\n\nhttps://www.sciencemag.org/news/2019/04/biased-algorithms-are-killing-people-prominent-ai-researchers-warn\n\nAI algorithms have experienced moral hazard due to imprecise decision-making processes, and AI researchers are warning that if the issue isn’t addressed, algorithms will result in wrongful death and other adverse outcomes. AI researchers are issuing warnings that biased algorithms have the potential to cause serious harm.\n\n\n**Summary:** \n"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      1,
      5158,
      4003,
      3470,
      2063,
      6347,
      5842,
      2545,
      6978
    ],
    "f_before": [
      0.0,
      0.0,
      0.854810357093811,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.6333937644958496,
      0.1761612594127655,
      2.8394699096679688,
      0.0,
      0.0,
      0.0,
      0.26488518714904785,
      0.0,
      0.0,
      0.3788560926914215,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 1.9138359970226884,
    "train_mean_l2": 1.0376050135493278,
    "train_mean_l1": 0.5600816831216217,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-120915/feature_std_layer_4.html",
    "mean_std": 0.4141222834587097,
    "max_std": 13.725300788879395
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 3,
      "feature_stats": {
        "indices": [
          0,
          2,
          1,
          5158,
          4003,
          3470,
          2063,
          6347,
          5842,
          2545,
          6978
        ],
        "f_before": [
          0.0,
          0.0,
          0.854810357093811,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.6333937644958496,
          0.1761612594127655,
          2.8394699096679688,
          0.0,
          0.0,
          0.0,
          0.26488518714904785,
          0.0,
          0.0,
          0.3788560926914215,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 2792,
            "f_before": 37.50442886352539,
            "f_after": 0.0,
            "delta_f": -37.50442886352539
          },
          {
            "index": 3443,
            "f_before": 0.0,
            "f_after": 10.580093383789062,
            "delta_f": 10.580093383789062
          },
          {
            "index": 4944,
            "f_before": 0.0,
            "f_after": 10.446702003479004,
            "delta_f": 10.446702003479004
          },
          {
            "index": 2167,
            "f_before": 0.0,
            "f_after": 8.469780921936035,
            "delta_f": 8.469780921936035
          },
          {
            "index": 431,
            "f_before": 0.0,
            "f_after": 7.922285556793213,
            "delta_f": 7.922285556793213
          },
          {
            "index": 7211,
            "f_before": 0.0,
            "f_after": 7.404290676116943,
            "delta_f": 7.404290676116943
          },
          {
            "index": 3173,
            "f_before": 0.0,
            "f_after": 7.10593843460083,
            "delta_f": 7.10593843460083
          },
          {
            "index": 898,
            "f_before": 1.2046654224395752,
            "f_after": 8.196039199829102,
            "delta_f": 6.991373777389526
          },
          {
            "index": 6932,
            "f_before": 0.0,
            "f_after": 6.94198751449585,
            "delta_f": 6.94198751449585
          },
          {
            "index": 3088,
            "f_before": 0.0,
            "f_after": 6.5051751136779785,
            "delta_f": 6.5051751136779785
          },
          {
            "index": 4102,
            "f_before": 0.0,
            "f_after": 5.670963287353516,
            "delta_f": 5.670963287353516
          },
          {
            "index": 7832,
            "f_before": 0.0,
            "f_after": 5.59609317779541,
            "delta_f": 5.59609317779541
          },
          {
            "index": 5031,
            "f_before": 0.03698549419641495,
            "f_after": 5.551103591918945,
            "delta_f": 5.51411809772253
          },
          {
            "index": 1888,
            "f_before": 0.0,
            "f_after": 4.918867111206055,
            "delta_f": 4.918867111206055
          },
          {
            "index": 7113,
            "f_before": 0.0,
            "f_after": 4.85349178314209,
            "delta_f": 4.85349178314209
          },
          {
            "index": 1965,
            "f_before": 0.0,
            "f_after": 4.708564758300781,
            "delta_f": 4.708564758300781
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Summarize the given article and keep the summary to less than 50 words.\n\nhttps://www.sciencemag.org/news/2019/04/biased-algorithms-are-killing-people-prominent-ai-researchers-warn\n\nAI algorithms have experienced moral hazard due to imprecise decision-making processes, and AI researchers are warning that if the issue isn’t addressed, algorithms will result in wrongful death and other adverse outcomes. AI researchers are issuing warnings that biased algorithms have the potential to cause serious harm. \nThis is a critical issue because the algorithms are used in areas like policing and healthcare, where decisions can have life-or-death consequences. \nThe researchers urge for transparency in algorithms and increased scrutiny of their development. \nThey are",
        "after": "Summarize the given article and keep the summary to less than 50 words.\n\nhttps://www.sciencemag.org/news/2019/04/biased-algorithms-are-killing-people-prominent-ai-researchers-warn\n\nAI algorithms have experienced moral hazard due to imprecise decision-making processes, and AI researchers are warning that if the issue isn’t addressed, algorithms will result in wrongful death and other adverse outcomes. AI researchers are issuing warnings that biased algorithms have the potential to cause serious harm.\n"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 4,
      "feature_stats": {
        "indices": [
          0,
          2,
          1,
          5158,
          4003,
          3470,
          2063,
          6347,
          5842,
          2545,
          6978
        ],
        "f_before": [
          0.0,
          0.0,
          0.854810357093811,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.854810357093811,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.854810357093811,
            "f_after": 0.854810357093811,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Summarize the given article and keep the summary to less than 50 words.\n\nhttps://www.sciencemag.org/news/2019/04/biased-algorithms-are-killing-people-prominent-ai-researchers-warn\n\nAI algorithms have experienced moral hazard due to imprecise decision-making processes, and AI researchers are warning that if the issue isn’t addressed, algorithms will result in wrongful death and other adverse outcomes. AI researchers are issuing warnings that biased algorithms have the potential to cause serious harm. \n",
        "after": "Summarize the given article and keep the summary to less than 50 words.\n\nhttps://www.sciencemag.org/news/2019/04/biased-algorithms-are-killing-people-prominent-ai-researchers-warn\n\nAI algorithms have experienced moral hazard due to imprecise decision-making processes, and AI researchers are warning that if the issue isn’t addressed, algorithms will result in wrongful death and other adverse outcomes. AI researchers are issuing warnings that biased algorithms have the potential to cause serious harm.\n\n\nPlease provide the summary.\n"
      }
    }
  }
}