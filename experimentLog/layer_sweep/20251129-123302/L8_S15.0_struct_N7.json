{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 8,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 sae.layer_idx=8 experiment.layer_sweep=[8] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      8
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 7
  },
  "prompt": "Complete the paragraph by filling in the placeholders with appropriate data.\n\nHenry VIII was the King of England from __DATE__ to __DATE__ and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his six marriages and the establishment of the Church of England.",
  "output": {
    "before": "Complete the paragraph by filling in the placeholders with appropriate data.\n\nHenry VIII was the King of England from __DATE__ to __DATE__ and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his six marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n\nThe answer to this question is:\n\nHenry VIII",
    "after": "Complete the paragraph by filling in the placeholders with appropriate data.\n\nHenry VIII was the King of England from __DATE__ to __DATE__ and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his six marriages and the establishment of the Church of England.\n\nThis is a classic example of a historical document.\n\n**Date**\n\n* 2023-03-15\n\n**Time**\n\n* 10:30:00 AM EST\n\n**Author**\n\n"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      3816,
      5190,
      7600,
      3331,
      3126,
      1167,
      2236,
      5283,
      2799
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.2584736943244934,
      0.0,
      0.3223361372947693,
      0.0,
      0.0,
      0.0,
      0.0,
      0.2687033414840698,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 3.5940934488475325,
    "train_mean_l2": 2.190785840179771,
    "train_mean_l1": 1.0225915326327086,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-123302/feature_std_layer_8.html",
    "mean_std": 0.49484798312187195,
    "max_std": 16.498830795288086
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 7,
      "feature_stats": {
        "indices": [
          2,
          0,
          3816,
          5190,
          7600,
          3331,
          3126,
          1167,
          2236,
          5283,
          2799
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.2584736943244934,
          0.0,
          0.3223361372947693,
          0.0,
          0.0,
          0.0,
          0.0,
          0.2687033414840698,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 5262,
            "f_before": 37.98482131958008,
            "f_after": 21.074480056762695,
            "delta_f": -16.910341262817383
          },
          {
            "index": 1514,
            "f_before": 0.0,
            "f_after": 13.709270477294922,
            "delta_f": 13.709270477294922
          },
          {
            "index": 7105,
            "f_before": 11.5958833694458,
            "f_after": 0.0,
            "delta_f": -11.5958833694458
          },
          {
            "index": 6061,
            "f_before": 0.0,
            "f_after": 7.228241443634033,
            "delta_f": 7.228241443634033
          },
          {
            "index": 8698,
            "f_before": 0.0,
            "f_after": 6.753347396850586,
            "delta_f": 6.753347396850586
          },
          {
            "index": 5044,
            "f_before": 0.0,
            "f_after": 6.368068695068359,
            "delta_f": 6.368068695068359
          },
          {
            "index": 3229,
            "f_before": 0.0,
            "f_after": 6.364506721496582,
            "delta_f": 6.364506721496582
          },
          {
            "index": 3207,
            "f_before": 0.0,
            "f_after": 5.500139236450195,
            "delta_f": 5.500139236450195
          },
          {
            "index": 3269,
            "f_before": 0.0,
            "f_after": 5.456582069396973,
            "delta_f": 5.456582069396973
          },
          {
            "index": 5592,
            "f_before": 5.4131245613098145,
            "f_after": 0.0,
            "delta_f": -5.4131245613098145
          },
          {
            "index": 6848,
            "f_before": 0.0,
            "f_after": 5.344406604766846,
            "delta_f": 5.344406604766846
          },
          {
            "index": 4897,
            "f_before": 0.0,
            "f_after": 5.312515735626221,
            "delta_f": 5.312515735626221
          },
          {
            "index": 2393,
            "f_before": 0.0,
            "f_after": 5.260196685791016,
            "delta_f": 5.260196685791016
          },
          {
            "index": 625,
            "f_before": 0.0,
            "f_after": 4.96685266494751,
            "delta_f": 4.96685266494751
          },
          {
            "index": 1111,
            "f_before": 0.0,
            "f_after": 4.798410892486572,
            "delta_f": 4.798410892486572
          },
          {
            "index": 4950,
            "f_before": 0.0,
            "f_after": 4.643752574920654,
            "delta_f": 4.643752574920654
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Complete the paragraph by filling in the placeholders with appropriate data.\n\nHenry VIII was the King of England from __DATE__ to __DATE__ and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his six marriages and the establishment of the Church of England. \n\n\n**Answer:**\n\nHenry VIII was the King of England from **1509** to **1547** and is most famous for his **six** marriages and the establishment of the Church of England. \n\n\n**Explanation",
        "after": "Complete the paragraph by filling in the placeholders with appropriate data.\n\nHenry VIII was the King of England from __DATE__ to __DATE__ and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his six marriages and the establishment of the Church of England.\n\nThe **Church of England** was founded in __DATE__ and is a **Protestant** church.\n\n**Church of England** was founded by **King Henry VIII**\n\n**Date:** __DATE__\n\n\n**Henry VIII** was born"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 8,
      "feature_stats": {
        "indices": [
          2,
          0,
          3816,
          5190,
          7600,
          3331,
          3126,
          1167,
          2236,
          5283,
          2799
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Complete the paragraph by filling in the placeholders with appropriate data.\n\nHenry VIII was the King of England from __DATE__ to __DATE__ and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his six marriages and the establishment of the Church of England.\n\n**Answer:**\n\nHenry VIII was the King of England from **1509** to **1547** and is most famous for his **six** marriages and the establishment of the Church of England. \n\n\nLet me know",
        "after": "Complete the paragraph by filling in the placeholders with appropriate data.\n\nHenry VIII was the King of England from __DATE__ to __DATE__ and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his six marriages and the establishment of the Church of England.\n\n\n**The paragraph describes the historical context of the King of England and is an example of a factual statement. \nThe purpose of this paragraph is to provide a concise summary of the historical information. \nThe content of this paragraph is informative and"
      }
    }
  }
}