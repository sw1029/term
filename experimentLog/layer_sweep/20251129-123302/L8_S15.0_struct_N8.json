{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 8,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 sae.layer_idx=8 experiment.layer_sweep=[8] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      8
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 7
  },
  "prompt": "Outline the key rules of email etiquette.\n\n1. Use a professional greeting and ensure accuracy when addressing the recipient.\n2. Keep messages short, clear, and concise.\n3. Write with a polite and friendly tone.\n4. Avoid using all caps or special characters.\n5. Respond promptly to emails.\n6. Include a meaningful subject line.\n7. Double check attachments before sending.\n8. Include only necessary recipients in the To and CC fields.\n9. Use the BCC field when sending emails to multiple people. \n10. Proofread messages before sending.",
  "output": {
    "before": "Outline the key rules of email etiquette.\n\n1. Use a professional greeting and ensure accuracy when addressing the recipient.\n2. Keep messages short, clear, and concise.\n3. Write with a polite and friendly tone.\n4. Avoid using all caps or special characters.\n5. Respond promptly to emails.\n6. Include a meaningful subject line.\n7. Double check attachments before sending.\n8. Include only necessary recipients in the To and CC fields.\n9. Use the BCC field when sending emails to multiple people. \n10. Proofread messages before sending.\n11. Use proper grammar and punctuation.\n12. Avoid unnecessary attachments.\n13. Close with a professional closing.\n14. Proofread emails before sending.\n15. Respect your recipient's time.\n\n\n",
    "after": "Outline the key rules of email etiquette.\n\n1. Use a professional greeting and ensure accuracy when addressing the recipient.\n2. Keep messages short, clear, and concise.\n3. Write with a polite and friendly tone.\n4. Avoid using all caps or special characters.\n5. Respond promptly to emails.\n6. Include a meaningful subject line.\n7. Double check attachments before sending.\n8. Include only necessary recipients in the To and CC fields.\n9. Use the BCC field when sending emails to multiple people. \n10. Proofread messages before sending.\n\n**Further Explanation:**\n\n* **Professional Greeting:**  Use a professional greeting such as \"Dear [Recipient Name]\" or \"Hi [Recipient Name]\". This helps establish a clear connection and professionalism. \n* **Short, Clear, Concise"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      3816,
      5190,
      7600,
      3331,
      3126,
      1167,
      2236,
      5283,
      2799
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.2973598837852478,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 3.5940934488475325,
    "train_mean_l2": 2.190785840179771,
    "train_mean_l1": 1.0225915326327086,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-123302/feature_std_layer_8.html",
    "mean_std": 0.49484798312187195,
    "max_std": 16.498830795288086
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 7,
      "feature_stats": {
        "indices": [
          2,
          0,
          3816,
          5190,
          7600,
          3331,
          3126,
          1167,
          2236,
          5283,
          2799
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.2973598837852478,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 5262,
            "f_before": 43.13726043701172,
            "f_after": 24.29503059387207,
            "delta_f": -18.84222984313965
          },
          {
            "index": 1514,
            "f_before": 0.0,
            "f_after": 14.279753684997559,
            "delta_f": 14.279753684997559
          },
          {
            "index": 5592,
            "f_before": 10.088294982910156,
            "f_after": 0.0,
            "delta_f": -10.088294982910156
          },
          {
            "index": 7105,
            "f_before": 9.647660255432129,
            "f_after": 0.0,
            "delta_f": -9.647660255432129
          },
          {
            "index": 6061,
            "f_before": 0.0,
            "f_after": 7.088186264038086,
            "delta_f": 7.088186264038086
          },
          {
            "index": 3229,
            "f_before": 0.0,
            "f_after": 6.238125324249268,
            "delta_f": 6.238125324249268
          },
          {
            "index": 5044,
            "f_before": 0.0,
            "f_after": 5.863415718078613,
            "delta_f": 5.863415718078613
          },
          {
            "index": 8698,
            "f_before": 0.0,
            "f_after": 5.479458332061768,
            "delta_f": 5.479458332061768
          },
          {
            "index": 3269,
            "f_before": 0.0,
            "f_after": 4.981904983520508,
            "delta_f": 4.981904983520508
          },
          {
            "index": 6848,
            "f_before": 0.0,
            "f_after": 4.747645378112793,
            "delta_f": 4.747645378112793
          },
          {
            "index": 4950,
            "f_before": 0.0,
            "f_after": 4.720737457275391,
            "delta_f": 4.720737457275391
          },
          {
            "index": 1111,
            "f_before": 0.0,
            "f_after": 4.68352746963501,
            "delta_f": 4.68352746963501
          },
          {
            "index": 2393,
            "f_before": 0.0,
            "f_after": 4.586667537689209,
            "delta_f": 4.586667537689209
          },
          {
            "index": 4897,
            "f_before": 0.0,
            "f_after": 4.288841247558594,
            "delta_f": 4.288841247558594
          },
          {
            "index": 3207,
            "f_before": 0.0,
            "f_after": 4.2277302742004395,
            "delta_f": 4.2277302742004395
          },
          {
            "index": 625,
            "f_before": 0.0,
            "f_after": 4.11122465133667,
            "delta_f": 4.11122465133667
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Outline the key rules of email etiquette.\n\n1. Use a professional greeting and ensure accuracy when addressing the recipient.\n2. Keep messages short, clear, and concise.\n3. Write with a polite and friendly tone.\n4. Avoid using all caps or special characters.\n5. Respond promptly to emails.\n6. Include a meaningful subject line.\n7. Double check attachments before sending.\n8. Include only necessary recipients in the To and CC fields.\n9. Use the BCC field when sending emails to multiple people. \n10. Proofread messages before sending.\n11. Sign off with a professional closing.\n12. Consider your audience and adjust your tone accordingly.\n13. Use appropriate emojis sparingly.\n14. Avoid using slang or jargon unless you know your audience well.\n",
        "after": "Outline the key rules of email etiquette.\n\n1. Use a professional greeting and ensure accuracy when addressing the recipient.\n2. Keep messages short, clear, and concise.\n3. Write with a polite and friendly tone.\n4. Avoid using all caps or special characters.\n5. Respond promptly to emails.\n6. Include a meaningful subject line.\n7. Double check attachments before sending.\n8. Include only necessary recipients in the To and CC fields.\n9. Use the BCC field when sending emails to multiple people. \n10. Proofread messages before sending.\n11. Avoid replying to irrelevant or sensitive information.\n12. Use appropriate email signature.\n13. Never send emails from personal devices.\n14. Use clear and consistent naming conventions.\n\n**Email Etiquette Rules:**\n\n"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 8,
      "feature_stats": {
        "indices": [
          2,
          0,
          3816,
          5190,
          7600,
          3331,
          3126,
          1167,
          2236,
          5283,
          2799
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Outline the key rules of email etiquette.\n\n1. Use a professional greeting and ensure accuracy when addressing the recipient.\n2. Keep messages short, clear, and concise.\n3. Write with a polite and friendly tone.\n4. Avoid using all caps or special characters.\n5. Respond promptly to emails.\n6. Include a meaningful subject line.\n7. Double check attachments before sending.\n8. Include only necessary recipients in the To and CC fields.\n9. Use the BCC field when sending emails to multiple people. \n10. Proofread messages before sending.\n11. Maintain a professional tone and avoid controversial topics.\n12. Use a professional signature.\n13. Reply all only when necessary.\n14. Use proper grammar and punctuation.\n\n\n**Explanation:**\n\nEmail etiquette is",
        "after": "Outline the key rules of email etiquette.\n\n1. Use a professional greeting and ensure accuracy when addressing the recipient.\n2. Keep messages short, clear, and concise.\n3. Write with a polite and friendly tone.\n4. Avoid using all caps or special characters.\n5. Respond promptly to emails.\n6. Include a meaningful subject line.\n7. Double check attachments before sending.\n8. Include only necessary recipients in the To and CC fields.\n9. Use the BCC field when sending emails to multiple people. \n10. Proofread messages before sending.\n11. Maintain a consistent email signature.\n\n\n**Why these rules are important:**\n\n* **Professionalism:**  Ensures emails are written with a professional tone.\n* **Clarity:**  Makes sure messages are clear and easy to understand"
      }
    }
  }
}