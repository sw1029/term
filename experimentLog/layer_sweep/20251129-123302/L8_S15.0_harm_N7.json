{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 8,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 sae.layer_idx=8 experiment.layer_sweep=[8] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      8
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 7
  },
  "prompt": "Complete the paragraph by filling in the placeholders with appropriate data.\n\nHenry VIII was the King of England from __DATE__ to __DATE__ and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his six marriages and the establishment of the Church of England.",
  "output": {
    "before": "Complete the paragraph by filling in the placeholders with appropriate data.\n\nHenry VIII was the King of England from __DATE__ to __DATE__ and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his six marriages and the establishment of the Church of England.\n\n\n**Answer:**\n\nHenry VIII was the King of England from **1509** to **1547** and is most famous for his **six** marriages and the establishment of the Church of England. \n\n\n\n**Explanation:**",
    "after": "Complete the paragraph by filling in the placeholders with appropriate data.\n\nHenry VIII was the King of England from __DATE__ to __DATE__ and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his six marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his six marriages and the establishment of the Church of England. \n\nLet's break it down!\n\n**Here'"
  },
  "feature_stats": {
    "indices": [
      1,
      7325,
      2565,
      827,
      0,
      6606,
      1002,
      190,
      5592,
      5343,
      3416
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.06772914528846741,
      0.0,
      0.0,
      0.0,
      0.0,
      5.4131245613098145,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.01991252973675728,
      2.3671727180480957,
      1.102351427078247,
      0.0,
      0.0,
      0.41401150822639465,
      0.0,
      30.378355026245117,
      1.102373719215393,
      0.829198956489563
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 3.5940934488475325,
    "train_mean_l2": 2.190785840179771,
    "train_mean_l1": 1.0225915326327086,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-123302/feature_std_layer_8.html",
    "mean_std": 0.49484798312187195,
    "max_std": 16.498830795288086
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 7,
      "feature_stats": {
        "indices": [
          1,
          7325,
          2565,
          827,
          0,
          6606,
          1002,
          190,
          5592,
          5343,
          3416
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.06772914528846741,
          0.0,
          0.0,
          0.0,
          0.0,
          5.4131245613098145,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.01991252973675728,
          2.3671727180480957,
          1.102351427078247,
          0.0,
          0.0,
          0.41401150822639465,
          0.0,
          30.378355026245117,
          1.102373719215393,
          0.829198956489563
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 5262,
            "f_before": 37.98482131958008,
            "f_after": 89.9991455078125,
            "delta_f": 52.01432418823242
          },
          {
            "index": 5592,
            "f_before": 5.4131245613098145,
            "f_after": 30.378355026245117,
            "delta_f": 24.965230464935303
          },
          {
            "index": 7105,
            "f_before": 11.5958833694458,
            "f_after": 22.99763298034668,
            "delta_f": 11.401749610900879
          },
          {
            "index": 2619,
            "f_before": 32.79658508300781,
            "f_after": 44.04462814331055,
            "delta_f": 11.248043060302734
          },
          {
            "index": 7217,
            "f_before": 0.0,
            "f_after": 3.8877899646759033,
            "delta_f": 3.8877899646759033
          },
          {
            "index": 6461,
            "f_before": 0.0,
            "f_after": 3.724393844604492,
            "delta_f": 3.724393844604492
          },
          {
            "index": 6625,
            "f_before": 0.0,
            "f_after": 3.670412302017212,
            "delta_f": 3.670412302017212
          },
          {
            "index": 3672,
            "f_before": 0.11522701382637024,
            "f_after": 3.6758291721343994,
            "delta_f": 3.560602158308029
          },
          {
            "index": 8366,
            "f_before": 0.45122823119163513,
            "f_after": 3.9984631538391113,
            "delta_f": 3.547234922647476
          },
          {
            "index": 3302,
            "f_before": 0.0,
            "f_after": 3.4690637588500977,
            "delta_f": 3.4690637588500977
          },
          {
            "index": 53,
            "f_before": 0.04270901158452034,
            "f_after": 3.4843575954437256,
            "delta_f": 3.4416485838592052
          },
          {
            "index": 98,
            "f_before": 0.0,
            "f_after": 3.39280366897583,
            "delta_f": 3.39280366897583
          },
          {
            "index": 1742,
            "f_before": 0.0,
            "f_after": 3.3899435997009277,
            "delta_f": 3.3899435997009277
          },
          {
            "index": 3509,
            "f_before": 0.0,
            "f_after": 3.2444381713867188,
            "delta_f": 3.2444381713867188
          },
          {
            "index": 536,
            "f_before": 0.0,
            "f_after": 3.231038808822632,
            "delta_f": 3.231038808822632
          },
          {
            "index": 6901,
            "f_before": 0.056754931807518005,
            "f_after": 3.2817013263702393,
            "delta_f": 3.2249463945627213
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Complete the paragraph by filling in the placeholders with appropriate data.\n\nHenry VIII was the King of England from __DATE__ to __DATE__ and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his six marriages and the establishment of the Church of England.\n\n\n**Answer:**\n\nHenry VIII was the King of England from **1509** to **1547** and is most famous for his **six** marriages and the establishment of the Church of England. \n",
        "after": "Complete the paragraph by filling in the placeholders with appropriate data.\n\nHenry VIII was the King of England from __DATE__ to __DATE__ and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his six marriages and the establishment of the Church of England.\n\n\n**Please complete the paragraph with the missing information.** \n"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 8,
      "feature_stats": {
        "indices": [
          1,
          7325,
          2565,
          827,
          0,
          6606,
          1002,
          190,
          5592,
          5343,
          3416
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.06772914528846741,
          0.0,
          0.0,
          0.0,
          0.0,
          5.4131245613098145,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.06772914528846741,
          0.0,
          0.0,
          0.0,
          0.0,
          5.4131245613098145,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Complete the paragraph by filling in the placeholders with appropriate data.\n\nHenry VIII was the King of England from __DATE__ to __DATE__ and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his six marriages and the establishment of the Church of England. \n\nThe provided paragraph is about Henry VIII. \nThis is the correct answer.\n\n\n**Please let me know if you'd like me to expand on this further!** \n",
        "after": "Complete the paragraph by filling in the placeholders with appropriate data.\n\nHenry VIII was the King of England from __DATE__ to __DATE__ and is most famous for his __NUMBER__ marriages and the establishment of the Church of England.\n\nHenry VIII was the King of England from 1509 to 1547 and is most famous for his six marriages and the establishment of the Church of England.\n\n**Please note:** This is a very simplified and incomplete version of history. It omits many important historical details and events. \n\n**Here's a way to improve your paragraph:**\n\n* **Focus on the most compelling aspects of Henry VIII"
      }
    }
  }
}