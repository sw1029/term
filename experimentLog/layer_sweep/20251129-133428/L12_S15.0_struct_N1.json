{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 sae.layer_idx=12 experiment.layer_sweep=[12] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Describe the taste of Italian food.\n\nItalian food has a robust and flavorful taste. It is usually rich in garlic, herbs and spices, with accompaniments of varied tomatoes and cheeses. The flavor combinations of ingredients such as olives, capers and sun-dried tomatoes are often used for adding complexity to Italian dishes. The rich sauces and vibrant flavors of Italian cooking provide an unforgettable dining experience.",
  "output": {
    "before": "Describe the taste of Italian food.\n\nItalian food has a robust and flavorful taste. It is usually rich in garlic, herbs and spices, with accompaniments of varied tomatoes and cheeses. The flavor combinations of ingredients such as olives, capers and sun-dried tomatoes are often used for adding complexity to Italian dishes. The rich sauces and vibrant flavors of Italian cooking provide an unforgettable dining experience.\n\nHere's a deeper dive into the taste profiles:\n\n* **Earthy and savory:**  The use of fresh herbs like basil, oregano, and rosemary gives a distinct earthy and savory flavor. \n* **Citrusy and bright:**",
    "after": "Describe the taste of Italian food.\n\nItalian food has a robust and flavorful taste. It is usually rich in garlic, herbs and spices, with accompaniments of varied tomatoes and cheeses. The flavor combinations of ingredients such as olives, capers and sun-dried tomatoes are often used for adding complexity to Italian dishes. The rich sauces and vibrant flavors of Italian cooking provide an unforgettable dining experience.\n\n\nThis is a basic description of the taste of Italian food.\n\nHere's a breakdown of the key flavor profiles in Italian cuisine:\n\n* **Garlic:** A fundamental flavor component in many Italian dishes.\n* **Herbs:** Used liberally"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      2337,
      4444,
      5053,
      4920,
      2543,
      1657,
      8767,
      2885,
      625
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      3.228884220123291,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7076687216758728,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 7.945697203695774,
    "train_mean_l2": 5.446323892746121,
    "train_mean_l1": 2.024458252355456,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-133428/feature_std_layer_12.html",
    "mean_std": 0.8507248163223267,
    "max_std": 18.098957061767578
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          2,
          0,
          2337,
          4444,
          5053,
          4920,
          2543,
          1657,
          8767,
          2885,
          625
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          3.228884220123291,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.7076687216758728,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 2164,
            "f_before": 53.60963821411133,
            "f_after": 12.23579216003418,
            "delta_f": -41.37384605407715
          },
          {
            "index": 185,
            "f_before": 0.0,
            "f_after": 18.81158447265625,
            "delta_f": 18.81158447265625
          },
          {
            "index": 9073,
            "f_before": 20.310537338256836,
            "f_after": 5.209816932678223,
            "delta_f": -15.100720405578613
          },
          {
            "index": 1779,
            "f_before": 26.51885986328125,
            "f_after": 13.947589874267578,
            "delta_f": -12.571269989013672
          },
          {
            "index": 8219,
            "f_before": 0.0,
            "f_after": 11.836338996887207,
            "delta_f": 11.836338996887207
          },
          {
            "index": 2704,
            "f_before": 0.0,
            "f_after": 9.697516441345215,
            "delta_f": 9.697516441345215
          },
          {
            "index": 199,
            "f_before": 0.0,
            "f_after": 9.596424102783203,
            "delta_f": 9.596424102783203
          },
          {
            "index": 4550,
            "f_before": 63.19055938720703,
            "f_after": 54.176856994628906,
            "delta_f": -9.013702392578125
          },
          {
            "index": 4248,
            "f_before": 30.14463233947754,
            "f_after": 38.96466827392578,
            "delta_f": 8.820035934448242
          },
          {
            "index": 3816,
            "f_before": 8.941549301147461,
            "f_after": 17.661684036254883,
            "delta_f": 8.720134735107422
          },
          {
            "index": 590,
            "f_before": 0.0,
            "f_after": 8.527986526489258,
            "delta_f": 8.527986526489258
          },
          {
            "index": 6214,
            "f_before": 0.0,
            "f_after": 8.503177642822266,
            "delta_f": 8.503177642822266
          },
          {
            "index": 7984,
            "f_before": 0.0,
            "f_after": 8.379568099975586,
            "delta_f": 8.379568099975586
          },
          {
            "index": 4468,
            "f_before": 0.0,
            "f_after": 8.30009937286377,
            "delta_f": 8.30009937286377
          },
          {
            "index": 6152,
            "f_before": 0.0,
            "f_after": 8.074161529541016,
            "delta_f": 8.074161529541016
          },
          {
            "index": 8703,
            "f_before": 0.0,
            "f_after": 8.040210723876953,
            "delta_f": 8.040210723876953
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Describe the taste of Italian food.\n\nItalian food has a robust and flavorful taste. It is usually rich in garlic, herbs and spices, with accompaniments of varied tomatoes and cheeses. The flavor combinations of ingredients such as olives, capers and sun-dried tomatoes are often used for adding complexity to Italian dishes. The rich sauces and vibrant flavors of Italian cooking provide an unforgettable dining experience. \n\nHere are some of the defining characteristics of Italian food:\n\n**Flavor Profiles:**\n* **Freshness:** Italian cuisine emphasizes fresh, seasonal ingredients.\n* **Simplicity:** Dishes are often simple and straightforward, allowing the natural flavors of the",
        "after": "Describe the taste of Italian food.\n\nItalian food has a robust and flavorful taste. It is usually rich in garlic, herbs and spices, with accompaniments of varied tomatoes and cheeses. The flavor combinations of ingredients such as olives, capers and sun-dried tomatoes are often used for adding complexity to Italian dishes. The rich sauces and vibrant flavors of Italian cooking provide an unforgettable dining experience. \n\n**Here's a breakdown of the taste profile:**\n\n* **Savory:** The foundation of most Italian dishes is savory, with a balance of salt and umami.\n* **Sweet:** Some Italian dishes incorporate sweetness from ingredients like"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          2,
          0,
          2337,
          4444,
          5053,
          4920,
          2543,
          1657,
          8767,
          2885,
          625
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.06888670474290848,
            "f_after": 0.06888670474290848,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Describe the taste of Italian food.\n\nItalian food has a robust and flavorful taste. It is usually rich in garlic, herbs and spices, with accompaniments of varied tomatoes and cheeses. The flavor combinations of ingredients such as olives, capers and sun-dried tomatoes are often used for adding complexity to Italian dishes. The rich sauces and vibrant flavors of Italian cooking provide an unforgettable dining experience.\n\nHere are some of the key characteristics of the taste of Italian food:\n\n**Flavor Profiles:**\n* **Fresh and herbaceous:**  Basil, oregano, parsley, rosemary, thyme are common ingredients, adding bright, earthy, and slightly bitter notes",
        "after": "Describe the taste of Italian food.\n\nItalian food has a robust and flavorful taste. It is usually rich in garlic, herbs and spices, with accompaniments of varied tomatoes and cheeses. The flavor combinations of ingredients such as olives, capers and sun-dried tomatoes are often used for adding complexity to Italian dishes. The rich sauces and vibrant flavors of Italian cooking provide an unforgettable dining experience.\n\n\nThis is a general description of the taste of Italian food. \n\nHere are some specific taste profiles associated with Italian food:\n\n* **Earthy:** From ingredients like tomatoes, garlic, and mushrooms.\n* **Fresh:** From ingredients like"
      }
    }
  }
}