{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 sae.layer_idx=12 experiment.layer_sweep=[12] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Describe the taste of Italian food.\n\nItalian food has a robust and flavorful taste. It is usually rich in garlic, herbs and spices, with accompaniments of varied tomatoes and cheeses. The flavor combinations of ingredients such as olives, capers and sun-dried tomatoes are often used for adding complexity to Italian dishes. The rich sauces and vibrant flavors of Italian cooking provide an unforgettable dining experience.",
  "output": {
    "before": "Describe the taste of Italian food.\n\nItalian food has a robust and flavorful taste. It is usually rich in garlic, herbs and spices, with accompaniments of varied tomatoes and cheeses. The flavor combinations of ingredients such as olives, capers and sun-dried tomatoes are often used for adding complexity to Italian dishes. The rich sauces and vibrant flavors of Italian cooking provide an unforgettable dining experience.\n\nHere are some key characteristics of the taste of Italian food:\n\n* **Herbs and spices:** Italian cuisine heavily relies on herbs and spices like basil, oregano, rosemary, thyme, parsley, sage, and marjoram to enhance the flavor",
    "after": "Describe the taste of Italian food.\n\nItalian food has a robust and flavorful taste. It is usually rich in garlic, herbs and spices, with accompaniments of varied tomatoes and cheeses. The flavor combinations of ingredients such as olives, capers and sun-dried tomatoes are often used for adding complexity to Italian dishes. The rich sauces and vibrant flavors of Italian cooking provide an unforgettable dining experience.\n\n**Explanation:**\n\nThis is a simple explanation of the taste of Italian food. It emphasizes the key elements:\n\n* **Robustness:** The description suggests a powerful and intense flavor.\n* **Richness:** The description suggests the food is"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      5053,
      4948,
      2337,
      1657,
      4920,
      1673,
      8834,
      2543,
      4444
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      4.476685523986816,
      0.0,
      0.0,
      0.0,
      0.0,
      0.11762189865112305,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 7.945697203695774,
    "train_mean_l2": 5.446323892746121,
    "train_mean_l1": 2.024458252355456,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-133428/feature_std_layer_12.html",
    "mean_std": 0.8507248163223267,
    "max_std": 18.098957061767578
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          0,
          2,
          5053,
          4948,
          2337,
          1657,
          4920,
          1673,
          8834,
          2543,
          4444
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          4.476685523986816,
          0.0,
          0.0,
          0.0,
          0.0,
          0.11762189865112305,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 2164,
            "f_before": 53.60963821411133,
            "f_after": 16.336576461791992,
            "delta_f": -37.273061752319336
          },
          {
            "index": 1779,
            "f_before": 26.51885986328125,
            "f_after": 5.368035316467285,
            "delta_f": -21.150824546813965
          },
          {
            "index": 4248,
            "f_before": 30.14463233947754,
            "f_after": 48.50808334350586,
            "delta_f": 18.36345100402832
          },
          {
            "index": 9073,
            "f_before": 20.310537338256836,
            "f_after": 3.375732898712158,
            "delta_f": -16.934804439544678
          },
          {
            "index": 8219,
            "f_before": 0.0,
            "f_after": 12.062801361083984,
            "delta_f": 12.062801361083984
          },
          {
            "index": 185,
            "f_before": 0.0,
            "f_after": 12.057433128356934,
            "delta_f": 12.057433128356934
          },
          {
            "index": 2704,
            "f_before": 0.0,
            "f_after": 10.377020835876465,
            "delta_f": 10.377020835876465
          },
          {
            "index": 7984,
            "f_before": 0.0,
            "f_after": 9.198413848876953,
            "delta_f": 9.198413848876953
          },
          {
            "index": 6214,
            "f_before": 0.0,
            "f_after": 9.093721389770508,
            "delta_f": 9.093721389770508
          },
          {
            "index": 590,
            "f_before": 0.0,
            "f_after": 9.093278884887695,
            "delta_f": 9.093278884887695
          },
          {
            "index": 4468,
            "f_before": 0.0,
            "f_after": 8.88662338256836,
            "delta_f": 8.88662338256836
          },
          {
            "index": 6152,
            "f_before": 0.0,
            "f_after": 8.783601760864258,
            "delta_f": 8.783601760864258
          },
          {
            "index": 8703,
            "f_before": 0.0,
            "f_after": 8.71426773071289,
            "delta_f": 8.71426773071289
          },
          {
            "index": 2742,
            "f_before": 0.0,
            "f_after": 8.146574974060059,
            "delta_f": 8.146574974060059
          },
          {
            "index": 2204,
            "f_before": 0.0,
            "f_after": 8.044276237487793,
            "delta_f": 8.044276237487793
          },
          {
            "index": 8446,
            "f_before": 0.0,
            "f_after": 7.826237201690674,
            "delta_f": 7.826237201690674
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Describe the taste of Italian food.\n\nItalian food has a robust and flavorful taste. It is usually rich in garlic, herbs and spices, with accompaniments of varied tomatoes and cheeses. The flavor combinations of ingredients such as olives, capers and sun-dried tomatoes are often used for adding complexity to Italian dishes. The rich sauces and vibrant flavors of Italian cooking provide an unforgettable dining experience. \n\nHere are some specific aspects of the taste of Italian food:\n\n**Fresh and Simple:**  Many Italian dishes prioritize fresh, seasonal ingredients. The flavors are often allowed to shine through without heavy sauces or overpowering spices.\n\n**Earthy and",
        "after": "Describe the taste of Italian food.\n\nItalian food has a robust and flavorful taste. It is usually rich in garlic, herbs and spices, with accompaniments of varied tomatoes and cheeses. The flavor combinations of ingredients such as olives, capers and sun-dried tomatoes are often used for adding complexity to Italian dishes. The rich sauces and vibrant flavors of Italian cooking provide an unforgettable dining experience.\n\nHere's a breakdown of common Italian taste characteristics:\n\n* **Freshness:** Italian cuisine emphasizes fresh ingredients.\n* **Simplicity:** Italian dishes often have minimal ingredients.\n* **Balanced Flavors:** Italian dishes strive for balance between savory"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          0,
          2,
          5053,
          4948,
          2337,
          1657,
          4920,
          1673,
          8834,
          2543,
          4444
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.06888670474290848,
            "f_after": 0.06888670474290848,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Describe the taste of Italian food.\n\nItalian food has a robust and flavorful taste. It is usually rich in garlic, herbs and spices, with accompaniments of varied tomatoes and cheeses. The flavor combinations of ingredients such as olives, capers and sun-dried tomatoes are often used for adding complexity to Italian dishes. The rich sauces and vibrant flavors of Italian cooking provide an unforgettable dining experience.\n\nHere's a breakdown of the typical taste profile of Italian food:\n\n**Key Flavors:**\n* **Herbs and Spices:** Basil, oregano, rosemary, thyme, parsley, and others are commonly used to add depth and complexity to",
        "after": "Describe the taste of Italian food.\n\nItalian food has a robust and flavorful taste. It is usually rich in garlic, herbs and spices, with accompaniments of varied tomatoes and cheeses. The flavor combinations of ingredients such as olives, capers and sun-dried tomatoes are often used for adding complexity to Italian dishes. The rich sauces and vibrant flavors of Italian cooking provide an unforgettable dining experience.\n\n\nThis is a basic description of the taste of Italian food.\n"
      }
    }
  }
}