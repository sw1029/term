{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 sae.layer_idx=12 experiment.layer_sweep=[12] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Describe the impact of the industrial revolution\n\nThe industrial revolution had a profound impact on society. It brought new innovations in technology, production methods, and industrial organization, which resulted in increased productivity and manufacturing capabilities. Additionally, it led to increased wealth generation, population growth, and improved living standards. It also resulted in the expanding roles of machines in work and home life, as well as in enhanced consumer access to consumer goods.",
  "output": {
    "before": "Describe the impact of the industrial revolution\n\nThe industrial revolution had a profound impact on society. It brought new innovations in technology, production methods, and industrial organization, which resulted in increased productivity and manufacturing capabilities. Additionally, it led to increased wealth generation, population growth, and improved living standards. It also resulted in the expanding roles of machines in work and home life, as well as in enhanced consumer access to consumer goods.\n\n**Positive Impacts:**\n\n* **Increased productivity and efficiency:** New inventions like the steam engine, power loom, and cotton gin revolutionized production, leading to faster and more efficient manufacturing.\n* **Mass production:** The factory system allowed for the",
    "after": "Describe the impact of the industrial revolution\n\nThe industrial revolution had a profound impact on society. It brought new innovations in technology, production methods, and industrial organization, which resulted in increased productivity and manufacturing capabilities. Additionally, it led to increased wealth generation, population growth, and improved living standards. It also resulted in the expanding roles of machines in work and home life, as well as in enhanced consumer access to consumer goods. \n\nThe following are some of the key impacts of the industrial revolution:\n\n* **Economic Growth:** Increased productivity, innovation, and competition led to economic growth and development.\n* **Job Creation:** New technologies and industries created a large number of"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      2337,
      4444,
      5053,
      4920,
      2543,
      1657,
      8767,
      2885,
      625
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.2087586224079132,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.7733579277992249,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.2147626280784607,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 7.945697203695774,
    "train_mean_l2": 5.446323892746121,
    "train_mean_l1": 2.024458252355456,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-133428/feature_std_layer_12.html",
    "mean_std": 0.8507248163223267,
    "max_std": 18.098957061767578
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          2,
          0,
          2337,
          4444,
          5053,
          4920,
          2543,
          1657,
          8767,
          2885,
          625
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.2087586224079132,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.7733579277992249,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.2147626280784607,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 2164,
            "f_before": 53.06747817993164,
            "f_after": 12.73029899597168,
            "delta_f": -40.33717918395996
          },
          {
            "index": 185,
            "f_before": 0.0,
            "f_after": 18.26630401611328,
            "delta_f": 18.26630401611328
          },
          {
            "index": 9073,
            "f_before": 20.528799057006836,
            "f_after": 5.190280437469482,
            "delta_f": -15.338518619537354
          },
          {
            "index": 1779,
            "f_before": 34.324520111083984,
            "f_after": 21.724109649658203,
            "delta_f": -12.600410461425781
          },
          {
            "index": 8219,
            "f_before": 0.0,
            "f_after": 11.231670379638672,
            "delta_f": 11.231670379638672
          },
          {
            "index": 199,
            "f_before": 1.173572063446045,
            "f_after": 11.446722030639648,
            "delta_f": 10.273149967193604
          },
          {
            "index": 2704,
            "f_before": 0.0,
            "f_after": 9.589828491210938,
            "delta_f": 9.589828491210938
          },
          {
            "index": 4248,
            "f_before": 31.921714782714844,
            "f_after": 41.40083694458008,
            "delta_f": 9.479122161865234
          },
          {
            "index": 590,
            "f_before": 0.0,
            "f_after": 9.051533699035645,
            "delta_f": 9.051533699035645
          },
          {
            "index": 3816,
            "f_before": 3.305067300796509,
            "f_after": 12.29409408569336,
            "delta_f": 8.98902678489685
          },
          {
            "index": 6214,
            "f_before": 0.0,
            "f_after": 8.886955261230469,
            "delta_f": 8.886955261230469
          },
          {
            "index": 4468,
            "f_before": 0.0,
            "f_after": 8.720993041992188,
            "delta_f": 8.720993041992188
          },
          {
            "index": 5918,
            "f_before": 0.0,
            "f_after": 8.277057647705078,
            "delta_f": 8.277057647705078
          },
          {
            "index": 4550,
            "f_before": 62.11684036254883,
            "f_after": 53.8520393371582,
            "delta_f": -8.264801025390625
          },
          {
            "index": 2204,
            "f_before": 0.0,
            "f_after": 7.989765644073486,
            "delta_f": 7.989765644073486
          },
          {
            "index": 8446,
            "f_before": 0.0,
            "f_after": 7.705103397369385,
            "delta_f": 7.705103397369385
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Describe the impact of the industrial revolution\n\nThe industrial revolution had a profound impact on society. It brought new innovations in technology, production methods, and industrial organization, which resulted in increased productivity and manufacturing capabilities. Additionally, it led to increased wealth generation, population growth, and improved living standards. It also resulted in the expanding roles of machines in work and home life, as well as in enhanced consumer access to consumer goods. \n\n**Positive Impacts:**\n\n* **Increased Productivity and Economic Growth:** New technologies like the steam engine, cotton gin, and power loom significantly increased production efficiency, leading to a surge in economic growth and wealth. \n* **Improved Living Standards",
        "after": "Describe the impact of the industrial revolution\n\nThe industrial revolution had a profound impact on society. It brought new innovations in technology, production methods, and industrial organization, which resulted in increased productivity and manufacturing capabilities. Additionally, it led to increased wealth generation, population growth, and improved living standards. It also resulted in the expanding roles of machines in work and home life, as well as in enhanced consumer access to consumer goods.\n\nHere's a breakdown of the impact of the industrial revolution:\n\n**Economic Impact:**\n* **Increased Productivity:** Machines and automation significantly increased production efficiency, leading to higher output and lower costs.\n* **Mass Production:** Enabled mass production"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          2,
          0,
          2337,
          4444,
          5053,
          4920,
          2543,
          1657,
          8767,
          2885,
          625
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.2087586224079132,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.2087586224079132,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Describe the impact of the industrial revolution\n\nThe industrial revolution had a profound impact on society. It brought new innovations in technology, production methods, and industrial organization, which resulted in increased productivity and manufacturing capabilities. Additionally, it led to increased wealth generation, population growth, and improved living standards. It also resulted in the expanding roles of machines in work and home life, as well as in enhanced consumer access to consumer goods.\n\n**Positive Impacts:**\n\n* **Increased productivity and efficiency:** Technological advancements like the steam engine, power loom, and cotton gin revolutionized production, leading to faster and more efficient manufacturing.\n* **Economic growth:** The mass production of goods fueled",
        "after": "Describe the impact of the industrial revolution\n\nThe industrial revolution had a profound impact on society. It brought new innovations in technology, production methods, and industrial organization, which resulted in increased productivity and manufacturing capabilities. Additionally, it led to increased wealth generation, population growth, and improved living standards. It also resulted in the expanding roles of machines in work and home life, as well as in enhanced consumer access to consumer goods.\n\n\nHere's a breakdown of the impact of the industrial revolution:\n\n**Economic Impact:**\n\n* **Increased Productivity:**  The automation of factories and machinery led to increased output and efficiency.\n* **Globalization:**  Manufacturing became a global industry"
      }
    }
  }
}