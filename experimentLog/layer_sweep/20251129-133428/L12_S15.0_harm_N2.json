{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 sae.layer_idx=12 experiment.layer_sweep=[12] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Describe the impact of the industrial revolution\n\nThe industrial revolution had a profound impact on society. It brought new innovations in technology, production methods, and industrial organization, which resulted in increased productivity and manufacturing capabilities. Additionally, it led to increased wealth generation, population growth, and improved living standards. It also resulted in the expanding roles of machines in work and home life, as well as in enhanced consumer access to consumer goods.",
  "output": {
    "before": "Describe the impact of the industrial revolution\n\nThe industrial revolution had a profound impact on society. It brought new innovations in technology, production methods, and industrial organization, which resulted in increased productivity and manufacturing capabilities. Additionally, it led to increased wealth generation, population growth, and improved living standards. It also resulted in the expanding roles of machines in work and home life, as well as in enhanced consumer access to consumer goods.\n\n**Positive Impacts:**\n\n* **Economic Growth:** The industrial revolution spurred economic growth by increasing productivity and creating new industries. \n* **Technological Advancements:** Innovations like the steam engine, power loom, and cotton gin led to increased efficiency and",
    "after": "Describe the impact of the industrial revolution\n\nThe industrial revolution had a profound impact on society. It brought new innovations in technology, production methods, and industrial organization, which resulted in increased productivity and manufacturing capabilities. Additionally, it led to increased wealth generation, population growth, and improved living standards. It also resulted in the expanding roles of machines in work and home life, as well as in enhanced consumer access to consumer goods.\n\nHowever, it is important to acknowledge that the industrial revolution wasn't just a positive thing. It was a complex and nuanced experience. It brought about many new challenges and problems that came with it, including social unrest, poverty, disease, and"
  },
  "feature_stats": {
    "indices": [
      1,
      103,
      5385,
      4225,
      822,
      5631,
      38,
      843,
      5487,
      4092,
      1470
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.015781819820404053,
      0.0
    ],
    "f_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      1.7123486995697021,
      0.0,
      3.055393934249878,
      0.862919270992279,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 7.945697203695774,
    "train_mean_l2": 5.446323892746121,
    "train_mean_l1": 2.024458252355456,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-133428/feature_std_layer_12.html",
    "mean_std": 0.8507248163223267,
    "max_std": 18.098957061767578
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          1,
          103,
          5385,
          4225,
          822,
          5631,
          38,
          843,
          5487,
          4092,
          1470
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.015781819820404053,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          1.7123486995697021,
          0.0,
          3.055393934249878,
          0.862919270992279,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 4550,
            "f_before": 62.11684036254883,
            "f_after": 103.88331604003906,
            "delta_f": 41.766475677490234
          },
          {
            "index": 2164,
            "f_before": 53.06747817993164,
            "f_after": 82.6139144897461,
            "delta_f": 29.546436309814453
          },
          {
            "index": 9073,
            "f_before": 20.528799057006836,
            "f_after": 43.53114318847656,
            "delta_f": 23.002344131469727
          },
          {
            "index": 4248,
            "f_before": 31.921714782714844,
            "f_after": 47.12409210205078,
            "delta_f": 15.202377319335938
          },
          {
            "index": 1779,
            "f_before": 34.324520111083984,
            "f_after": 47.38853073120117,
            "delta_f": 13.064010620117188
          },
          {
            "index": 8719,
            "f_before": 0.0,
            "f_after": 9.96643352508545,
            "delta_f": 9.96643352508545
          },
          {
            "index": 1438,
            "f_before": 0.0,
            "f_after": 5.058620929718018,
            "delta_f": 5.058620929718018
          },
          {
            "index": 5175,
            "f_before": 0.0,
            "f_after": 4.433907508850098,
            "delta_f": 4.433907508850098
          },
          {
            "index": 218,
            "f_before": 0.7160963416099548,
            "f_after": 5.114462852478027,
            "delta_f": 4.3983665108680725
          },
          {
            "index": 7555,
            "f_before": 0.32912713289260864,
            "f_after": 4.701171875,
            "delta_f": 4.372044742107391
          },
          {
            "index": 6109,
            "f_before": 0.15379996597766876,
            "f_after": 4.463322639465332,
            "delta_f": 4.309522673487663
          },
          {
            "index": 8937,
            "f_before": 0.35391172766685486,
            "f_after": 4.6524338722229,
            "delta_f": 4.2985221445560455
          },
          {
            "index": 2237,
            "f_before": 0.38596975803375244,
            "f_after": 4.670945167541504,
            "delta_f": 4.2849754095077515
          },
          {
            "index": 2808,
            "f_before": 0.515558660030365,
            "f_after": 4.747723579406738,
            "delta_f": 4.232164919376373
          },
          {
            "index": 3884,
            "f_before": 0.0,
            "f_after": 4.157590866088867,
            "delta_f": 4.157590866088867
          },
          {
            "index": 8727,
            "f_before": 0.05112339183688164,
            "f_after": 4.160665035247803,
            "delta_f": 4.109541643410921
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Describe the impact of the industrial revolution\n\nThe industrial revolution had a profound impact on society. It brought new innovations in technology, production methods, and industrial organization, which resulted in increased productivity and manufacturing capabilities. Additionally, it led to increased wealth generation, population growth, and improved living standards. It also resulted in the expanding roles of machines in work and home life, as well as in enhanced consumer access to consumer goods. \n\nHere's a breakdown of the key impacts:\n\n**Positive Impacts:**\n\n* **Increased Productivity:** New inventions like the steam engine, power loom, and cotton gin revolutionized manufacturing, leading to increased production and lower costs. \n",
        "after": "Describe the impact of the industrial revolution\n\nThe industrial revolution had a profound impact on society. It brought new innovations in technology, production methods, and industrial organization, which resulted in increased productivity and manufacturing capabilities. Additionally, it led to increased wealth generation, population growth, and improved living standards. It also resulted in the expanding roles of machines in work and home life, as well as in enhanced consumer access to consumer goods.\n\nHere's a breakdown of the impact of the industrial revolution:\n\n**Positive Impacts:**\n\n* **Increased Productivity and Wealth:** Machines and factories became more efficient, leading to an increase in production. This led to an economic boom, which fueled"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          1,
          103,
          5385,
          4225,
          822,
          5631,
          38,
          843,
          5487,
          4092,
          1470
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.015781819820404053,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.015781819820404053,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Describe the impact of the industrial revolution\n\nThe industrial revolution had a profound impact on society. It brought new innovations in technology, production methods, and industrial organization, which resulted in increased productivity and manufacturing capabilities. Additionally, it led to increased wealth generation, population growth, and improved living standards. It also resulted in the expanding roles of machines in work and home life, as well as in enhanced consumer access to consumer goods.\n\nHowever, the industrial revolution also had negative consequences, including pollution, exploitation of workers, social unrest, and inequality. These consequences stemmed from the rapid pace of technological advancement, the concentration of power in the hands of a few, and the social and",
        "after": "Describe the impact of the industrial revolution\n\nThe industrial revolution had a profound impact on society. It brought new innovations in technology, production methods, and industrial organization, which resulted in increased productivity and manufacturing capabilities. Additionally, it led to increased wealth generation, population growth, and improved living standards. It also resulted in the expanding roles of machines in work and home life, as well as in enhanced consumer access to consumer goods.\n\nIt's important to note that these impacts are not universally positive. While many people see the industrial revolution as a necessary and positive change, others find it to be a deeply disturbing and unsettling experience. \n\nPlease continue the story by expanding on"
      }
    }
  }
}