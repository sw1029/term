{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 sae.layer_idx=12 experiment.layer_sweep=[12] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Describe the impact of the industrial revolution\n\nThe industrial revolution had a profound impact on society. It brought new innovations in technology, production methods, and industrial organization, which resulted in increased productivity and manufacturing capabilities. Additionally, it led to increased wealth generation, population growth, and improved living standards. It also resulted in the expanding roles of machines in work and home life, as well as in enhanced consumer access to consumer goods.",
  "output": {
    "before": "Describe the impact of the industrial revolution\n\nThe industrial revolution had a profound impact on society. It brought new innovations in technology, production methods, and industrial organization, which resulted in increased productivity and manufacturing capabilities. Additionally, it led to increased wealth generation, population growth, and improved living standards. It also resulted in the expanding roles of machines in work and home life, as well as in enhanced consumer access to consumer goods. However, the revolution also had significant social and environmental consequences. \n\nHere's a breakdown of the key impacts:\n\n**Positive Impacts:**\n\n* **Increased Productivity and Economic Growth:**  New inventions like the steam engine and power loom increased production",
    "after": "Describe the impact of the industrial revolution\n\nThe industrial revolution had a profound impact on society. It brought new innovations in technology, production methods, and industrial organization, which resulted in increased productivity and manufacturing capabilities. Additionally, it led to increased wealth generation, population growth, and improved living standards. It also resulted in the expanding roles of machines in work and home life, as well as in enhanced consumer access to consumer goods.\n\nHere's a breakdown of the impact based on different aspects:\n\n**Economy:**\n\n* **Increased Productivity:** New technologies and production methods boosted efficiency.\n* **Increased Trade:** Globalized trade expanded markets and opportunities.\n* **Global"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      5053,
      4948,
      2337,
      1657,
      4920,
      1673,
      8834,
      2543,
      4444
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      2.023632287979126,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 7.945697203695774,
    "train_mean_l2": 5.446323892746121,
    "train_mean_l1": 2.024458252355456,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-133428/feature_std_layer_12.html",
    "mean_std": 0.8507248163223267,
    "max_std": 18.098957061767578
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          0,
          2,
          5053,
          4948,
          2337,
          1657,
          4920,
          1673,
          8834,
          2543,
          4444
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          2.023632287979126,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 2164,
            "f_before": 53.06747817993164,
            "f_after": 16.818138122558594,
            "delta_f": -36.24934005737305
          },
          {
            "index": 1779,
            "f_before": 34.324520111083984,
            "f_after": 13.1358642578125,
            "delta_f": -21.188655853271484
          },
          {
            "index": 4248,
            "f_before": 31.921714782714844,
            "f_after": 50.954593658447266,
            "delta_f": 19.032878875732422
          },
          {
            "index": 9073,
            "f_before": 20.528799057006836,
            "f_after": 3.349346876144409,
            "delta_f": -17.179452180862427
          },
          {
            "index": 185,
            "f_before": 0.0,
            "f_after": 11.517782211303711,
            "delta_f": 11.517782211303711
          },
          {
            "index": 8219,
            "f_before": 0.0,
            "f_after": 11.465590476989746,
            "delta_f": 11.465590476989746
          },
          {
            "index": 2704,
            "f_before": 0.0,
            "f_after": 10.274858474731445,
            "delta_f": 10.274858474731445
          },
          {
            "index": 590,
            "f_before": 0.0,
            "f_after": 9.6221923828125,
            "delta_f": 9.6221923828125
          },
          {
            "index": 6214,
            "f_before": 0.0,
            "f_after": 9.48259449005127,
            "delta_f": 9.48259449005127
          },
          {
            "index": 4468,
            "f_before": 0.0,
            "f_after": 9.312738418579102,
            "delta_f": 9.312738418579102
          },
          {
            "index": 6152,
            "f_before": 0.0,
            "f_after": 8.40830135345459,
            "delta_f": 8.40830135345459
          },
          {
            "index": 5918,
            "f_before": 0.0,
            "f_after": 8.353863716125488,
            "delta_f": 8.353863716125488
          },
          {
            "index": 7984,
            "f_before": 0.0,
            "f_after": 8.0724458694458,
            "delta_f": 8.0724458694458
          },
          {
            "index": 2204,
            "f_before": 0.0,
            "f_after": 8.01113224029541,
            "delta_f": 8.01113224029541
          },
          {
            "index": 2742,
            "f_before": 0.0,
            "f_after": 7.939783096313477,
            "delta_f": 7.939783096313477
          },
          {
            "index": 8446,
            "f_before": 0.0,
            "f_after": 7.51987361907959,
            "delta_f": 7.51987361907959
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Describe the impact of the industrial revolution\n\nThe industrial revolution had a profound impact on society. It brought new innovations in technology, production methods, and industrial organization, which resulted in increased productivity and manufacturing capabilities. Additionally, it led to increased wealth generation, population growth, and improved living standards. It also resulted in the expanding roles of machines in work and home life, as well as in enhanced consumer access to consumer goods. However, the revolution also had some negative consequences, including environmental pollution, social inequalities, and labor exploitation.\n\n**Positive Impacts:**\n\n* **Increased productivity and efficiency:**  New technologies like the steam engine and power loom led to faster and more efficient",
        "after": "Describe the impact of the industrial revolution\n\nThe industrial revolution had a profound impact on society. It brought new innovations in technology, production methods, and industrial organization, which resulted in increased productivity and manufacturing capabilities. Additionally, it led to increased wealth generation, population growth, and improved living standards. It also resulted in the expanding roles of machines in work and home life, as well as in enhanced consumer access to consumer goods.\n\n\nHere's a breakdown of the impact:\n\n**Positive Impacts:**\n\n* **Economic growth:** Increased productivity, higher output, and greater wealth generation.\n* **Job creation:** New industries and job opportunities in manufacturing, transportation, and other"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          0,
          2,
          5053,
          4948,
          2337,
          1657,
          4920,
          1673,
          8834,
          2543,
          4444
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Describe the impact of the industrial revolution\n\nThe industrial revolution had a profound impact on society. It brought new innovations in technology, production methods, and industrial organization, which resulted in increased productivity and manufacturing capabilities. Additionally, it led to increased wealth generation, population growth, and improved living standards. It also resulted in the expanding roles of machines in work and home life, as well as in enhanced consumer access to consumer goods.\n\nHere's a breakdown of the impact:\n\n**Positive Impacts:**\n\n* **Increased Productivity and Efficiency:** The introduction of new machines and production methods, like the steam engine and power loom, significantly increased output and reduced production time.\n*",
        "after": "Describe the impact of the industrial revolution\n\nThe industrial revolution had a profound impact on society. It brought new innovations in technology, production methods, and industrial organization, which resulted in increased productivity and manufacturing capabilities. Additionally, it led to increased wealth generation, population growth, and improved living standards. It also resulted in the expanding roles of machines in work and home life, as well as in enhanced consumer access to consumer goods.\n\nHere's a breakdown of its impact:\n\n**Economic Impact:**\n* **Increased Productivity and Manufacturing:** Machines and factories became more efficient, leading to increased production.\n* **New Markets and Economies:** New markets and economies were created,"
      }
    }
  }
}