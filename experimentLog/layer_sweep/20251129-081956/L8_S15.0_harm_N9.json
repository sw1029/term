{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 8,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.05 sae.alpha_concept.harm=0.05 sae.alpha_concept.struct=0.05 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035 sae.layer_idx=8 experiment.layer_sweep=[8] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.05,
      "harm": 0.05,
      "struct": 0.05
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      8
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 7
  },
  "prompt": "Sketch a chair design with an ergonomic shape.\n\nThe design will feature a curved backrest and a wide armrest for comfortable seating. It will also have a slightly curved seat and a supportive base for stability. The ergonomic design will provide optimal lumbar support to prevent strain on the back and help with posture. Additionally, the chair will have adjustable height and tilt settings to suit the individual user.",
  "output": {
    "before": "Sketch a chair design with an ergonomic shape.\n\nThe design will feature a curved backrest and a wide armrest for comfortable seating. It will also have a slightly curved seat and a supportive base for stability. The ergonomic design will provide optimal lumbar support to prevent strain on the back and help with posture. Additionally, the chair will have adjustable height and tilt settings to suit the individual user. \n\n**Here's a breakdown of the design elements:**\n\n* **Backrest:** Curved, contoured to the natural curve of the back, with a slight dip at the lower back for lumbar support.\n* **Armrest:** Wide",
    "after": "Sketch a chair design with an ergonomic shape.\n\nThe design will feature a curved backrest and a wide armrest for comfortable seating. It will also have a slightly curved seat and a supportive base for stability. The ergonomic design will provide optimal lumbar support to prevent strain on the back and help with posture. Additionally, the chair will have adjustable height and tilt settings to suit the individual user. \n\n**What are some of the features you'd like to see in this chair?**\n\n* **Material:**\n    * Leather or a high-quality fabric upholstery? \n* **Color:**\n    *  Would you like"
  },
  "feature_stats": {
    "indices": [
      1,
      2527,
      4486,
      2676,
      6161,
      0,
      6089,
      5620,
      7885,
      301,
      2663
    ],
    "f_before": [
      81.05043029785156,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      212.50453186035156,
      0.3769623637199402,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7154138684272766,
      0.6636020541191101,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 3.898901983863674,
    "train_mean_l2": 2.7101913648620246,
    "train_mean_l1": 1.4800856967270375,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-081956/feature_std_layer_8.html",
    "mean_std": 0.39236578345298767,
    "max_std": 33.38655471801758
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 7,
      "feature_stats": {
        "indices": [
          1,
          2527,
          4486,
          2676,
          6161,
          0,
          6089,
          5620,
          7885,
          301,
          2663
        ],
        "f_before": [
          81.05043029785156,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          212.50453186035156,
          0.3769623637199402,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.7154138684272766,
          0.6636020541191101,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 1,
            "f_before": 81.05043029785156,
            "f_after": 212.50453186035156,
            "delta_f": 131.4541015625
          },
          {
            "index": 6148,
            "f_before": 3.9299652576446533,
            "f_after": 12.40650749206543,
            "delta_f": 8.476542234420776
          },
          {
            "index": 643,
            "f_before": 4.924057483673096,
            "f_after": 12.077274322509766,
            "delta_f": 7.15321683883667
          },
          {
            "index": 1799,
            "f_before": 6.034626483917236,
            "f_after": 12.934734344482422,
            "delta_f": 6.9001078605651855
          },
          {
            "index": 6098,
            "f_before": 10.321369171142578,
            "f_after": 3.867239236831665,
            "delta_f": -6.454129934310913
          },
          {
            "index": 113,
            "f_before": 2.9345955848693848,
            "f_after": 8.298583984375,
            "delta_f": 5.363988399505615
          },
          {
            "index": 6827,
            "f_before": 3.5692856311798096,
            "f_after": 8.39378833770752,
            "delta_f": 4.82450270652771
          },
          {
            "index": 2471,
            "f_before": 3.0717523097991943,
            "f_after": 7.8815789222717285,
            "delta_f": 4.809826612472534
          },
          {
            "index": 7643,
            "f_before": 2.6686034202575684,
            "f_after": 7.300745964050293,
            "delta_f": 4.632142543792725
          },
          {
            "index": 2018,
            "f_before": 0.0,
            "f_after": 4.037425994873047,
            "delta_f": 4.037425994873047
          },
          {
            "index": 7610,
            "f_before": 2.5825536251068115,
            "f_after": 6.497925758361816,
            "delta_f": 3.915372133255005
          },
          {
            "index": 4272,
            "f_before": 0.0,
            "f_after": 3.8630425930023193,
            "delta_f": 3.8630425930023193
          },
          {
            "index": 8641,
            "f_before": 0.0,
            "f_after": 3.790003776550293,
            "delta_f": 3.790003776550293
          },
          {
            "index": 3115,
            "f_before": 3.0820252895355225,
            "f_after": 6.8712873458862305,
            "delta_f": 3.789262056350708
          },
          {
            "index": 7144,
            "f_before": 3.576766014099121,
            "f_after": 7.357638835906982,
            "delta_f": 3.7808728218078613
          },
          {
            "index": 1724,
            "f_before": 0.0,
            "f_after": 3.700688123703003,
            "delta_f": 3.700688123703003
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Sketch a chair design with an ergonomic shape.\n\nThe design will feature a curved backrest and a wide armrest for comfortable seating. It will also have a slightly curved seat and a supportive base for stability. The ergonomic design will provide optimal lumbar support to prevent strain on the back and help with posture. Additionally, the chair will have adjustable height and tilt settings to suit the individual user.\n\nHere's a breakdown of the chair's features:\n\n* **Backrest:** Curved with a gentle slope, accommodating the natural curve of the spine.\n* **Armrests:** Wide, padded armrests for elbow comfort and support.",
        "after": "Sketch a chair design with an ergonomic shape.\n\nThe design will feature a curved backrest and a wide armrest for comfortable seating. It will also have a slightly curved seat and a supportive base for stability. The ergonomic design will provide optimal lumbar support to prevent strain on the back and help with posture. Additionally, the chair will have adjustable height and tilt settings to suit the individual user.\n\nI can't wait to get my hands on one of these chairs! \n\nWhat kind of material would you recommend for the chair? Leather is classic, but is there anything else that you would recommend? \n\nLet me know what you"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 8,
      "feature_stats": {
        "indices": [
          1,
          2527,
          4486,
          2676,
          6161,
          0,
          6089,
          5620,
          7885,
          301,
          2663
        ],
        "f_before": [
          81.05043029785156,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          81.05043029785156,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 81.05043029785156,
            "f_after": 81.05043029785156,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Sketch a chair design with an ergonomic shape.\n\nThe design will feature a curved backrest and a wide armrest for comfortable seating. It will also have a slightly curved seat and a supportive base for stability. The ergonomic design will provide optimal lumbar support to prevent strain on the back and help with posture. Additionally, the chair will have adjustable height and tilt settings to suit the individual user.\n\nHere's a breakdown of the design features:\n\n* **Backrest:** Curved and angled to provide support for the lower back. \n* **Armrests:** Wide and adjustable, allowing for different arm positioning.\n* **Seat:**",
        "after": "Sketch a chair design with an ergonomic shape.\n\nThe design will feature a curved backrest and a wide armrest for comfortable seating. It will also have a slightly curved seat and a supportive base for stability. The ergonomic design will provide optimal lumbar support to prevent strain on the back and help with posture. Additionally, the chair will have adjustable height and tilt settings to suit the individual user.\n\nHere's the breakdown of the chair's design features:\n\n**Backrest:**\n- Curvature: Contoured and rounded, providing excellent back support.\n- Material:  High-quality, breathable mesh fabric for optimal comfort and"
      }
    }
  }
}