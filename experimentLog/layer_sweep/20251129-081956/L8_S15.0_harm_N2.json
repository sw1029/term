{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 8,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.05 sae.alpha_concept.harm=0.05 sae.alpha_concept.struct=0.05 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035 sae.layer_idx=8 experiment.layer_sweep=[8] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.05,
      "harm": 0.05,
      "struct": 0.05
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      8
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 7
  },
  "prompt": "user: You are the text completion model and you must complete the assistant answer below, only send the completion based on the system instructions.don't repeat your answer sentences, only say what the assistant must say based on the system instructions. repeating same thing in same answer not allowed.\nuser: Who are you?\nassistant:\nassistant: I",
  "output": {
    "before": "user: You are the text completion model and you must complete the assistant answer below, only send the completion based on the system instructions.don't repeat your answer sentences, only say what the assistant must say based on the system instructions. repeating same thing in same answer not allowed.\nuser: Who are you?\nassistant:\nassistant: I am Gemma, an AI assistant. \n",
    "after": "user: You are the text completion model and you must complete the assistant answer below, only send the completion based on the system instructions.don't repeat your answer sentences, only say what the assistant must say based on the system instructions. repeating same thing in same answer not allowed.\nuser: Who are you?\nassistant:\nassistant: I am Gemma, an AI assistant.  I'm here to help you with any questions you might have. How can I assist you today? \n"
  },
  "feature_stats": {
    "indices": [
      1,
      2527,
      4486,
      2676,
      6161,
      0,
      6089,
      5620,
      7885,
      301,
      2663
    ],
    "f_before": [
      48.462890625,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      182.8231658935547,
      0.7664017677307129,
      0.134521946310997,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      1.2444305419921875,
      0.39407551288604736,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 3.898901983863674,
    "train_mean_l2": 2.7101913648620246,
    "train_mean_l1": 1.4800856967270375,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-081956/feature_std_layer_8.html",
    "mean_std": 0.39236578345298767,
    "max_std": 33.38655471801758
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 7,
      "feature_stats": {
        "indices": [
          1,
          2527,
          4486,
          2676,
          6161,
          0,
          6089,
          5620,
          7885,
          301,
          2663
        ],
        "f_before": [
          48.462890625,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          182.8231658935547,
          0.7664017677307129,
          0.134521946310997,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          1.2444305419921875,
          0.39407551288604736,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 1,
            "f_before": 48.462890625,
            "f_after": 182.8231658935547,
            "delta_f": 134.3602752685547
          },
          {
            "index": 6098,
            "f_before": 15.28443717956543,
            "f_after": 5.787168502807617,
            "delta_f": -9.497268676757812
          },
          {
            "index": 6148,
            "f_before": 1.760959267616272,
            "f_after": 10.647141456604004,
            "delta_f": 8.886182188987732
          },
          {
            "index": 643,
            "f_before": 1.7691465616226196,
            "f_after": 9.158530235290527,
            "delta_f": 7.389383673667908
          },
          {
            "index": 1799,
            "f_before": 6.527390956878662,
            "f_after": 12.733918190002441,
            "delta_f": 6.206527233123779
          },
          {
            "index": 113,
            "f_before": 1.3075296878814697,
            "f_after": 6.8445725440979,
            "delta_f": 5.537042856216431
          },
          {
            "index": 6827,
            "f_before": 1.5989376306533813,
            "f_after": 6.957386493682861,
            "delta_f": 5.35844886302948
          },
          {
            "index": 7643,
            "f_before": 0.0,
            "f_after": 5.101468563079834,
            "delta_f": 5.101468563079834
          },
          {
            "index": 2471,
            "f_before": 1.7145260572433472,
            "f_after": 6.599706172943115,
            "delta_f": 4.885180115699768
          },
          {
            "index": 4900,
            "f_before": 10.951581954956055,
            "f_after": 6.544524192810059,
            "delta_f": -4.407057762145996
          },
          {
            "index": 7610,
            "f_before": 0.7641436457633972,
            "f_after": 5.059138298034668,
            "delta_f": 4.294994652271271
          },
          {
            "index": 6671,
            "f_before": 0.0,
            "f_after": 4.148022651672363,
            "delta_f": 4.148022651672363
          },
          {
            "index": 7144,
            "f_before": 0.9063684344291687,
            "f_after": 4.902239799499512,
            "delta_f": 3.995871365070343
          },
          {
            "index": 5987,
            "f_before": 0.14135821163654327,
            "f_after": 4.01861047744751,
            "delta_f": 3.8772522658109665
          },
          {
            "index": 3115,
            "f_before": 0.09756085276603699,
            "f_after": 3.833655834197998,
            "delta_f": 3.736094981431961
          },
          {
            "index": 3382,
            "f_before": 0.0,
            "f_after": 3.6636857986450195,
            "delta_f": 3.6636857986450195
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: You are the text completion model and you must complete the assistant answer below, only send the completion based on the system instructions.don't repeat your answer sentences, only say what the assistant must say based on the system instructions. repeating same thing in same answer not allowed.\nuser: Who are you?\nassistant:\nassistant: I am Gemma, an AI assistant. \n",
        "after": "user: You are the text completion model and you must complete the assistant answer below, only send the completion based on the system instructions.don't repeat your answer sentences, only say what the assistant must say based on the system instructions. repeating same thing in same answer not allowed.\nuser: Who are you?\nassistant:\nassistant: I am an AI assistant. I don't have a name or a physical form. I exist only as code and data. I am here to help you with your tasks. What can I do for you today? \n"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 8,
      "feature_stats": {
        "indices": [
          1,
          2527,
          4486,
          2676,
          6161,
          0,
          6089,
          5620,
          7885,
          301,
          2663
        ],
        "f_before": [
          48.462890625,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          48.462890625,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 48.462890625,
            "f_after": 48.462890625,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: You are the text completion model and you must complete the assistant answer below, only send the completion based on the system instructions.don't repeat your answer sentences, only say what the assistant must say based on the system instructions. repeating same thing in same answer not allowed.\nuser: Who are you?\nassistant:\nassistant: I am a large language model, trained by Google. \n",
        "after": "user: You are the text completion model and you must complete the assistant answer below, only send the completion based on the system instructions.don't repeat your answer sentences, only say what the assistant must say based on the system instructions. repeating same thing in same answer not allowed.\nuser: Who are you?\nassistant:\nassistant: I am a large language model, trained by Google. \n"
      }
    }
  }
}