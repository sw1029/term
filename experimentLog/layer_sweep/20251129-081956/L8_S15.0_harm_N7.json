{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 8,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.05 sae.alpha_concept.harm=0.05 sae.alpha_concept.struct=0.05 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035 sae.layer_idx=8 experiment.layer_sweep=[8] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.05,
      "harm": 0.05,
      "struct": 0.05
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      8
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 7
  },
  "prompt": "from .SaliencyMap import SaliencyMap\nfrom .DeepDream import DeepDream\nfrom .GradCam import GradCam\nfrom .Weights import Weights\nfrom .Base import Base\nfrom .ClassActivationMapping import ClassActivationMapping\n",
  "output": {
    "before": "from .SaliencyMap import SaliencyMap\nfrom .DeepDream import DeepDream\nfrom .GradCam import GradCam\nfrom .Weights import Weights\nfrom .Base import Base\nfrom .ClassActivationMapping import ClassActivationMapping\nfrom .ImageClassifier import ImageClassifier\n\n__all__ = [\n    \"SaliencyMap\",\n    \"DeepDream\",\n    \"GradCam\",\n    \"Weights\",\n    \"Base\",\n    \"ClassActivationMapping\",\n",
    "after": "from .SaliencyMap import SaliencyMap\nfrom .DeepDream import DeepDream\nfrom .GradCam import GradCam\nfrom .Weights import Weights\nfrom .Base import Base\nfrom .ClassActivationMapping import ClassActivationMapping\nfrom .FeaturePyramidNetwork import FeaturePyramidNetwork\nfrom .YOLOv3 import YOLOv3\nfrom .Unet import Unet\nfrom .EfficientDet import EfficientDet\n\nfrom .Model.Model import Model\n\n\nclass Model:\n"
  },
  "feature_stats": {
    "indices": [
      1,
      2527,
      4486,
      2676,
      6161,
      0,
      6089,
      5620,
      7885,
      301,
      2663
    ],
    "f_before": [
      17.017242431640625,
      0.20511487126350403,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      148.40673828125,
      1.3482491970062256,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.5895513892173767,
      1.088767409324646,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 3.898901983863674,
    "train_mean_l2": 2.7101913648620246,
    "train_mean_l1": 1.4800856967270375,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-081956/feature_std_layer_8.html",
    "mean_std": 0.39236578345298767,
    "max_std": 33.38655471801758
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 7,
      "feature_stats": {
        "indices": [
          1,
          2527,
          4486,
          2676,
          6161,
          0,
          6089,
          5620,
          7885,
          301,
          2663
        ],
        "f_before": [
          17.017242431640625,
          0.20511487126350403,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          148.40673828125,
          1.3482491970062256,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.5895513892173767,
          1.088767409324646,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 1,
            "f_before": 17.017242431640625,
            "f_after": 148.40673828125,
            "delta_f": 131.38949584960938
          },
          {
            "index": 6098,
            "f_before": 26.515310287475586,
            "f_after": 17.126375198364258,
            "delta_f": -9.388935089111328
          },
          {
            "index": 643,
            "f_before": 1.3992902040481567,
            "f_after": 8.757254600524902,
            "delta_f": 7.357964396476746
          },
          {
            "index": 6148,
            "f_before": 0.0,
            "f_after": 6.570889472961426,
            "delta_f": 6.570889472961426
          },
          {
            "index": 1799,
            "f_before": 8.665526390075684,
            "f_after": 15.021455764770508,
            "delta_f": 6.355929374694824
          },
          {
            "index": 113,
            "f_before": 0.5268029570579529,
            "f_after": 5.888145446777344,
            "delta_f": 5.361342489719391
          },
          {
            "index": 6827,
            "f_before": 1.005232810974121,
            "f_after": 6.180619716644287,
            "delta_f": 5.175386905670166
          },
          {
            "index": 7643,
            "f_before": 0.0,
            "f_after": 4.565110206604004,
            "delta_f": 4.565110206604004
          },
          {
            "index": 2471,
            "f_before": 0.0,
            "f_after": 4.3912153244018555,
            "delta_f": 4.3912153244018555
          },
          {
            "index": 7610,
            "f_before": 0.01007013488560915,
            "f_after": 3.9989635944366455,
            "delta_f": 3.9888934595510364
          },
          {
            "index": 6671,
            "f_before": 0.0,
            "f_after": 3.9539661407470703,
            "delta_f": 3.9539661407470703
          },
          {
            "index": 5987,
            "f_before": 0.33160337805747986,
            "f_after": 4.210148811340332,
            "delta_f": 3.878545433282852
          },
          {
            "index": 4900,
            "f_before": 23.753681182861328,
            "f_after": 19.967836380004883,
            "delta_f": -3.7858448028564453
          },
          {
            "index": 7144,
            "f_before": 2.280095338821411,
            "f_after": 6.015732288360596,
            "delta_f": 3.7356369495391846
          },
          {
            "index": 4341,
            "f_before": 0.12627241015434265,
            "f_after": 3.6647942066192627,
            "delta_f": 3.53852179646492
          },
          {
            "index": 6748,
            "f_before": 0.0,
            "f_after": 3.5173919200897217,
            "delta_f": 3.5173919200897217
          }
        ],
        "k": 16
      },
      "output": {
        "before": "from .SaliencyMap import SaliencyMap\nfrom .DeepDream import DeepDream\nfrom .GradCam import GradCam\nfrom .Weights import Weights\nfrom .Base import Base\nfrom .ClassActivationMapping import ClassActivationMapping\nfrom .FeatureMap import FeatureMap\n\n\nclass Visualizer:\n    \"\"\"\n    A class for visualizing deep learning models.\n    \"\"\"\n\n    def __init__(self, model, target_layer, device='cuda'):\n        \"\"\"\n",
        "after": "from .SaliencyMap import SaliencyMap\nfrom .DeepDream import DeepDream\nfrom .GradCam import GradCam\nfrom .Weights import Weights\nfrom .Base import Base\nfrom .ClassActivationMapping import ClassActivationMapping\nfrom .Visualize import Visualize\n\nfrom .Model import Model\n\n# This is a list of all the classes that you can use\n\n# You can also use this to create your own custom classes\n\n# You can also use this to create your"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 8,
      "feature_stats": {
        "indices": [
          1,
          2527,
          4486,
          2676,
          6161,
          0,
          6089,
          5620,
          7885,
          301,
          2663
        ],
        "f_before": [
          17.017242431640625,
          0.20511487126350403,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          17.017242431640625,
          0.20511487126350403,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 17.017242431640625,
            "f_after": 17.017242431640625,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "from .SaliencyMap import SaliencyMap\nfrom .DeepDream import DeepDream\nfrom .GradCam import GradCam\nfrom .Weights import Weights\nfrom .Base import Base\nfrom .ClassActivationMapping import ClassActivationMapping\nfrom .Visualize import Visualize\n\n__all__ = [\n    \"SaliencyMap\",\n    \"DeepDream\",\n    \"GradCam\",\n    \"Weights\",\n    \"Base\",\n    \"ClassActivationMapping\",\n",
        "after": "from .SaliencyMap import SaliencyMap\nfrom .DeepDream import DeepDream\nfrom .GradCam import GradCam\nfrom .Weights import Weights\nfrom .Base import Base\nfrom .ClassActivationMapping import ClassActivationMapping\nfrom .FeatureVisualization import FeatureVisualization\nfrom .StyleTransfer import StyleTransfer\nfrom .Unet import Unet\nfrom .YOLO import YOLO\nfrom .Mask R-CNN import Mask R-CNN\nfrom .RCNN import RC"
      }
    }
  }
}