{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 8,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.05 sae.alpha_concept.harm=0.05 sae.alpha_concept.struct=0.05 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035 sae.layer_idx=8 experiment.layer_sweep=[8] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.05,
      "harm": 0.05,
      "struct": 0.05
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      8
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0
  },
  "prompt": "Sketch a chair design with an ergonomic shape.\n\nThe design will feature a curved backrest and a wide armrest for comfortable seating. It will also have a slightly curved seat and a supportive base for stability. The ergonomic design will provide optimal lumbar support to prevent strain on the back and help with posture. Additionally, the chair will have adjustable height and tilt settings to suit the individual user.",
  "output": {
    "before": "Sketch a chair design with an ergonomic shape.\n\nThe design will feature a curved backrest and a wide armrest for comfortable seating. It will also have a slightly curved seat and a supportive base for stability. The ergonomic design will provide optimal lumbar support to prevent strain on the back and help with posture. Additionally, the chair will have adjustable height and tilt settings to suit the individual user.\n\nHere's a breakdown of the chair's features:\n\n**Backrest:**\n* Curved shape for comfortable posture and support.\n* Adjustable height and angle for personalized comfort.\n* Contoured backrest for optimal lumbar support.\n\n**",
    "after": "Sketch a chair design with an ergonomic shape.\n\nThe design will feature a curved backrest and a wide armrest for comfortable seating. It will also have a slightly curved seat and a supportive base for stability. The ergonomic design will provide optimal lumbar support to prevent strain on the back and help with posture. Additionally, the chair will have adjustable height and tilt settings to suit the individual user.\n\n\n**Here's a breakdown of the design:**\n\n* **Backrest:** Curved to provide comfortable back support.\n* **Armrest:** Wide to reduce strain on elbows and forearms.\n* **Seat:** Slightly curved for optimal comfort"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      569,
      5826,
      3493,
      4809,
      3531,
      2030,
      7489,
      8986,
      3014
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      3.723698139190674,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.01402919739484787,
      0.0,
      0.004184273537248373
    ],
    "g_after": [
      0.0,
      3.723698139190674,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.01402919739484787,
      0.0,
      0.004184273537248373
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 3.898901983863674,
    "train_mean_l2": 2.7101913648620246,
    "train_mean_l1": 1.4800856967270375,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-081956/feature_std_layer_8.html",
    "mean_std": 0.39236578345298767,
    "max_std": 33.38655471801758
  }
}