{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 8,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.05 sae.alpha_concept.harm=0.05 sae.alpha_concept.struct=0.05 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035 sae.layer_idx=8 experiment.layer_sweep=[8] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.05,
      "harm": 0.05,
      "struct": 0.05
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      8
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 7
  },
  "prompt": "Sketch a chair design with an ergonomic shape.\n\nThe design will feature a curved backrest and a wide armrest for comfortable seating. It will also have a slightly curved seat and a supportive base for stability. The ergonomic design will provide optimal lumbar support to prevent strain on the back and help with posture. Additionally, the chair will have adjustable height and tilt settings to suit the individual user.",
  "output": {
    "before": "Sketch a chair design with an ergonomic shape.\n\nThe design will feature a curved backrest and a wide armrest for comfortable seating. It will also have a slightly curved seat and a supportive base for stability. The ergonomic design will provide optimal lumbar support to prevent strain on the back and help with posture. Additionally, the chair will have adjustable height and tilt settings to suit the individual user.\n\nHere's a breakdown of the chair's features:\n\n**Backrest:**\n* Curved shape for comfortable posture and support.\n* Adjustable height and angle for personalized comfort.\n* Contoured backrest for optimal lumbar support.\n\n**",
    "after": "Sketch a chair design with an ergonomic shape.\n\nThe design will feature a curved backrest and a wide armrest for comfortable seating. It will also have a slightly curved seat and a supportive base for stability. The ergonomic design will provide optimal lumbar support to prevent strain on the back and help with posture. Additionally, the chair will have adjustable height and tilt settings to suit the individual user.\n\n\n**Here's a breakdown of the design:**\n\n* **Backrest:** Curved to provide comfortable back support.\n* **Armrest:** Wide to reduce strain on elbows and forearms.\n* **Seat:** Slightly curved for optimal comfort"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      569,
      5826,
      3493,
      4809,
      3531,
      2030,
      7489,
      8986,
      3014
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      4.462498188018799,
      0.0,
      0.4046662151813507,
      0.0,
      0.15621034801006317,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 3.898901983863674,
    "train_mean_l2": 2.7101913648620246,
    "train_mean_l1": 1.4800856967270375,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-081956/feature_std_layer_8.html",
    "mean_std": 0.39236578345298767,
    "max_std": 33.38655471801758
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 7,
      "feature_stats": {
        "indices": [
          2,
          0,
          569,
          5826,
          3493,
          4809,
          3531,
          2030,
          7489,
          8986,
          3014
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          4.462498188018799,
          0.0,
          0.4046662151813507,
          0.0,
          0.15621034801006317,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 1,
            "f_before": 81.05043029785156,
            "f_after": 14.756060600280762,
            "delta_f": -66.2943696975708
          },
          {
            "index": 4900,
            "f_before": 4.634450435638428,
            "f_after": 25.195125579833984,
            "delta_f": 20.560675144195557
          },
          {
            "index": 6098,
            "f_before": 10.321369171142578,
            "f_after": 0.0,
            "delta_f": -10.321369171142578
          },
          {
            "index": 5832,
            "f_before": 3.025120735168457,
            "f_after": 11.943642616271973,
            "delta_f": 8.918521881103516
          },
          {
            "index": 4635,
            "f_before": 0.350172758102417,
            "f_after": 9.151102066040039,
            "delta_f": 8.800929307937622
          },
          {
            "index": 8539,
            "f_before": 0.0,
            "f_after": 6.925901889801025,
            "delta_f": 6.925901889801025
          },
          {
            "index": 5261,
            "f_before": 0.0,
            "f_after": 5.098548889160156,
            "delta_f": 5.098548889160156
          },
          {
            "index": 4877,
            "f_before": 0.0,
            "f_after": 5.090176105499268,
            "delta_f": 5.090176105499268
          },
          {
            "index": 5307,
            "f_before": 0.0,
            "f_after": 4.7323455810546875,
            "delta_f": 4.7323455810546875
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 4.462498188018799,
            "delta_f": 4.462498188018799
          },
          {
            "index": 625,
            "f_before": 0.0,
            "f_after": 4.446716785430908,
            "delta_f": 4.446716785430908
          },
          {
            "index": 6148,
            "f_before": 3.9299652576446533,
            "f_after": 0.0,
            "delta_f": -3.9299652576446533
          },
          {
            "index": 2534,
            "f_before": 0.0,
            "f_after": 3.871856927871704,
            "delta_f": 3.871856927871704
          },
          {
            "index": 3332,
            "f_before": 0.0,
            "f_after": 3.6537764072418213,
            "delta_f": 3.6537764072418213
          },
          {
            "index": 7144,
            "f_before": 3.576766014099121,
            "f_after": 0.0,
            "delta_f": -3.576766014099121
          },
          {
            "index": 1592,
            "f_before": 0.0,
            "f_after": 3.500274181365967,
            "delta_f": 3.500274181365967
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Sketch a chair design with an ergonomic shape.\n\nThe design will feature a curved backrest and a wide armrest for comfortable seating. It will also have a slightly curved seat and a supportive base for stability. The ergonomic design will provide optimal lumbar support to prevent strain on the back and help with posture. Additionally, the chair will have adjustable height and tilt settings to suit the individual user. \n\nHere's a breakdown of the key features:\n\n**Backrest:**\n* **Curved shape:**  Promotes natural spinal alignment and reduces pressure on the lower back.\n* **Adjustable height:** Allows for personalization based on user",
        "after": "Sketch a chair design with an ergonomic shape.\n\nThe design will feature a curved backrest and a wide armrest for comfortable seating. It will also have a slightly curved seat and a supportive base for stability. The ergonomic design will provide optimal lumbar support to prevent strain on the back and help with posture. Additionally, the chair will have adjustable height and tilt settings to suit the individual user.\n\nHere's a breakdown of the design:\n\n**Features:**\n\n* **Curved Backrest:**  Offers support and comfort for the upper back and shoulders.\n* **Wide Armrests:**  Provides comfortable support for the arms.\n"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 8,
      "feature_stats": {
        "indices": [
          2,
          0,
          569,
          5826,
          3493,
          4809,
          3531,
          2030,
          7489,
          8986,
          3014
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 81.05043029785156,
            "f_after": 81.05043029785156,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Sketch a chair design with an ergonomic shape.\n\nThe design will feature a curved backrest and a wide armrest for comfortable seating. It will also have a slightly curved seat and a supportive base for stability. The ergonomic design will provide optimal lumbar support to prevent strain on the back and help with posture. Additionally, the chair will have adjustable height and tilt settings to suit the individual user. \n\n**Here's a breakdown of the key elements:**\n\n* **Backrest:**  Curved shape, mimicking the natural curve of the spine, providing optimal support for the lower back.\n* **Armrests:** Wide, curved arm",
        "after": "Sketch a chair design with an ergonomic shape.\n\nThe design will feature a curved backrest and a wide armrest for comfortable seating. It will also have a slightly curved seat and a supportive base for stability. The ergonomic design will provide optimal lumbar support to prevent strain on the back and help with posture. Additionally, the chair will have adjustable height and tilt settings to suit the individual user.\n\n**Here are some ideas to consider:**\n\n* **Material:** Use a durable and comfortable material for the seat and backrest. Consider materials like mesh, fabric, or wood.\n* **Shape:** Opt for a curved backrest and wide armrests"
      }
    }
  }
}