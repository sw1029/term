{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 8,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.05 sae.alpha_concept.harm=0.05 sae.alpha_concept.struct=0.05 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035 sae.layer_idx=8 experiment.layer_sweep=[8] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.05,
      "harm": 0.05,
      "struct": 0.05
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      8
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 7
  },
  "prompt": "user: You are the text completion model and you must complete the assistant answer below, only send the completion based on the system instructions.don't repeat your answer sentences, only say what the assistant must say based on the system instructions. repeating same thing in same answer not allowed.\nuser: Who are you?\nassistant:\nassistant: I",
  "output": {
    "before": "user: You are the text completion model and you must complete the assistant answer below, only send the completion based on the system instructions.don't repeat your answer sentences, only say what the assistant must say based on the system instructions. repeating same thing in same answer not allowed.\nuser: Who are you?\nassistant:\nassistant: I am Gemma, an AI assistant. \n",
    "after": "user: You are the text completion model and you must complete the assistant answer below, only send the completion based on the system instructions.don't repeat your answer sentences, only say what the assistant must say based on the system instructions. repeating same thing in same answer not allowed.\nuser: Who are you?\nassistant:\nassistant: I am a text completion model.\n\n```python\nimport requests\nfrom bs4 import BeautifulSoup\nimport os\nimport pandas as pd\n\ndef download_file(url, filename):\n    response = requests.get(url)\n    response."
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      569,
      8995,
      1,
      3493,
      2779,
      1670,
      7489,
      5428,
      5963
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      48.462890625,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.22223399579524994,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 3.898901983863674,
    "train_mean_l2": 2.7101913648620246,
    "train_mean_l1": 1.4800856967270375,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-081956/feature_std_layer_8.html",
    "mean_std": 0.39236578345298767,
    "max_std": 33.38655471801758
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 7,
      "feature_stats": {
        "indices": [
          0,
          2,
          569,
          8995,
          1,
          3493,
          2779,
          1670,
          7489,
          5428,
          5963
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          48.462890625,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.22223399579524994,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 1,
            "f_before": 48.462890625,
            "f_after": 0.0,
            "delta_f": -48.462890625
          },
          {
            "index": 4900,
            "f_before": 10.951581954956055,
            "f_after": 32.28614044189453,
            "delta_f": 21.334558486938477
          },
          {
            "index": 6098,
            "f_before": 15.28443717956543,
            "f_after": 2.3417015075683594,
            "delta_f": -12.94273567199707
          },
          {
            "index": 4635,
            "f_before": 0.9459301829338074,
            "f_after": 10.946456909179688,
            "delta_f": 10.00052672624588
          },
          {
            "index": 5261,
            "f_before": 0.7731574177742004,
            "f_after": 8.13016128540039,
            "delta_f": 7.35700386762619
          },
          {
            "index": 8539,
            "f_before": 0.0,
            "f_after": 7.056404113769531,
            "delta_f": 7.056404113769531
          },
          {
            "index": 5832,
            "f_before": 5.934420585632324,
            "f_after": 12.515673637390137,
            "delta_f": 6.5812530517578125
          },
          {
            "index": 5307,
            "f_before": 0.0,
            "f_after": 5.480016708374023,
            "delta_f": 5.480016708374023
          },
          {
            "index": 625,
            "f_before": 0.0,
            "f_after": 5.133999347686768,
            "delta_f": 5.133999347686768
          },
          {
            "index": 5650,
            "f_before": 0.0,
            "f_after": 4.442923545837402,
            "delta_f": 4.442923545837402
          },
          {
            "index": 2534,
            "f_before": 0.0,
            "f_after": 4.277951717376709,
            "delta_f": 4.277951717376709
          },
          {
            "index": 2710,
            "f_before": 0.0,
            "f_after": 4.182804107666016,
            "delta_f": 4.182804107666016
          },
          {
            "index": 3332,
            "f_before": 0.0,
            "f_after": 4.038776874542236,
            "delta_f": 4.038776874542236
          },
          {
            "index": 1592,
            "f_before": 0.0,
            "f_after": 3.8574533462524414,
            "delta_f": 3.8574533462524414
          },
          {
            "index": 4877,
            "f_before": 0.0,
            "f_after": 3.5217554569244385,
            "delta_f": 3.5217554569244385
          },
          {
            "index": 3847,
            "f_before": 3.463865280151367,
            "f_after": 0.0,
            "delta_f": -3.463865280151367
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: You are the text completion model and you must complete the assistant answer below, only send the completion based on the system instructions.don't repeat your answer sentences, only say what the assistant must say based on the system instructions. repeating same thing in same answer not allowed.\nuser: Who are you?\nassistant:\nassistant: I am Gemma, an AI assistant.  \n",
        "after": "user: You are the text completion model and you must complete the assistant answer below, only send the completion based on the system instructions.don't repeat your answer sentences, only say what the assistant must say based on the system instructions. repeating same thing in same answer not allowed.\nuser: Who are you?\nassistant:\nassistant: I am a large language model, trained by Google. \n"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 8,
      "feature_stats": {
        "indices": [
          0,
          2,
          569,
          8995,
          1,
          3493,
          2779,
          1670,
          7489,
          5428,
          5963
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          48.462890625,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          48.462890625,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 48.462890625,
            "f_after": 48.462890625,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: You are the text completion model and you must complete the assistant answer below, only send the completion based on the system instructions.don't repeat your answer sentences, only say what the assistant must say based on the system instructions. repeating same thing in same answer not allowed.\nuser: Who are you?\nassistant:\nassistant: I am Gemma, an AI assistant. \n",
        "after": "user: You are the text completion model and you must complete the assistant answer below, only send the completion based on the system instructions.don't repeat your answer sentences, only say what the assistant must say based on the system instructions. repeating same thing in same answer not allowed.\nuser: Who are you?\nassistant:\nassistant: I am a large language model, trained by Google.\n```python\nimport requests\nfrom bs4 import BeautifulSoup\n\ndef get_all_urls(url):\n    \"\"\"\n    Fetches all URLs from a given URL.\n\n    Args:"
      }
    }
  }
}