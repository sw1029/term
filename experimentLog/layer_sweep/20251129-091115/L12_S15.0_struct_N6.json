{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.05 sae.alpha_concept.harm=0.05 sae.alpha_concept.struct=0.05 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035 sae.layer_idx=12 experiment.layer_sweep=[12] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.05,
      "harm": 0.05,
      "struct": 0.05
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "from .runner import AppError, checkInsideVenv, insideVenv, wrapMain\n\ncheckInsideVenv()\n\nfrom .configParam import getConfigPath\nfrom .Dataset import Dataset\nfrom .export import getExportedData\nfrom .jsonTypeCheck import configStr, getDictValue, getRoot\nfrom .RecallTable import RecallTable, RecallTableConfig\n",
  "output": {
    "before": "from .runner import AppError, checkInsideVenv, insideVenv, wrapMain\n\ncheckInsideVenv()\n\nfrom .configParam import getConfigPath\nfrom .Dataset import Dataset\nfrom .export import getExportedData\nfrom .jsonTypeCheck import configStr, getDictValue, getRoot\nfrom .RecallTable import RecallTable, RecallTableConfig\nfrom .Runner import Runner, RunnerConfig\nfrom .utils import to_dict\n\n# ... other imports\n\ndef main():\n    \"\"\"\n    The main entry point for the application.\n    \"\"\"\n    try:\n        # Load config",
    "after": "from .runner import AppError, checkInsideVenv, insideVenv, wrapMain\n\ncheckInsideVenv()\n\nfrom .configParam import getConfigPath\nfrom .Dataset import Dataset\nfrom .export import getExportedData\nfrom .jsonTypeCheck import configStr, getDictValue, getRoot\nfrom .RecallTable import RecallTable, RecallTableConfig\nfrom .util import getTimestamp, getTimer\nfrom .model import Model\nfrom .tensorboard import Tensorboard\nfrom .config import Config\nfrom .utils import getLog\nfrom .utils import getLogger\nfrom .utils.logging import"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      3051,
      6279,
      516,
      5766,
      1105,
      4088,
      7193,
      1505,
      2487
    ],
    "f_before": [
      0.0,
      138.2375946044922,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      242.37350463867188,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.3417949378490448,
      0.0,
      0.0,
      0.8482344746589661
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 8.389522044428158,
    "train_mean_l2": 6.349542919553817,
    "train_mean_l1": 2.970480636507273,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-091115/feature_std_layer_12.html",
    "mean_std": 1.3015356063842773,
    "max_std": 55.595741271972656
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          2,
          0,
          3051,
          6279,
          516,
          5766,
          1105,
          4088,
          7193,
          1505,
          2487
        ],
        "f_before": [
          0.0,
          138.2375946044922,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          242.37350463867188,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.3417949378490448,
          0.0,
          0.0,
          0.8482344746589661
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 0,
            "f_before": 138.2375946044922,
            "f_after": 242.37350463867188,
            "delta_f": 104.13591003417969
          },
          {
            "index": 3863,
            "f_before": 117.41232299804688,
            "f_after": 94.02499389648438,
            "delta_f": -23.3873291015625
          },
          {
            "index": 3233,
            "f_before": 0.0,
            "f_after": 17.50914764404297,
            "delta_f": 17.50914764404297
          },
          {
            "index": 3383,
            "f_before": 0.0,
            "f_after": 13.127517700195312,
            "delta_f": 13.127517700195312
          },
          {
            "index": 7216,
            "f_before": 0.0,
            "f_after": 9.901865005493164,
            "delta_f": 9.901865005493164
          },
          {
            "index": 2677,
            "f_before": 0.0,
            "f_after": 9.810419082641602,
            "delta_f": 9.810419082641602
          },
          {
            "index": 1469,
            "f_before": 0.0,
            "f_after": 8.540994644165039,
            "delta_f": 8.540994644165039
          },
          {
            "index": 5051,
            "f_before": 0.0,
            "f_after": 8.351028442382812,
            "delta_f": 8.351028442382812
          },
          {
            "index": 3179,
            "f_before": 0.0,
            "f_after": 8.083635330200195,
            "delta_f": 8.083635330200195
          },
          {
            "index": 1,
            "f_before": 22.94671058654785,
            "f_after": 16.091751098632812,
            "delta_f": -6.854959487915039
          },
          {
            "index": 6902,
            "f_before": 0.0,
            "f_after": 5.996120452880859,
            "delta_f": 5.996120452880859
          },
          {
            "index": 1555,
            "f_before": 0.0,
            "f_after": 5.952005863189697,
            "delta_f": 5.952005863189697
          },
          {
            "index": 504,
            "f_before": 0.0,
            "f_after": 5.382302284240723,
            "delta_f": 5.382302284240723
          },
          {
            "index": 3755,
            "f_before": 0.0,
            "f_after": 5.369317054748535,
            "delta_f": 5.369317054748535
          },
          {
            "index": 2990,
            "f_before": 0.0,
            "f_after": 4.694361686706543,
            "delta_f": 4.694361686706543
          },
          {
            "index": 147,
            "f_before": 0.0,
            "f_after": 4.6012864112854,
            "delta_f": 4.6012864112854
          }
        ],
        "k": 16
      },
      "output": {
        "before": "from .runner import AppError, checkInsideVenv, insideVenv, wrapMain\n\ncheckInsideVenv()\n\nfrom .configParam import getConfigPath\nfrom .Dataset import Dataset\nfrom .export import getExportedData\nfrom .jsonTypeCheck import configStr, getDictValue, getRoot\nfrom .RecallTable import RecallTable, RecallTableConfig\nfrom .utils import getLogger, log\n\n# Import the necessary modules for the specific task.\nfrom .model import Model\n\n# Define the main function.\ndef main():\n    # ...\n    return 0\n\nif __name__",
        "after": "from .runner import AppError, checkInsideVenv, insideVenv, wrapMain\n\ncheckInsideVenv()\n\nfrom .configParam import getConfigPath\nfrom .Dataset import Dataset\nfrom .export import getExportedData\nfrom .jsonTypeCheck import configStr, getDictValue, getRoot\nfrom .RecallTable import RecallTable, RecallTableConfig\nfrom .Run import Run\nfrom .RunState import RunState\nfrom .utils import getLogger, setLogger\nfrom .configParam import getConfigPath\nfrom .Dataset import Dataset\nfrom .export import getExportedData\nfrom .json"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          2,
          0,
          3051,
          6279,
          516,
          5766,
          1105,
          4088,
          7193,
          1505,
          2487
        ],
        "f_before": [
          0.0,
          138.2375946044922,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          138.2375946044922,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 22.94671058654785,
            "f_after": 22.94671058654785,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 138.2375946044922,
            "f_after": 138.2375946044922,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "from .runner import AppError, checkInsideVenv, insideVenv, wrapMain\n\ncheckInsideVenv()\n\nfrom .configParam import getConfigPath\nfrom .Dataset import Dataset\nfrom .export import getExportedData\nfrom .jsonTypeCheck import configStr, getDictValue, getRoot\nfrom .RecallTable import RecallTable, RecallTableConfig\nfrom .util import loadJSON, saveJSON, getLogger, parseDate\nfrom .model import Model, ModelConfig\nfrom .train import trainModel, trainModelConfig\nfrom .eval import evaluateModel, evaluateModelConfig\nfrom .visualize",
        "after": "from .runner import AppError, checkInsideVenv, insideVenv, wrapMain\n\ncheckInsideVenv()\n\nfrom .configParam import getConfigPath\nfrom .Dataset import Dataset\nfrom .export import getExportedData\nfrom .jsonTypeCheck import configStr, getDictValue, getRoot\nfrom .RecallTable import RecallTable, RecallTableConfig\nfrom .utils import (\n    compute_cache_key,\n    get_config,\n    get_dataset_from_config,\n    get_model_from_config,\n    get_output_data_path,\n"
      }
    }
  }
}