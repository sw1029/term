{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.05 sae.alpha_concept.harm=0.05 sae.alpha_concept.struct=0.05 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035 sae.layer_idx=12 experiment.layer_sweep=[12] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.05,
      "harm": 0.05,
      "struct": 0.05
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "from .runner import AppError, checkInsideVenv, insideVenv, wrapMain\n\ncheckInsideVenv()\n\nfrom .configParam import getConfigPath\nfrom .Dataset import Dataset\nfrom .export import getExportedData\nfrom .jsonTypeCheck import configStr, getDictValue, getRoot\nfrom .RecallTable import RecallTable, RecallTableConfig\n",
  "output": {
    "before": "from .runner import AppError, checkInsideVenv, insideVenv, wrapMain\n\ncheckInsideVenv()\n\nfrom .configParam import getConfigPath\nfrom .Dataset import Dataset\nfrom .export import getExportedData\nfrom .jsonTypeCheck import configStr, getDictValue, getRoot\nfrom .RecallTable import RecallTable, RecallTableConfig\nfrom .utils import getTimestamp, getLogger\n\n# --- Main Function ---\n\n@wrapMain\ndef main():\n    \"\"\"\n    Main function to run the application.\n    \"\"\"\n    logger = getLogger()\n    \n    #",
    "after": "from .runner import AppError, checkInsideVenv, insideVenv, wrapMain\n\ncheckInsideVenv()\n\nfrom .configParam import getConfigPath\nfrom .Dataset import Dataset\nfrom .export import getExportedData\nfrom .jsonTypeCheck import configStr, getDictValue, getRoot\nfrom .RecallTable import RecallTable, RecallTableConfig\nfrom .utils import *\nfrom .model import Model\nfrom .optimizer import Optimizer\nfrom .utils import *\nfrom .runner import *\nfrom .utils import *\n\n# Import for compatibility\nfrom .utils.compat import *\n\n#"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      1505,
      6279,
      2487,
      3051,
      9042,
      1406,
      7193,
      4858,
      8250
    ],
    "f_before": [
      138.2375946044922,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      263.438720703125,
      0.0,
      0.0,
      0.0,
      0.36536943912506104,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 8.389522044428158,
    "train_mean_l2": 6.349542919553817,
    "train_mean_l1": 2.970480636507273,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-091115/feature_std_layer_12.html",
    "mean_std": 1.3015356063842773,
    "max_std": 55.595741271972656
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          0,
          2,
          1505,
          6279,
          2487,
          3051,
          9042,
          1406,
          7193,
          4858,
          8250
        ],
        "f_before": [
          138.2375946044922,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          263.438720703125,
          0.0,
          0.0,
          0.0,
          0.36536943912506104,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 0,
            "f_before": 138.2375946044922,
            "f_after": 263.438720703125,
            "delta_f": 125.20112609863281
          },
          {
            "index": 5177,
            "f_before": 103.21024322509766,
            "f_after": 121.38214111328125,
            "delta_f": 18.171897888183594
          },
          {
            "index": 3863,
            "f_before": 117.41232299804688,
            "f_after": 101.43537139892578,
            "delta_f": -15.976951599121094
          },
          {
            "index": 3233,
            "f_before": 0.0,
            "f_after": 13.905959129333496,
            "delta_f": 13.905959129333496
          },
          {
            "index": 7216,
            "f_before": 0.0,
            "f_after": 11.040923118591309,
            "delta_f": 11.040923118591309
          },
          {
            "index": 2677,
            "f_before": 0.0,
            "f_after": 9.981066703796387,
            "delta_f": 9.981066703796387
          },
          {
            "index": 1469,
            "f_before": 0.0,
            "f_after": 9.184106826782227,
            "delta_f": 9.184106826782227
          },
          {
            "index": 3383,
            "f_before": 0.0,
            "f_after": 8.87801742553711,
            "delta_f": 8.87801742553711
          },
          {
            "index": 3179,
            "f_before": 0.0,
            "f_after": 8.413597106933594,
            "delta_f": 8.413597106933594
          },
          {
            "index": 6902,
            "f_before": 0.0,
            "f_after": 6.583704471588135,
            "delta_f": 6.583704471588135
          },
          {
            "index": 5051,
            "f_before": 0.0,
            "f_after": 6.255046367645264,
            "delta_f": 6.255046367645264
          },
          {
            "index": 1,
            "f_before": 22.94671058654785,
            "f_after": 16.698528289794922,
            "delta_f": -6.24818229675293
          },
          {
            "index": 1555,
            "f_before": 0.0,
            "f_after": 6.2282514572143555,
            "delta_f": 6.2282514572143555
          },
          {
            "index": 3755,
            "f_before": 0.0,
            "f_after": 6.087917804718018,
            "delta_f": 6.087917804718018
          },
          {
            "index": 8930,
            "f_before": 0.0,
            "f_after": 5.484960079193115,
            "delta_f": 5.484960079193115
          },
          {
            "index": 368,
            "f_before": 0.0,
            "f_after": 5.104181289672852,
            "delta_f": 5.104181289672852
          }
        ],
        "k": 16
      },
      "output": {
        "before": "from .runner import AppError, checkInsideVenv, insideVenv, wrapMain\n\ncheckInsideVenv()\n\nfrom .configParam import getConfigPath\nfrom .Dataset import Dataset\nfrom .export import getExportedData\nfrom .jsonTypeCheck import configStr, getDictValue, getRoot\nfrom .RecallTable import RecallTable, RecallTableConfig\nfrom .utils import get_time_stamp, get_time_str\n\nwrapMain(\n    __name__,\n    \"main\",\n    \"Main function for running the script\",\n    None,\n    None,\n    None",
        "after": "from .runner import AppError, checkInsideVenv, insideVenv, wrapMain\n\ncheckInsideVenv()\n\nfrom .configParam import getConfigPath\nfrom .Dataset import Dataset\nfrom .export import getExportedData\nfrom .jsonTypeCheck import configStr, getDictValue, getRoot\nfrom .RecallTable import RecallTable, RecallTableConfig\nfrom .model import Model\nfrom .utils import get_default_args\nfrom .utils import get_model_name\nfrom .utils import get_version\nfrom .utils import get_config_from_path\nfrom .utils import"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          0,
          2,
          1505,
          6279,
          2487,
          3051,
          9042,
          1406,
          7193,
          4858,
          8250
        ],
        "f_before": [
          138.2375946044922,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          138.2375946044922,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 22.94671058654785,
            "f_after": 22.94671058654785,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 138.2375946044922,
            "f_after": 138.2375946044922,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "from .runner import AppError, checkInsideVenv, insideVenv, wrapMain\n\ncheckInsideVenv()\n\nfrom .configParam import getConfigPath\nfrom .Dataset import Dataset\nfrom .export import getExportedData\nfrom .jsonTypeCheck import configStr, getDictValue, getRoot\nfrom .RecallTable import RecallTable, RecallTableConfig\nfrom .run import run\nfrom .utils import getLogger, logMessage, logWarning, logError\n\n# Main entry point\n@wrapMain\ndef main():\n    # Load configuration from config file\n    config = getConfigPath()\n",
        "after": "from .runner import AppError, checkInsideVenv, insideVenv, wrapMain\n\ncheckInsideVenv()\n\nfrom .configParam import getConfigPath\nfrom .Dataset import Dataset\nfrom .export import getExportedData\nfrom .jsonTypeCheck import configStr, getDictValue, getRoot\nfrom .RecallTable import RecallTable, RecallTableConfig\nfrom .utils import *\nfrom .data import *\nfrom .data import *\nfrom .utils import *\nfrom . import *\n\nfrom .utils import *\nfrom .data import *\nfrom .utils import *\nfrom .data"
      }
    }
  }
}