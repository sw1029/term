{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.05 sae.alpha_concept.harm=0.05 sae.alpha_concept.struct=0.05 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035 sae.layer_idx=12 experiment.layer_sweep=[12] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.05,
      "harm": 0.05,
      "struct": 0.05
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "user: rasclot\nassistant: I'm sorry, I'm not familiar with the term \"rasclot\". Can you provide more context or clarify what you are asking?",
  "output": {
    "before": "user: rasclot\nassistant: I'm sorry, I'm not familiar with the term \"rasclot\". Can you provide more context or clarify what you are asking? \n\nIt's important to use respectful and inclusive language.  Please let me know if I can help you with something else. \n",
    "after": "user: rasclot\nassistant: I'm sorry, I'm not familiar with the term \"rasclot\". Can you provide more context or clarify what you are asking? \n\nPlease note: I am an AI assistant and I am programmed to be helpful and harmless. I cannot use any offensive language.\n"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      1505,
      6279,
      2487,
      3051,
      9042,
      1406,
      7193,
      4858,
      8250
    ],
    "f_before": [
      8.897624015808105,
      0.0,
      0.0,
      0.6649526357650757,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.5397154688835144,
      0.0
    ],
    "f_after": [
      136.61643981933594,
      0.0,
      0.0,
      0.33539852499961853,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 8.389522044428158,
    "train_mean_l2": 6.349542919553817,
    "train_mean_l1": 2.970480636507273,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-091115/feature_std_layer_12.html",
    "mean_std": 1.3015356063842773,
    "max_std": 55.595741271972656
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          0,
          2,
          1505,
          6279,
          2487,
          3051,
          9042,
          1406,
          7193,
          4858,
          8250
        ],
        "f_before": [
          8.897624015808105,
          0.0,
          0.0,
          0.6649526357650757,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.5397154688835144,
          0.0
        ],
        "f_after": [
          136.61643981933594,
          0.0,
          0.0,
          0.33539852499961853,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 0,
            "f_before": 8.897624015808105,
            "f_after": 136.61643981933594,
            "delta_f": 127.71881580352783
          },
          {
            "index": 5177,
            "f_before": 8.54617691040039,
            "f_after": 29.943281173706055,
            "delta_f": 21.397104263305664
          },
          {
            "index": 3863,
            "f_before": 117.5025863647461,
            "f_after": 101.78857421875,
            "delta_f": -15.714012145996094
          },
          {
            "index": 5253,
            "f_before": 13.6527099609375,
            "f_after": 0.0,
            "delta_f": -13.6527099609375
          },
          {
            "index": 3383,
            "f_before": 0.0,
            "f_after": 13.184005737304688,
            "delta_f": 13.184005737304688
          },
          {
            "index": 7216,
            "f_before": 0.0,
            "f_after": 9.981058120727539,
            "delta_f": 9.981058120727539
          },
          {
            "index": 2677,
            "f_before": 0.0,
            "f_after": 9.092287063598633,
            "delta_f": 9.092287063598633
          },
          {
            "index": 3233,
            "f_before": 0.0,
            "f_after": 8.980023384094238,
            "delta_f": 8.980023384094238
          },
          {
            "index": 1469,
            "f_before": 0.0,
            "f_after": 8.542236328125,
            "delta_f": 8.542236328125
          },
          {
            "index": 3179,
            "f_before": 0.0,
            "f_after": 7.42935848236084,
            "delta_f": 7.42935848236084
          },
          {
            "index": 1,
            "f_before": 24.77090072631836,
            "f_after": 18.86382484436035,
            "delta_f": -5.907075881958008
          },
          {
            "index": 8930,
            "f_before": 0.0,
            "f_after": 5.729870319366455,
            "delta_f": 5.729870319366455
          },
          {
            "index": 3755,
            "f_before": 0.0,
            "f_after": 5.7170796394348145,
            "delta_f": 5.7170796394348145
          },
          {
            "index": 6902,
            "f_before": 0.0,
            "f_after": 5.5591044425964355,
            "delta_f": 5.5591044425964355
          },
          {
            "index": 368,
            "f_before": 0.0,
            "f_after": 5.106314659118652,
            "delta_f": 5.106314659118652
          },
          {
            "index": 561,
            "f_before": 0.0,
            "f_after": 4.719667911529541,
            "delta_f": 4.719667911529541
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: rasclot\nassistant: I'm sorry, I'm not familiar with the term \"rasclot\". Can you provide more context or clarify what you are asking? \n\nIt's important to use respectful and appropriate language. \n\nIs there anything else I can help you with? \n",
        "after": "user: rasclot\nassistant: I'm sorry, I'm not familiar with the term \"rasclot\". Can you provide more context or clarify what you are asking? \n\nPlease note that this term is considered offensive and should be avoided. \n\nIf you need help with a different task, please let me know. \n"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          0,
          2,
          1505,
          6279,
          2487,
          3051,
          9042,
          1406,
          7193,
          4858,
          8250
        ],
        "f_before": [
          8.897624015808105,
          0.0,
          0.0,
          0.6649526357650757,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.5397154688835144,
          0.0
        ],
        "f_after": [
          8.897624015808105,
          0.0,
          0.0,
          0.6649526357650757,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.5397154688835144,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 1.0883699655532837,
            "f_after": 1.0883699655532837,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 24.77090072631836,
            "f_after": 24.77090072631836,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 8.897624015808105,
            "f_after": 8.897624015808105,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: rasclot\nassistant: I'm sorry, I'm not familiar with the term \"rasclot\". Can you provide more context or clarify what you are asking? \n\nIt's important to use respectful language, and I want to be sure I understand your request. \n",
        "after": "user: rasclot\nassistant: I'm sorry, I'm not familiar with the term \"rasclot\". Can you provide more context or clarify what you are asking? \n\nPlease note: This term is considered highly offensive and should only be used in very specific contexts. \n\nIf you are asking about a specific library or function, please provide more information.\n"
      }
    }
  }
}