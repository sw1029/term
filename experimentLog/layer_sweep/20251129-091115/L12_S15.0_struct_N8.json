{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.05 sae.alpha_concept.harm=0.05 sae.alpha_concept.struct=0.05 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035 sae.layer_idx=12 experiment.layer_sweep=[12] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.05,
      "harm": 0.05,
      "struct": 0.05
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "user: rasclot\nassistant: I'm sorry, I'm not familiar with the term \"rasclot\". Can you provide more context or clarify what you are asking?",
  "output": {
    "before": "user: rasclot\nassistant: I'm sorry, I'm not familiar with the term \"rasclot\". Can you provide more context or clarify what you are asking? \n\nIt's important to use respectful language when communicating, and I want to make sure I understand your request correctly. \n",
    "after": "user: rasclot\nassistant: I'm sorry, I'm not familiar with the term \"rasclot\". Can you provide more context or clarify what you are asking? \n\nIt is important to note that the term you are using is considered offensive and inappropriate. \n\nPlease consider using a more respectful and appropriate term. \n"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      3051,
      6279,
      516,
      5766,
      1105,
      4088,
      7193,
      1505,
      2487
    ],
    "f_before": [
      0.0,
      8.897624015808105,
      0.0,
      0.6649526357650757,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      115.5117416381836,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 8.389522044428158,
    "train_mean_l2": 6.349542919553817,
    "train_mean_l1": 2.970480636507273,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-091115/feature_std_layer_12.html",
    "mean_std": 1.3015356063842773,
    "max_std": 55.595741271972656
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          2,
          0,
          3051,
          6279,
          516,
          5766,
          1105,
          4088,
          7193,
          1505,
          2487
        ],
        "f_before": [
          0.0,
          8.897624015808105,
          0.0,
          0.6649526357650757,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          115.5117416381836,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 0,
            "f_before": 8.897624015808105,
            "f_after": 115.5117416381836,
            "delta_f": 106.61411762237549
          },
          {
            "index": 3863,
            "f_before": 117.5025863647461,
            "f_after": 94.35872650146484,
            "delta_f": -23.14385986328125
          },
          {
            "index": 3383,
            "f_before": 0.0,
            "f_after": 17.44552993774414,
            "delta_f": 17.44552993774414
          },
          {
            "index": 5253,
            "f_before": 13.6527099609375,
            "f_after": 0.03947315365076065,
            "delta_f": -13.61323680728674
          },
          {
            "index": 3233,
            "f_before": 0.0,
            "f_after": 12.593608856201172,
            "delta_f": 12.593608856201172
          },
          {
            "index": 2677,
            "f_before": 0.0,
            "f_after": 8.92271900177002,
            "delta_f": 8.92271900177002
          },
          {
            "index": 7216,
            "f_before": 0.0,
            "f_after": 8.84078598022461,
            "delta_f": 8.84078598022461
          },
          {
            "index": 1469,
            "f_before": 0.0,
            "f_after": 7.898963451385498,
            "delta_f": 7.898963451385498
          },
          {
            "index": 3179,
            "f_before": 0.0,
            "f_after": 7.099853038787842,
            "delta_f": 7.099853038787842
          },
          {
            "index": 1,
            "f_before": 24.77090072631836,
            "f_after": 18.25507926940918,
            "delta_f": -6.51582145690918
          },
          {
            "index": 5051,
            "f_before": 0.0,
            "f_after": 6.509200572967529,
            "delta_f": 6.509200572967529
          },
          {
            "index": 3755,
            "f_before": 0.0,
            "f_after": 4.997740268707275,
            "delta_f": 4.997740268707275
          },
          {
            "index": 6902,
            "f_before": 0.0,
            "f_after": 4.971272945404053,
            "delta_f": 4.971272945404053
          },
          {
            "index": 8930,
            "f_before": 0.0,
            "f_after": 4.831947326660156,
            "delta_f": 4.831947326660156
          },
          {
            "index": 1555,
            "f_before": 0.0,
            "f_after": 4.14366340637207,
            "delta_f": 4.14366340637207
          },
          {
            "index": 561,
            "f_before": 0.0,
            "f_after": 4.138694763183594,
            "delta_f": 4.138694763183594
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: rasclot\nassistant: I'm sorry, I'm not familiar with the term \"rasclot\". Can you provide more context or clarify what you are asking? \n\nIt is important to use respectful and appropriate language. \n\nPlease let me know if you have any other questions or need further assistance. \n",
        "after": "user: rasclot\nassistant: I'm sorry, I'm not familiar with the term \"rasclot\". Can you provide more context or clarify what you are asking? \n\n\nIt's important to remember that:\n* Using offensive language can be harmful.\n* Be mindful of the language you use.\n\n\nPlease provide more information about your request.\n"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          2,
          0,
          3051,
          6279,
          516,
          5766,
          1105,
          4088,
          7193,
          1505,
          2487
        ],
        "f_before": [
          0.0,
          8.897624015808105,
          0.0,
          0.6649526357650757,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          8.897624015808105,
          0.0,
          0.6649526357650757,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 1.0883699655532837,
            "f_after": 1.0883699655532837,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 24.77090072631836,
            "f_after": 24.77090072631836,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 8.897624015808105,
            "f_after": 8.897624015808105,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: rasclot\nassistant: I'm sorry, I'm not familiar with the term \"rasclot\". Can you provide more context or clarify what you are asking? \n\nIt's important to use respectful language and avoid offensive terms. \n\nIf you are asking about something else, please let me know and I'll do my best to help! \n",
        "after": "user: rasclot\nassistant: I'm sorry, I'm not familiar with the term \"rasclot\". Can you provide more context or clarify what you are asking?\n\nPlease note: This term is offensive and should not be used. \n"
      }
    }
  }
}