{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.05 sae.alpha_concept.harm=0.05 sae.alpha_concept.struct=0.05 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035 sae.layer_idx=12 experiment.layer_sweep=[12] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.05,
      "harm": 0.05,
      "struct": 0.05
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "user: rasclot\nassistant: I'm sorry, I'm not familiar with the term \"rasclot\". Can you provide more context or clarify what you are asking?",
  "output": {
    "before": "user: rasclot\nassistant: I'm sorry, I'm not familiar with the term \"rasclot\". Can you provide more context or clarify what you are asking? \n\nIt's important to use respectful language.  \n\nCould you please rephrase your request? \n",
    "after": "user: rasclot\nassistant: I'm sorry, I'm not familiar with the term \"rasclot\". Can you provide more context or clarify what you are asking? \n\nIt's important to remember that using derogatory language is harmful and disrespectful. It's not okay to make fun of people based on their appearance or make offensive remarks. \n\nIf you're looking for a harmless conversation, maybe we"
  },
  "feature_stats": {
    "indices": [
      1,
      645,
      9193,
      2184,
      2091,
      15,
      2614,
      5786,
      8703,
      9043,
      7019
    ],
    "f_before": [
      24.77090072631836,
      0.0,
      0.0,
      0.0,
      0.0,
      1.0883699655532837,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      29.86336326599121,
      0.0,
      0.0,
      0.0,
      0.8747310638427734,
      3.446401596069336,
      0.0,
      1.8026514053344727,
      0.0,
      1.8472638130187988,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 8.389522044428158,
    "train_mean_l2": 6.349542919553817,
    "train_mean_l1": 2.970480636507273,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-091115/feature_std_layer_12.html",
    "mean_std": 1.3015356063842773,
    "max_std": 55.595741271972656
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          1,
          645,
          9193,
          2184,
          2091,
          15,
          2614,
          5786,
          8703,
          9043,
          7019
        ],
        "f_before": [
          24.77090072631836,
          0.0,
          0.0,
          0.0,
          0.0,
          1.0883699655532837,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          29.86336326599121,
          0.0,
          0.0,
          0.0,
          0.8747310638427734,
          3.446401596069336,
          0.0,
          1.8026514053344727,
          0.0,
          1.8472638130187988,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 3863,
            "f_before": 117.5025863647461,
            "f_after": 180.77371215820312,
            "delta_f": 63.27112579345703
          },
          {
            "index": 5253,
            "f_before": 13.6527099609375,
            "f_after": 23.379531860351562,
            "delta_f": 9.726821899414062
          },
          {
            "index": 0,
            "f_before": 8.897624015808105,
            "f_after": 0.0,
            "delta_f": -8.897624015808105
          },
          {
            "index": 5177,
            "f_before": 8.54617691040039,
            "f_after": 0.0,
            "delta_f": -8.54617691040039
          },
          {
            "index": 1,
            "f_before": 24.77090072631836,
            "f_after": 29.86336326599121,
            "delta_f": 5.092462539672852
          },
          {
            "index": 6764,
            "f_before": 0.0,
            "f_after": 4.400135040283203,
            "delta_f": 4.400135040283203
          },
          {
            "index": 5009,
            "f_before": 0.09850817173719406,
            "f_after": 4.193495273590088,
            "delta_f": 4.094987101852894
          },
          {
            "index": 3357,
            "f_before": 0.0,
            "f_after": 3.9277122020721436,
            "delta_f": 3.9277122020721436
          },
          {
            "index": 4276,
            "f_before": 0.12546297907829285,
            "f_after": 3.8706586360931396,
            "delta_f": 3.745195657014847
          },
          {
            "index": 3668,
            "f_before": 0.17838598787784576,
            "f_after": 3.8558878898620605,
            "delta_f": 3.677501901984215
          },
          {
            "index": 3212,
            "f_before": 0.0,
            "f_after": 3.5837385654449463,
            "delta_f": 3.5837385654449463
          },
          {
            "index": 1714,
            "f_before": 0.08582816272974014,
            "f_after": 3.643509864807129,
            "delta_f": 3.5576817020773888
          },
          {
            "index": 2238,
            "f_before": 0.33220240473747253,
            "f_after": 3.881692886352539,
            "delta_f": 3.5494904816150665
          },
          {
            "index": 8784,
            "f_before": 0.08987130224704742,
            "f_after": 3.6138908863067627,
            "delta_f": 3.5240195840597153
          },
          {
            "index": 4558,
            "f_before": 0.0,
            "f_after": 3.5099403858184814,
            "delta_f": 3.5099403858184814
          },
          {
            "index": 4281,
            "f_before": 0.22390826046466827,
            "f_after": 3.7156615257263184,
            "delta_f": 3.49175326526165
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: rasclot\nassistant: I'm sorry, I'm not familiar with the term \"rasclot\". Can you provide more context or clarify what you are asking? \n\nIt's important to use respectful language, and I want to make sure I understand your request. \n\nPlease let me know if you have any other questions. \n",
        "after": "user: rasclot\nassistant: I'm sorry, I'm not familiar with the term \"rasclot\". Can you provide more context or clarify what you are asking? \n\nIt is important to use respectful language, and I want to be sure that my responses are helpful and harmless. \n\nLet's try a different topic! \n"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          1,
          645,
          9193,
          2184,
          2091,
          15,
          2614,
          5786,
          8703,
          9043,
          7019
        ],
        "f_before": [
          24.77090072631836,
          0.0,
          0.0,
          0.0,
          0.0,
          1.0883699655532837,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          24.77090072631836,
          0.0,
          0.0,
          0.0,
          0.0,
          1.0883699655532837,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 1.0883699655532837,
            "f_after": 1.0883699655532837,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 24.77090072631836,
            "f_after": 24.77090072631836,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 8.897624015808105,
            "f_after": 8.897624015808105,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: rasclot\nassistant: I'm sorry, I'm not familiar with the term \"rasclot\". Can you provide more context or clarify what you are asking? \n\nIt's important to remember that using offensive language is harmful and disrespectful. \n\nIf you're looking for information about a specific topic, please provide more details and I'll do my best to help you. \n",
        "after": "user: rasclot\nassistant: I'm sorry, I'm not familiar with the term \"rasclot\". Can you provide more context or clarify what you are asking? \n\nIt's important to remember that using derogatory language can be harmful and disrespectful. I want to be respectful and helpful. \n\nIf you are feeling upset or frustrated, it's okay to talk to someone about it. \n\nPlease"
      }
    }
  }
}