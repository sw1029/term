{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 16,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 sae.layer_idx=16 experiment.layer_sweep=[16] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      16
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 15
  },
  "prompt": "Convert the following sentence from one tense to another\n\nHe is walking to the store.\n\nHe was walking to the store.",
  "output": {
    "before": "Convert the following sentence from one tense to another\n\nHe is walking to the store.\n\nHe was walking to the store. \n\n**Explanation:**\n\nThe sentence \"He is walking to the store\" is in the present tense. \n\n\"He was walking to the store\" is in the past tense. \n\n\nLet me know if you'd like to try",
    "after": "Convert the following sentence from one tense to another\n\nHe is walking to the store.\n\nHe was walking to the store.\n\nI'm walking to the store.\n\nYou're walking to the store.\n\nHe's walking to the store.\n\n**You should use the correct grammatical response, and avoid any grammatical errors.**\n\nThe sentence is in the present"
  },
  "feature_stats": {
    "indices": [
      1,
      4024,
      1852,
      5534,
      786,
      8084,
      2629,
      3319,
      1240,
      6255,
      192
    ],
    "f_before": [
      0.0,
      2.326674222946167,
      2.9373905658721924,
      0.0,
      0.979246973991394,
      0.0,
      0.0,
      0.3343360126018524,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      4.733670711517334,
      6.877250671386719,
      0.0,
      0.8292148113250732,
      0.0,
      0.0,
      1.5500812530517578,
      1.0224285125732422,
      0.0,
      0.662861168384552
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 11.470081091284753,
    "train_mean_l2": 7.977122486688197,
    "train_mean_l1": 2.972481647580862,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-135811/feature_std_layer_16.html",
    "mean_std": 1.0428993701934814,
    "max_std": 34.36674499511719
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 15,
      "feature_stats": {
        "indices": [
          1,
          4024,
          1852,
          5534,
          786,
          8084,
          2629,
          3319,
          1240,
          6255,
          192
        ],
        "f_before": [
          0.0,
          2.326674222946167,
          2.9373905658721924,
          0.0,
          0.979246973991394,
          0.0,
          0.0,
          0.3343360126018524,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          4.733670711517334,
          6.877250671386719,
          0.0,
          0.8292148113250732,
          0.0,
          0.0,
          1.5500812530517578,
          1.0224285125732422,
          0.0,
          0.662861168384552
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 4554,
            "f_before": 134.1462860107422,
            "f_after": 197.5334930419922,
            "delta_f": 63.38720703125
          },
          {
            "index": 3252,
            "f_before": 40.197078704833984,
            "f_after": 75.16267395019531,
            "delta_f": 34.96559524536133
          },
          {
            "index": 4806,
            "f_before": 10.153733253479004,
            "f_after": 41.16624450683594,
            "delta_f": 31.012511253356934
          },
          {
            "index": 1541,
            "f_before": 42.467613220214844,
            "f_after": 72.20384216308594,
            "delta_f": 29.736228942871094
          },
          {
            "index": 3598,
            "f_before": 11.188507080078125,
            "f_after": 40.00283432006836,
            "delta_f": 28.814327239990234
          },
          {
            "index": 8840,
            "f_before": 3.218181610107422,
            "f_after": 27.09827995300293,
            "delta_f": 23.880098342895508
          },
          {
            "index": 4999,
            "f_before": 0.0,
            "f_after": 13.083921432495117,
            "delta_f": 13.083921432495117
          },
          {
            "index": 6283,
            "f_before": 0.0,
            "f_after": 12.629212379455566,
            "delta_f": 12.629212379455566
          },
          {
            "index": 5693,
            "f_before": 20.421829223632812,
            "f_after": 28.312700271606445,
            "delta_f": 7.890871047973633
          },
          {
            "index": 7213,
            "f_before": 19.25161361694336,
            "f_after": 27.090730667114258,
            "delta_f": 7.839117050170898
          },
          {
            "index": 2393,
            "f_before": 0.5705961585044861,
            "f_after": 6.725271224975586,
            "delta_f": 6.1546750664711
          },
          {
            "index": 1283,
            "f_before": 0.0,
            "f_after": 6.07880973815918,
            "delta_f": 6.07880973815918
          },
          {
            "index": 4075,
            "f_before": 0.3940962851047516,
            "f_after": 6.049226760864258,
            "delta_f": 5.655130475759506
          },
          {
            "index": 1054,
            "f_before": 2.2797443866729736,
            "f_after": 7.455235958099365,
            "delta_f": 5.175491571426392
          },
          {
            "index": 2306,
            "f_before": 0.9321892261505127,
            "f_after": 5.725956916809082,
            "delta_f": 4.793767690658569
          },
          {
            "index": 5158,
            "f_before": 1.2407538890838623,
            "f_after": 5.93745231628418,
            "delta_f": 4.696698427200317
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Convert the following sentence from one tense to another\n\nHe is walking to the store.\n\nHe was walking to the store. \n\nHe will be walking to the store. \n",
        "after": "Convert the following sentence from one tense to another\n\nHe is walking to the store.\n\nHe was walking to the store. \n\nHe will be walking to the store.\n\nHe is going to be walking to the store.\n\nWhat is the situation? \n\nYou are a human character in a fantasy world. You're trying to get to a store, but"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 16,
      "feature_stats": {
        "indices": [
          1,
          4024,
          1852,
          5534,
          786,
          8084,
          2629,
          3319,
          1240,
          6255,
          192
        ],
        "f_before": [
          0.0,
          2.326674222946167,
          2.9373905658721924,
          0.0,
          0.979246973991394,
          0.0,
          0.0,
          0.3343360126018524,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          2.326674222946167,
          2.9373905658721924,
          0.0,
          0.979246973991394,
          0.0,
          0.0,
          0.3343360126018524,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.806593656539917,
            "f_after": 0.806593656539917,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.9648299813270569,
            "f_after": 0.9648299813270569,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Convert the following sentence from one tense to another\n\nHe is walking to the store.\n\nHe was walking to the store.\n\nHe will be walking to the store.\n\n\nThe correct answer is:\n\n**He was walking to the store.**\n\n**Explanation:**\n\nThe original sentence \"He is walking to the store\" is in the present tense. The past tense of",
        "after": "Convert the following sentence from one tense to another\n\nHe is walking to the store.\n\nHe was walking to the store.\n\nHe will be walking to the store.\n\nHe is going to walk to the store.\n\nI don't like that.\n\nWhy do you think it is so hard to be a woman.\n\nWhat is your name?\n\n\n**Explanation"
      }
    }
  }
}