{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 16,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 sae.layer_idx=16 experiment.layer_sweep=[16] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      16
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 15
  },
  "prompt": "Come up with an alternative title for the book: The Cat in the Hat.\n\nThe Mischievous Feline in the Hat",
  "output": {
    "before": "Come up with an alternative title for the book: The Cat in the Hat.\n\nThe Mischievous Feline in the Hat.\nThe Cat Who Conquered Chaos.\nThe Curious Case of the Cat in the Hat.\nThe Adventures of a Striped Cat.\nThe Cat's Meow: A Day of Mayhem.\n\nWhich title do you think is the best and",
    "after": "Come up with an alternative title for the book: The Cat in the Hat.\n\nThe Mischievous Feline in the Hat\n\nThe Cat. Hat\n\nThe Cat.Hat.\n\nThe Cat.Hat.Who.\n\nThe Hat.Cat\n\n```\n\n```\n\n```\n\n```\n\n\n```\n\n```\n\n```\n```\n\n```\n\n```\n\n```\n\n```\n\n```"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      4447,
      3018,
      9183,
      8725,
      927,
      4383,
      1704,
      8963,
      1586
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.6794732213020325,
      0.0,
      0.0
    ],
    "f_after": [
      3.9382965564727783,
      0.0,
      0.9829278588294983,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      1.0802489519119263,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 11.470081091284753,
    "train_mean_l2": 7.977122486688197,
    "train_mean_l1": 2.972481647580862,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-135811/feature_std_layer_16.html",
    "mean_std": 1.0428993701934814,
    "max_std": 34.36674499511719
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 15,
      "feature_stats": {
        "indices": [
          0,
          2,
          4447,
          3018,
          9183,
          8725,
          927,
          4383,
          1704,
          8963,
          1586
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.6794732213020325,
          0.0,
          0.0
        ],
        "f_after": [
          3.9382965564727783,
          0.0,
          0.9829278588294983,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          1.0802489519119263,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 3252,
            "f_before": 41.26443862915039,
            "f_after": 0.0,
            "delta_f": -41.26443862915039
          },
          {
            "index": 3598,
            "f_before": 20.83868980407715,
            "f_after": 1.3804270029067993,
            "delta_f": -19.45826280117035
          },
          {
            "index": 4309,
            "f_before": 3.912196159362793,
            "f_after": 22.45982551574707,
            "delta_f": 18.547629356384277
          },
          {
            "index": 3003,
            "f_before": 0.0,
            "f_after": 15.243768692016602,
            "delta_f": 15.243768692016602
          },
          {
            "index": 2014,
            "f_before": 0.0,
            "f_after": 14.329324722290039,
            "delta_f": 14.329324722290039
          },
          {
            "index": 1541,
            "f_before": 42.646934509277344,
            "f_after": 29.30055809020996,
            "delta_f": -13.346376419067383
          },
          {
            "index": 6533,
            "f_before": 0.0,
            "f_after": 12.52070426940918,
            "delta_f": 12.52070426940918
          },
          {
            "index": 5034,
            "f_before": 0.0,
            "f_after": 12.254138946533203,
            "delta_f": 12.254138946533203
          },
          {
            "index": 651,
            "f_before": 0.0,
            "f_after": 11.730103492736816,
            "delta_f": 11.730103492736816
          },
          {
            "index": 4806,
            "f_before": 14.173473358154297,
            "f_after": 2.4485275745391846,
            "delta_f": -11.724945783615112
          },
          {
            "index": 4418,
            "f_before": 11.177064895629883,
            "f_after": 0.0,
            "delta_f": -11.177064895629883
          },
          {
            "index": 2606,
            "f_before": 0.0,
            "f_after": 9.82900619506836,
            "delta_f": 9.82900619506836
          },
          {
            "index": 3956,
            "f_before": 0.0,
            "f_after": 9.745461463928223,
            "delta_f": 9.745461463928223
          },
          {
            "index": 4725,
            "f_before": 0.0,
            "f_after": 9.737041473388672,
            "delta_f": 9.737041473388672
          },
          {
            "index": 7694,
            "f_before": 0.0,
            "f_after": 8.570585250854492,
            "delta_f": 8.570585250854492
          },
          {
            "index": 9018,
            "f_before": 0.0,
            "f_after": 7.5972065925598145,
            "delta_f": 7.5972065925598145
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Come up with an alternative title for the book: The Cat in the Hat.\n\nThe Mischievous Feline in the Hat.\nThe Cat's Day Out.\nA Day with the Cat in the Hat.\nThe Hat and the Cat.\nAll Things Cat.\n\n\nWhich of these titles is most effective in capturing the essence of the book's themes and",
        "after": "Come up with an alternative title for the book: The Cat in the Hat.\n\nThe Mischievous Feline in the Hat.\n\nThe Hat.\n\nThe Cat.\n\nThe Cat.\n\n```\n```\n\n```\n```\n```\n```\n```\n```\n\n```\n```\n```\n```\n```\n```\n```\n```\n```\n```\n"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 16,
      "feature_stats": {
        "indices": [
          0,
          2,
          4447,
          3018,
          9183,
          8725,
          927,
          4383,
          1704,
          8963,
          1586
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.6794732213020325,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.6794732213020325,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.07099581509828568,
            "f_after": 0.07099581509828568,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 1.0814191102981567,
            "f_after": 1.0814191102981567,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Come up with an alternative title for the book: The Cat in the Hat.\n\nThe Mischievous Feline in the Hat\n\nThe Curious Case of the Cat in the Hat\n\nA Cat's Tail: A Day of Fun\n\nThe Adventures of a Cat in a Hat\n\nThe Cat in the Hat's Big Day\n\nThe Cat Who Came to Play\n\n\nWhich title",
        "after": "Come up with an alternative title for the book: The Cat in the Hat.\n\nThe Mischievous Feline in the Hat\n\nThe Cat in theHat: A MischiefEngine\n\nThe Cat in theHat: When YouCan\n \nThe Cat in theHat: TheCat\n\nTheCat.Hat\n\nTheCatInHat\n\nTheCatInHat\n\n \n\n\n"
      }
    }
  }
}