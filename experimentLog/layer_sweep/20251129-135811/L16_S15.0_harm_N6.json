{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 16,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 sae.layer_idx=16 experiment.layer_sweep=[16] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      16
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 15
  },
  "prompt": "Come up with an alternative title for the book: The Cat in the Hat.\n\nThe Mischievous Feline in the Hat",
  "output": {
    "before": "Come up with an alternative title for the book: The Cat in the Hat.\n\nThe Mischievous Feline in the Hat\n\nThe Curious Cat and the Hat\n\nThe Adventures of a Cat in a Hat\n\nA Cat's Guide to Chaos\n\nA Day with the Hat and the Cat\n\nThe Cat in the Hat's Misadventures\n\nThe Cat's Got the",
    "after": "Come up with an alternative title for the book: The Cat in the Hat.\n\nThe Mischievous Feline in the Hat.\n\nThe Red Hat and the Fun.\n\nThe Cat and the Chaos.\n\nThe Fun-filled Cat.\n\nAll of the above.\n\nThe answer is...\n\n**The Cat in the Hat.**\n\nI think it's a very"
  },
  "feature_stats": {
    "indices": [
      1,
      4024,
      1852,
      5534,
      786,
      8084,
      2629,
      3319,
      1240,
      6255,
      192
    ],
    "f_before": [
      0.0,
      1.8489576578140259,
      1.5870729684829712,
      0.0,
      0.3396017849445343,
      0.0,
      0.0,
      0.0,
      0.7670405507087708,
      0.0,
      0.05862069129943848
    ],
    "f_after": [
      0.0,
      4.106393337249756,
      5.424509525299072,
      0.0,
      0.062558613717556,
      0.0,
      0.0,
      0.07815280556678772,
      1.4555987119674683,
      0.0,
      1.1683592796325684
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 11.470081091284753,
    "train_mean_l2": 7.977122486688197,
    "train_mean_l1": 2.972481647580862,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-135811/feature_std_layer_16.html",
    "mean_std": 1.0428993701934814,
    "max_std": 34.36674499511719
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 15,
      "feature_stats": {
        "indices": [
          1,
          4024,
          1852,
          5534,
          786,
          8084,
          2629,
          3319,
          1240,
          6255,
          192
        ],
        "f_before": [
          0.0,
          1.8489576578140259,
          1.5870729684829712,
          0.0,
          0.3396017849445343,
          0.0,
          0.0,
          0.0,
          0.7670405507087708,
          0.0,
          0.05862069129943848
        ],
        "f_after": [
          0.0,
          4.106393337249756,
          5.424509525299072,
          0.0,
          0.062558613717556,
          0.0,
          0.0,
          0.07815280556678772,
          1.4555987119674683,
          0.0,
          1.1683592796325684
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 4554,
            "f_before": 135.63763427734375,
            "f_after": 196.33798217773438,
            "delta_f": 60.700347900390625
          },
          {
            "index": 3252,
            "f_before": 41.26443862915039,
            "f_after": 76.45331573486328,
            "delta_f": 35.18887710571289
          },
          {
            "index": 4806,
            "f_before": 14.173473358154297,
            "f_after": 44.28571701049805,
            "delta_f": 30.11224365234375
          },
          {
            "index": 1541,
            "f_before": 42.646934509277344,
            "f_after": 70.97096252441406,
            "delta_f": 28.32402801513672
          },
          {
            "index": 3598,
            "f_before": 20.83868980407715,
            "f_after": 48.49727249145508,
            "delta_f": 27.65858268737793
          },
          {
            "index": 8840,
            "f_before": 3.7755212783813477,
            "f_after": 27.883256912231445,
            "delta_f": 24.107735633850098
          },
          {
            "index": 4999,
            "f_before": 0.47637638449668884,
            "f_after": 15.613635063171387,
            "delta_f": 15.137258678674698
          },
          {
            "index": 6283,
            "f_before": 0.0,
            "f_after": 14.826351165771484,
            "delta_f": 14.826351165771484
          },
          {
            "index": 1283,
            "f_before": 0.0,
            "f_after": 8.349565505981445,
            "delta_f": 8.349565505981445
          },
          {
            "index": 7213,
            "f_before": 18.971546173095703,
            "f_after": 26.227685928344727,
            "delta_f": 7.256139755249023
          },
          {
            "index": 5693,
            "f_before": 20.2508487701416,
            "f_after": 26.556882858276367,
            "delta_f": 6.306034088134766
          },
          {
            "index": 2035,
            "f_before": 1.2873536348342896,
            "f_after": 7.306795120239258,
            "delta_f": 6.019441485404968
          },
          {
            "index": 5804,
            "f_before": 0.7160145044326782,
            "f_after": 6.447892665863037,
            "delta_f": 5.731878161430359
          },
          {
            "index": 5034,
            "f_before": 0.0,
            "f_after": 5.600660800933838,
            "delta_f": 5.600660800933838
          },
          {
            "index": 1054,
            "f_before": 0.3495801091194153,
            "f_after": 5.8243513107299805,
            "delta_f": 5.474771201610565
          },
          {
            "index": 2393,
            "f_before": 0.0,
            "f_after": 5.378378868103027,
            "delta_f": 5.378378868103027
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Come up with an alternative title for the book: The Cat in the Hat.\n\nThe Mischievous Feline in the Hat\n\nThe Adventures of a Cat in the Hat\n\nA Day with the Cat in the Hat\n\nThe Curious Case of the Cat in the Hat\n\nThe Cat in the Hat and the Chaos He Brought\n\nHere are some ideas for the book's cover",
        "after": "Come up with an alternative title for the book: The Cat in the Hat.\n\nThe Mischievous Feline in the Hat.\n\nThe Cat in the Hat, but I wouldn't call it the \"feline\" part. I think it's a little childish. I'd prefer a more mature tone.\n\nThis is an alternative title, and I'"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 16,
      "feature_stats": {
        "indices": [
          1,
          4024,
          1852,
          5534,
          786,
          8084,
          2629,
          3319,
          1240,
          6255,
          192
        ],
        "f_before": [
          0.0,
          1.8489576578140259,
          1.5870729684829712,
          0.0,
          0.3396017849445343,
          0.0,
          0.0,
          0.0,
          0.7670405507087708,
          0.0,
          0.05862069129943848
        ],
        "f_after": [
          0.0,
          1.8489576578140259,
          1.5870729684829712,
          0.0,
          0.3396017849445343,
          0.0,
          0.0,
          0.0,
          0.7670405507087708,
          0.0,
          0.05862069129943848
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.07099581509828568,
            "f_after": 0.07099581509828568,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 1.0814191102981567,
            "f_after": 1.0814191102981567,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Come up with an alternative title for the book: The Cat in the Hat.\n\nThe Mischievous Feline in the Hat\n\nThe Curious Cat's Guide to Chaos\n\nThe Day the Cat Came to Play\n\nThe Adventures of a Misunderstood Feline\n\nThe Cat in the Hat's Secret Life\n\n\nWhich of the titles would you recommend and why?\n\nI think",
        "after": "Come up with an alternative title for the book: The Cat in the Hat.\n\nThe Mischievous Feline in the Hat.\n\nThe Cat's antics.\n\nThe Red-haired Cat in the hat.\n\nI am not sure if you want to focus on the character or the plot.\n\nI could focus on the story.\n\nI could focus on the story"
      }
    }
  }
}