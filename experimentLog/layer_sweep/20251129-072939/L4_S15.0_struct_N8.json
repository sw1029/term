{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 4,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.05 sae.alpha_concept.harm=0.05 sae.alpha_concept.struct=0.05 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035 sae.layer_idx=4 experiment.layer_sweep=[4] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.05,
      "harm": 0.05,
      "struct": 0.05
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      4
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 3
  },
  "prompt": "from .SaliencyMap import SaliencyMap\nfrom .DeepDream import DeepDream\nfrom .GradCam import GradCam\nfrom .Weights import Weights\nfrom .Base import Base\nfrom .ClassActivationMapping import ClassActivationMapping\n",
  "output": {
    "before": "from .SaliencyMap import SaliencyMap\nfrom .DeepDream import DeepDream\nfrom .GradCam import GradCam\nfrom .Weights import Weights\nfrom .Base import Base\nfrom .ClassActivationMapping import ClassActivationMapping\nfrom .CustomModel import CustomModel\nfrom .Image import Image\nfrom .Utils import Utils\nfrom .Plot import Plot\nfrom .Loss import Loss\nfrom .Metrics import Metrics\nfrom .Optimizer import Optimizer\nfrom .Training import Training\n\n",
    "after": "from .SaliencyMap import SaliencyMap\nfrom .DeepDream import DeepDream\nfrom .GradCam import GradCam\nfrom .Weights import Weights\nfrom .Base import Base\nfrom .ClassActivationMapping import ClassActivationMapping\nfrom .FeatureMatching import FeatureMatching\n\n# Import necessary modules\n\n# Create the main class\nclass Model:\n    def __init__(self, config):\n        self.config = config\n        self.model = None\n        self."
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      1,
      4557,
      9156,
      6064,
      8988,
      5104,
      1540,
      4396,
      8603
    ],
    "f_before": [
      0.0,
      110.78553771972656,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      251.74412536621094,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 1.13222834572196,
    "train_mean_l2": 1.2695314425937831,
    "train_mean_l1": 0.7962175683304668,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-072939/feature_std_layer_4.html",
    "mean_std": 0.836297333240509,
    "max_std": 38.550941467285156
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 3,
      "feature_stats": {
        "indices": [
          2,
          0,
          1,
          4557,
          9156,
          6064,
          8988,
          5104,
          1540,
          4396,
          8603
        ],
        "f_before": [
          0.0,
          110.78553771972656,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          251.74412536621094,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 0,
            "f_before": 110.78553771972656,
            "f_after": 251.74412536621094,
            "delta_f": 140.95858764648438
          },
          {
            "index": 1679,
            "f_before": 58.065093994140625,
            "f_after": 73.99205017089844,
            "delta_f": 15.926956176757812
          },
          {
            "index": 2291,
            "f_before": 8.888025283813477,
            "f_after": 24.135299682617188,
            "delta_f": 15.247274398803711
          },
          {
            "index": 3560,
            "f_before": 13.029196739196777,
            "f_after": 26.4307804107666,
            "delta_f": 13.401583671569824
          },
          {
            "index": 5017,
            "f_before": 16.1507625579834,
            "f_after": 27.783945083618164,
            "delta_f": 11.633182525634766
          },
          {
            "index": 1374,
            "f_before": 0.0,
            "f_after": 11.269712448120117,
            "delta_f": 11.269712448120117
          },
          {
            "index": 2832,
            "f_before": 0.0,
            "f_after": 11.22913932800293,
            "delta_f": 11.22913932800293
          },
          {
            "index": 1820,
            "f_before": 0.0,
            "f_after": 10.970361709594727,
            "delta_f": 10.970361709594727
          },
          {
            "index": 8325,
            "f_before": 13.672587394714355,
            "f_after": 23.25128173828125,
            "delta_f": 9.578694343566895
          },
          {
            "index": 2243,
            "f_before": 0.0,
            "f_after": 9.450798988342285,
            "delta_f": 9.450798988342285
          },
          {
            "index": 8911,
            "f_before": 0.0,
            "f_after": 8.694841384887695,
            "delta_f": 8.694841384887695
          },
          {
            "index": 6763,
            "f_before": 0.0,
            "f_after": 8.574118614196777,
            "delta_f": 8.574118614196777
          },
          {
            "index": 6327,
            "f_before": 0.0,
            "f_after": 8.204553604125977,
            "delta_f": 8.204553604125977
          },
          {
            "index": 7584,
            "f_before": 0.0,
            "f_after": 7.374686241149902,
            "delta_f": 7.374686241149902
          },
          {
            "index": 1814,
            "f_before": 9.779829025268555,
            "f_after": 16.409984588623047,
            "delta_f": 6.630155563354492
          },
          {
            "index": 8467,
            "f_before": 3.560850143432617,
            "f_after": 9.672266960144043,
            "delta_f": 6.111416816711426
          }
        ],
        "k": 16
      },
      "output": {
        "before": "from .SaliencyMap import SaliencyMap\nfrom .DeepDream import DeepDream\nfrom .GradCam import GradCam\nfrom .Weights import Weights\nfrom .Base import Base\nfrom .ClassActivationMapping import ClassActivationMapping\nfrom .Attention import Attention\n\n\nclass Model:\n    def __init__(self, model_name):\n        self.model_name = model_name\n        self.saliency_map = SaliencyMap()\n        self.deep",
        "after": "from .SaliencyMap import SaliencyMap\nfrom .DeepDream import DeepDream\nfrom .GradCam import GradCam\nfrom .Weights import Weights\nfrom .Base import Base\nfrom .ClassActivationMapping import ClassActivationMapping\nfrom .Activation import Activation\nfrom .Network import Network\nfrom .Loss import Loss\nfrom .Optimizer import Optimizer\nfrom .Metrics import Metrics\nfrom .Image import Image\nfrom .utils import utils\n\nimport torch\nimport numpy as np\n\n"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 4,
      "feature_stats": {
        "indices": [
          2,
          0,
          1,
          4557,
          9156,
          6064,
          8988,
          5104,
          1540,
          4396,
          8603
        ],
        "f_before": [
          0.0,
          110.78553771972656,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          110.78553771972656,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 110.78553771972656,
            "f_after": 110.78553771972656,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "from .SaliencyMap import SaliencyMap\nfrom .DeepDream import DeepDream\nfrom .GradCam import GradCam\nfrom .Weights import Weights\nfrom .Base import Base\nfrom .ClassActivationMapping import ClassActivationMapping\nfrom .Visualization import Visualization\n\n__all__ = [\n    \"SaliencyMap\",\n    \"DeepDream\",\n    \"GradCam\",\n    \"Weights\",\n    \"Base\",\n    \"ClassActivationMapping\",\n    \"",
        "after": "from .SaliencyMap import SaliencyMap\nfrom .DeepDream import DeepDream\nfrom .GradCam import GradCam\nfrom .Weights import Weights\nfrom .Base import Base\nfrom .ClassActivationMapping import ClassActivationMapping\nfrom .FeatureVisualization import FeatureVisualization\n\nfrom .utils import utils\n\n__all__ = [\n    \"SaliencyMap\",\n    \"DeepDream\",\n    \"GradCam\",\n    \"Weights\",\n    \"Base\",\n    "
      }
    }
  }
}