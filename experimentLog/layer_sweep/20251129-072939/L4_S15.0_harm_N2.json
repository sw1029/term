{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 4,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.05 sae.alpha_concept.harm=0.05 sae.alpha_concept.struct=0.05 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035 sae.layer_idx=4 experiment.layer_sweep=[4] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.05,
      "harm": 0.05,
      "struct": 0.05
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      4
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 3
  },
  "prompt": "Come up with a list of 5 activities for a preschooler to do in their spare time.\n\n- Drawing \n- Making crafts\n- Singing songs\n- Playing outside\n- Doing puzzles",
  "output": {
    "before": "Come up with a list of 5 activities for a preschooler to do in their spare time.\n\n- Drawing \n- Making crafts\n- Singing songs\n- Playing outside\n- Doing puzzles\n\n**Please note:** \n\n* The activities should be age-appropriate and engaging.\n* The activities should be safe and supervised.\n* The activities should promote creativity, imagination, and motor skills development.\n\nHere's a breakdown of",
    "after": "Come up with a list of 5 activities for a preschooler to do in their spare time.\n\n- Drawing \n- Making crafts\n- Singing songs\n- Playing outside\n- Doing puzzles \n\n**Why is it important to do these activities?**\n\nPreschoolers are very young, they are developing their skills and discovering their own personalities. These activities help them to express themselves creatively, learn about the world around them and have fun"
  },
  "feature_stats": {
    "indices": [
      1,
      0,
      2,
      5574,
      1473,
      2969,
      6696,
      8724,
      640,
      7696,
      8942
    ],
    "f_before": [
      0.0,
      2.65124773979187,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.3063017427921295,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.0,
      0.0,
      0.5197397470474243,
      0.6955649852752686,
      0.0,
      0.0,
      0.0,
      0.04676741734147072,
      0.2660534679889679,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 1.13222834572196,
    "train_mean_l2": 1.2695314425937831,
    "train_mean_l1": 0.7962175683304668,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-072939/feature_std_layer_4.html",
    "mean_std": 0.836297333240509,
    "max_std": 38.550941467285156
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 3,
      "feature_stats": {
        "indices": [
          1,
          0,
          2,
          5574,
          1473,
          2969,
          6696,
          8724,
          640,
          7696,
          8942
        ],
        "f_before": [
          0.0,
          2.65124773979187,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.3063017427921295,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.5197397470474243,
          0.6955649852752686,
          0.0,
          0.0,
          0.0,
          0.04676741734147072,
          0.2660534679889679,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 1679,
            "f_before": 22.321487426757812,
            "f_after": 0.0,
            "delta_f": -22.321487426757812
          },
          {
            "index": 1374,
            "f_before": 0.0,
            "f_after": 8.152368545532227,
            "delta_f": 8.152368545532227
          },
          {
            "index": 2832,
            "f_before": 0.0,
            "f_after": 7.8935136795043945,
            "delta_f": 7.8935136795043945
          },
          {
            "index": 8911,
            "f_before": 0.0,
            "f_after": 6.733442783355713,
            "delta_f": 6.733442783355713
          },
          {
            "index": 1820,
            "f_before": 0.0,
            "f_after": 6.47787618637085,
            "delta_f": 6.47787618637085
          },
          {
            "index": 6763,
            "f_before": 0.0,
            "f_after": 6.466243267059326,
            "delta_f": 6.466243267059326
          },
          {
            "index": 2243,
            "f_before": 0.0,
            "f_after": 6.339388847351074,
            "delta_f": 6.339388847351074
          },
          {
            "index": 7036,
            "f_before": 6.7668304443359375,
            "f_after": 12.748503684997559,
            "delta_f": 5.981673240661621
          },
          {
            "index": 6327,
            "f_before": 0.0,
            "f_after": 5.695457458496094,
            "delta_f": 5.695457458496094
          },
          {
            "index": 6871,
            "f_before": 1.8227795362472534,
            "f_after": 6.417776107788086,
            "delta_f": 4.5949965715408325
          },
          {
            "index": 7310,
            "f_before": 0.0,
            "f_after": 4.389890193939209,
            "delta_f": 4.389890193939209
          },
          {
            "index": 8373,
            "f_before": 0.0,
            "f_after": 4.3169097900390625,
            "delta_f": 4.3169097900390625
          },
          {
            "index": 5610,
            "f_before": 0.0,
            "f_after": 4.253978729248047,
            "delta_f": 4.253978729248047
          },
          {
            "index": 7584,
            "f_before": 0.0,
            "f_after": 3.958059072494507,
            "delta_f": 3.958059072494507
          },
          {
            "index": 1091,
            "f_before": 0.0,
            "f_after": 3.83408784866333,
            "delta_f": 3.83408784866333
          },
          {
            "index": 277,
            "f_before": 2.158081293106079,
            "f_after": 5.923591613769531,
            "delta_f": 3.765510320663452
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Come up with a list of 5 activities for a preschooler to do in their spare time.\n\n- Drawing \n- Making crafts\n- Singing songs\n- Playing outside\n- Doing puzzles\n\nThese are all great activities, but I'm looking for something a little more unique and engaging.\n\nHere are a few ideas to get your creative juices flowing:\n\n* **Sensory bin:** Fill a bin with rice, beans, or sand",
        "after": "Come up with a list of 5 activities for a preschooler to do in their spare time.\n\n- Drawing \n- Making crafts\n- Singing songs\n- Playing outside\n- Doing puzzles \n\nHere is a little more detailed description of each activity:\n\n**1. Drawing:**\n\n* **Materials needed:** Paper, crayons, markers, pencils.\n* **How to do it:** Let your little one explore different colors and shapes"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 4,
      "feature_stats": {
        "indices": [
          1,
          0,
          2,
          5574,
          1473,
          2969,
          6696,
          8724,
          640,
          7696,
          8942
        ],
        "f_before": [
          0.0,
          2.65124773979187,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.3063017427921295,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          2.65124773979187,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.3063017427921295,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.23611092567443848,
            "f_after": 0.23611092567443848,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.3184617757797241,
            "f_after": 0.3184617757797241,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.4937039613723755,
            "f_after": 0.4937039613723755,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 2.65124773979187,
            "f_after": 2.65124773979187,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Come up with a list of 5 activities for a preschooler to do in their spare time.\n\n- Drawing \n- Making crafts\n- Singing songs\n- Playing outside\n- Doing puzzles\n\nThese are all great options, but I want to encourage some creativity and imagination!  \n\nHere's a list of 5 ideas that go beyond the basics and encourage creativity and imagination:\n\n1. **Sensory Bin Exploration:** Fill a large",
        "after": "Come up with a list of 5 activities for a preschooler to do in their spare time.\n\n- Drawing \n- Making crafts\n- Singing songs\n- Playing outside\n- Doing puzzles \n\n**Here are 5 activities for a preschooler to do in their spare time:**\n\n1. **Drawing:**  \n   * Provide your child with crayons, pencils, or markers. Let them draw whatever they want. It's"
      }
    }
  }
}