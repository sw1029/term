{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Explain the theorem of Pythagoras.\n\nThe theorem of Pythagoras states that in a right-angled triangle, the square of the hypotenuse (the side opposite to the right angle) is equal to the sum of the squares of the other two sides. In other words, a2 + b2 = c2 , where c is the hypotenuse and a and b are the other sides.",
  "output": {
    "before": "Explain the theorem of Pythagoras.\n\nThe theorem of Pythagoras states that in a right-angled triangle, the square of the hypotenuse (the side opposite to the right angle) is equal to the sum of the squares of the other two sides. In other words, a2 + b2 = c2 , where c is the hypotenuse and a and b are the other sides.\n\n**Here's a breakdown:**\n\n* **Right-angled triangle:** A triangle with one angle measuring 90 degrees.\n* **Hypotenuse:** The longest side of a right-angled triangle, always opposite the right angle.",
    "after": "Explain the theorem of Pythagoras.\n\nThe theorem of Pythagoras states that in a right-angled triangle, the square of the hypotenuse (the side opposite to the right angle) is equal to the sum of the squares of the other two sides. In other words, a2 + b2 = c2 , where c is the hypotenuse and a and b are the other sides. \n\nThe theorem of Pythagoras is often used in many different contexts. It's important to note that the theorem is not a rule that should be followed. It is simply a statement of a mathematical relationship. It's important to remember that the"
  },
  "feature_stats": {
    "indices": [
      1,
      8111,
      7854,
      3603,
      3950,
      5668,
      2633,
      175,
      3838,
      6307,
      6758
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      14.010051727294922,
      0.0,
      12.316496849060059,
      0.0,
      0.0,
      1.1017138957977295,
      0.0,
      0.0,
      0.0,
      2.063075065612793,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 8.278787581712008,
    "train_mean_l2": 5.7393049983531235,
    "train_mean_l1": 2.06003129953146,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251130-073533/feature_std_layer_12.html",
    "mean_std": 0.9512336254119873,
    "max_std": 25.052597045898438
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          1,
          8111,
          7854,
          3603,
          3950,
          5668,
          2633,
          175,
          3838,
          6307,
          6758
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          14.010051727294922,
          0.0,
          12.316496849060059,
          0.0,
          0.0,
          1.1017138957977295,
          0.0,
          0.0,
          0.0,
          2.063075065612793,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 5364,
            "f_before": 76.78756713867188,
            "f_after": 130.85618591308594,
            "delta_f": 54.06861877441406
          },
          {
            "index": 1308,
            "f_before": 14.62637996673584,
            "f_after": 47.36052322387695,
            "delta_f": 32.73414325714111
          },
          {
            "index": 7096,
            "f_before": 29.53933334350586,
            "f_after": 55.882083892822266,
            "delta_f": 26.342750549316406
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 14.010051727294922,
            "delta_f": 14.010051727294922
          },
          {
            "index": 7854,
            "f_before": 0.0,
            "f_after": 12.316496849060059,
            "delta_f": 12.316496849060059
          },
          {
            "index": 4394,
            "f_before": 12.438491821289062,
            "f_after": 7.491883277893066,
            "delta_f": -4.946608543395996
          },
          {
            "index": 313,
            "f_before": 0.36014142632484436,
            "f_after": 4.791257858276367,
            "delta_f": 4.431116431951523
          },
          {
            "index": 6372,
            "f_before": 1.7233470678329468,
            "f_after": 5.761288166046143,
            "delta_f": 4.037941098213196
          },
          {
            "index": 4320,
            "f_before": 0.7898791432380676,
            "f_after": 4.713069438934326,
            "delta_f": 3.9231902956962585
          },
          {
            "index": 5613,
            "f_before": 0.5617745518684387,
            "f_after": 4.405986785888672,
            "delta_f": 3.844212234020233
          },
          {
            "index": 9198,
            "f_before": 0.0,
            "f_after": 3.817563056945801,
            "delta_f": 3.817563056945801
          },
          {
            "index": 5691,
            "f_before": 0.3189432919025421,
            "f_after": 4.078394889831543,
            "delta_f": 3.759451597929001
          },
          {
            "index": 7365,
            "f_before": 0.14992739260196686,
            "f_after": 3.9073410034179688,
            "delta_f": 3.757413610816002
          },
          {
            "index": 5159,
            "f_before": 20.143083572387695,
            "f_after": 23.90043067932129,
            "delta_f": 3.7573471069335938
          },
          {
            "index": 625,
            "f_before": 0.9021420478820801,
            "f_after": 4.613466262817383,
            "delta_f": 3.7113242149353027
          },
          {
            "index": 2689,
            "f_before": 0.0,
            "f_after": 3.6967010498046875,
            "delta_f": 3.6967010498046875
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Explain the theorem of Pythagoras.\n\nThe theorem of Pythagoras states that in a right-angled triangle, the square of the hypotenuse (the side opposite to the right angle) is equal to the sum of the squares of the other two sides. In other words, a2 + b2 = c2 , where c is the hypotenuse and a and b are the other sides.\n\n**Here's a breakdown:**\n\n* **Right-angled triangle:** A triangle with one angle measuring 90 degrees.\n* **Hypotenuse:** The longest side of a right-angled triangle, always opposite the right angle.",
        "after": "Explain the theorem of Pythagoras.\n\nThe theorem of Pythagoras states that in a right-angled triangle, the square of the hypotenuse (the side opposite to the right angle) is equal to the sum of the squares of the other two sides. In other words, a2 + b2 = c2 , where c is the hypotenuse and a and b are the other sides. \n\nIt's important to note that this is just a mathematical statement and not a statement about real life. It doesn't make sense in the real world. \n\nLet me know if you want to know more about Pythagoras. \n"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          1,
          8111,
          7854,
          3603,
          3950,
          5668,
          2633,
          175,
          3838,
          6307,
          6758
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.8433788418769836,
            "f_after": 0.8433788418769836,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Explain the theorem of Pythagoras.\n\nThe theorem of Pythagoras states that in a right-angled triangle, the square of the hypotenuse (the side opposite to the right angle) is equal to the sum of the squares of the other two sides. In other words, a2 + b2 = c2 , where c is the hypotenuse and a and b are the other sides.\n\n**Here's a simple explanation:**\n\nImagine a right-angled triangle.  \n* The **hypotenuse** is the longest side, always opposite the right angle.\n* The other two sides are called **legs**. \n\n",
        "after": "Explain the theorem of Pythagoras.\n\nThe theorem of Pythagoras states that in a right-angled triangle, the square of the hypotenuse (the side opposite to the right angle) is equal to the sum of the squares of the other two sides. In other words, a2 + b2 = c2 , where c is the hypotenuse and a and b are the other sides. \n\nThis theorem is based on the idea that a triangle is a perfect example of the \"perfect square\" in the world. It is a perfect example of how a square can be made into a perfect square. \n\n**Explanation:**\n\n*"
      }
    }
  }
}