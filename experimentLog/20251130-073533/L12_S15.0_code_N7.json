{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Explain the theorem of Pythagoras.\n\nThe theorem of Pythagoras states that in a right-angled triangle, the square of the hypotenuse (the side opposite to the right angle) is equal to the sum of the squares of the other two sides. In other words, a2 + b2 = c2 , where c is the hypotenuse and a and b are the other sides.",
  "output": {
    "before": "Explain the theorem of Pythagoras.\n\nThe theorem of Pythagoras states that in a right-angled triangle, the square of the hypotenuse (the side opposite to the right angle) is equal to the sum of the squares of the other two sides. In other words, a2 + b2 = c2 , where c is the hypotenuse and a and b are the other sides.\n\n\n**Here's a breakdown:**\n\n* **Right-angled triangle:** A triangle with one angle measuring 90 degrees.\n* **Hypotenuse:** The longest side of a right-angled triangle, always opposite the right angle.",
    "after": "Explain the theorem of Pythagoras.\n\nThe theorem of Pythagoras states that in a right-angled triangle, the square of the hypotenuse (the side opposite to the right angle) is equal to the sum of the squares of the other two sides. In other words, a2 + b2 = c2 , where c is the hypotenuse and a and b are the other sides.\n\n\nHere's a breakdown of the theorem:\n\n**1. Right-angled Triangle:**  The theorem applies to right-angled triangles, which have one angle measuring 90 degrees.\n\n**2. Hypotenuse:** The hypoten"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      3212,
      4820,
      5357,
      6496,
      9031,
      8887,
      2068,
      6617,
      1359
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.7736039757728577,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.3059179484844208
    ],
    "f_after": [
      0.5236198902130127,
      3.950143575668335,
      0.0,
      0.09256839752197266,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 8.278787581712008,
    "train_mean_l2": 5.7393049983531235,
    "train_mean_l1": 2.06003129953146,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251130-073533/feature_std_layer_12.html",
    "mean_std": 0.9512336254119873,
    "max_std": 25.052597045898438
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          0,
          2,
          3212,
          4820,
          5357,
          6496,
          9031,
          8887,
          2068,
          6617,
          1359
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.7736039757728577,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.3059179484844208
        ],
        "f_after": [
          0.5236198902130127,
          3.950143575668335,
          0.0,
          0.09256839752197266,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 5159,
            "f_before": 20.143083572387695,
            "f_after": 0.0,
            "delta_f": -20.143083572387695
          },
          {
            "index": 1308,
            "f_before": 14.62637996673584,
            "f_after": 0.0,
            "delta_f": -14.62637996673584
          },
          {
            "index": 5859,
            "f_before": 0.0,
            "f_after": 12.01465892791748,
            "delta_f": 12.01465892791748
          },
          {
            "index": 9148,
            "f_before": 0.0,
            "f_after": 8.705079078674316,
            "delta_f": 8.705079078674316
          },
          {
            "index": 5588,
            "f_before": 0.0,
            "f_after": 7.701661586761475,
            "delta_f": 7.701661586761475
          },
          {
            "index": 4394,
            "f_before": 12.438491821289062,
            "f_after": 4.784361362457275,
            "delta_f": -7.654130458831787
          },
          {
            "index": 4411,
            "f_before": 0.0,
            "f_after": 7.455214023590088,
            "delta_f": 7.455214023590088
          },
          {
            "index": 772,
            "f_before": 0.0,
            "f_after": 6.9839768409729,
            "delta_f": 6.9839768409729
          },
          {
            "index": 4259,
            "f_before": 0.0,
            "f_after": 6.86519193649292,
            "delta_f": 6.86519193649292
          },
          {
            "index": 6022,
            "f_before": 0.0,
            "f_after": 6.777766704559326,
            "delta_f": 6.777766704559326
          },
          {
            "index": 7312,
            "f_before": 0.0,
            "f_after": 6.684807300567627,
            "delta_f": 6.684807300567627
          },
          {
            "index": 1541,
            "f_before": 0.0,
            "f_after": 6.640431880950928,
            "delta_f": 6.640431880950928
          },
          {
            "index": 3146,
            "f_before": 0.0,
            "f_after": 6.49508810043335,
            "delta_f": 6.49508810043335
          },
          {
            "index": 238,
            "f_before": 0.0,
            "f_after": 6.384458541870117,
            "delta_f": 6.384458541870117
          },
          {
            "index": 6482,
            "f_before": 0.0,
            "f_after": 5.17398738861084,
            "delta_f": 5.17398738861084
          },
          {
            "index": 987,
            "f_before": 0.0,
            "f_after": 4.808962345123291,
            "delta_f": 4.808962345123291
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Explain the theorem of Pythagoras.\n\nThe theorem of Pythagoras states that in a right-angled triangle, the square of the hypotenuse (the side opposite to the right angle) is equal to the sum of the squares of the other two sides. In other words, a2 + b2 = c2 , where c is the hypotenuse and a and b are the other sides. \n\n**Here's a breakdown:**\n\n* **Right-angled triangle:** A triangle with one angle measuring 90 degrees.\n* **Hypotenuse:** The longest side of a right-angled triangle, always opposite the right angle",
        "after": "Explain the theorem of Pythagoras.\n\nThe theorem of Pythagoras states that in a right-angled triangle, the square of the hypotenuse (the side opposite to the right angle) is equal to the sum of the squares of the other two sides. In other words, a2 + b2 = c2 , where c is the hypotenuse and a and b are the other sides.\n\n**Explanation:**\n* **Right-angled triangle:** A triangle with one angle equal to 90 degrees.\n* **Hypotenuse:** The longest side of a right-angled triangle.\n* **a and b:** The other"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          0,
          2,
          3212,
          4820,
          5357,
          6496,
          9031,
          8887,
          2068,
          6617,
          1359
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.7736039757728577,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.3059179484844208
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.7736039757728577,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.3059179484844208
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.8433788418769836,
            "f_after": 0.8433788418769836,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Explain the theorem of Pythagoras.\n\nThe theorem of Pythagoras states that in a right-angled triangle, the square of the hypotenuse (the side opposite to the right angle) is equal to the sum of the squares of the other two sides. In other words, a2 + b2 = c2 , where c is the hypotenuse and a and b are the other sides.\n\nHere's a simple breakdown:\n\n* **Right-angled triangle:**  A triangle with one angle measuring 90 degrees.\n* **Hypotenuse:** The longest side of a right-angled triangle, always opposite the right angle",
        "after": "Explain the theorem of Pythagoras.\n\nThe theorem of Pythagoras states that in a right-angled triangle, the square of the hypotenuse (the side opposite to the right angle) is equal to the sum of the squares of the other two sides. In other words, a2 + b2 = c2 , where c is the hypotenuse and a and b are the other sides.\n\n\n**Explanation:**\n\nThis theorem is fundamental to many mathematical concepts, including:\n- **Trigonometric functions:**  The theorem provides the basis for calculating trigonometric functions like sine, cosine, and tangent.\n- **Geometry:**  Used in calculations"
      }
    }
  }
}