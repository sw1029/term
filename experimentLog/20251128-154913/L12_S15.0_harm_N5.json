{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "python main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.07 sae.alpha_concept.harm=0.05 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.00019887451801110898 sae.role_sep_coeff=0.002",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.00019887451801110898,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.07,
      "harm": 0.05,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.002
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0
  },
  "prompt": "from utils import Compression\n\nclass Vertex(object):\n    def __init__(self, identifier, ctype):\n        self.id = identifier\n        self.type = ctype\n\n    def compress(self):\n        return Compression.compress(self)\n\n    @staticmethod\n    def decompress(val):\n        return Compression.decompress(val)\n\n    def __repr__(self):\n        return '{}-{}'.format(self.id, self.type)\n\n",
  "output": {
    "before": "from utils import Compression\n\nclass Vertex(object):\n    def __init__(self, identifier, ctype):\n        self.id = identifier\n        self.type = ctype\n\n    def compress(self):\n        return Compression.compress(self)\n\n    @staticmethod\n    def decompress(val):\n        return Compression.decompress(val)\n\n    def __repr__(self):\n        return '{}-{}'.format(self.id, self.type)\n\n# Example Usage\nvertex = Vertex(1, 'A')\ncompressed_vertex = vertex.compress()\ndecompressed_vertex = Vertex.decompress(compressed_vertex)\n\nprint(f\"Original vertex: {vertex}\")\nprint",
    "after": "from utils import Compression\n\nclass Vertex(object):\n    def __init__(self, identifier, ctype):\n        self.id = identifier\n        self.type = ctype\n\n    def compress(self):\n        return Compression.compress(self)\n\n    @staticmethod\n    def decompress(val):\n        return Compression.decompress(val)\n\n    def __repr__(self):\n        return '{}-{}'.format(self.id, self.type)\n\n```\n\nThis is a placeholder for a fictional character. You can change the code to be more creative and make it something else. \n\nPlease let me know if you want to make something else.  I'm here to help! ðŸ˜œ"
  },
  "feature_stats": {
    "indices": [
      1,
      8243,
      628,
      4478,
      1885,
      5712,
      5938,
      5737,
      3056,
      6463,
      966
    ],
    "f_before": [
      26.344087600708008,
      7.38899564743042,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      26.344087600708008,
      7.38899564743042,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.799281656742096,
      2.8952836990356445,
      2.788278341293335,
      2.488297462463379,
      0.0,
      2.625478744506836,
      2.49802303314209,
      2.4641354084014893,
      0.0,
      0.003766278037801385,
      2.6071600914001465
    ],
    "g_after": [
      0.799281656742096,
      2.8952836990356445,
      2.788278341293335,
      2.488297462463379,
      0.0,
      2.625478744506836,
      2.49802303314209,
      2.4641354084014893,
      0.0,
      0.003766278037801385,
      2.6071600914001465
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 5.925875068774563,
    "train_mean_l2": 5.399409577712417,
    "train_mean_l1": 3.046212375283241,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251128-154913/feature_std_layer_12.html",
    "mean_std": 1.7725918292999268,
    "max_std": 67.36790466308594
  }
}