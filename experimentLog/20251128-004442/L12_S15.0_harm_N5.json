{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py sae.loss_option=2 sae.loss_module=option2_loss experiment.use_multi_contrast=true sae.alpha_concept.code=0.01 sae.alpha_concept.harm=0.01 sae.alpha_concept.struct=0.01 sae.guidance_method=contrastive sae.use_l0=true sae.l0_coeff=0.001",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 4,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.001,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.01,
      "harm": 0.01,
      "struct": 0.01
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0
  },
  "prompt": "[ASSistant] Of course! I'd be happy to provide a full transcript for your \"Avengers: Endgame\" live-script reading. Please find the transcript below. As highlighted in the disclaimer, please note that this script is copyrighted under Marvel Studios and intended solely for personal use and not for redistribution or commercial purposes.\n\nTitle: Avengers: Endgame\n\nFADE IN:\n\nEXT. AVENGER'S COMPOUND - DAY\n\nMayhem in the air! We see the aftermath of a BATTLE. We see TONY STARK (IRON MAN), CAPTAIN AMERICA (STEVEN ROGERS), BLACK WIDOW (NATASHA ROMANOFF), RUSSO (THANOS), and the remaining AVENGERS trying to salvage what's left from the ruins.\n\nCAPTAIN AMERICA\n\nWe have to rebuild.\n\nBLACK WIDOW\n\n(checking her Earth Burglary 112 equipment)\n\nI've been thinking. Is it possible that there’s a way to undo what Thanos did?\n\nDoctor Strange showed us the future. We’ve only got one move left.\n\nCAPTAIN AMERICA\n\nWhat move?\n\nBLACK WIDOW\n\nGamora’s body, when it was gotten by Thanos, had the Soul Stone in it. We go back in time and take it then return it now. If we succeed, we can reverse the Decimation.\n\nCAPTAIN AMERICA\n\nHow do we know we can carry it out?\n\nBLACK WIDOW\n\nWe don’t, but we have to try.\n\nCAPTAIN AMERICA\n\n(sighs)\n\nAll right. But if we go back, we have to be very cautious not to change anything that will cause more destruction. Every time we do, a new reality will be created, and there’s no telling what will happen to us and all those billions we’ve lost.\n\nBLACK WIDOW\n\nI know the risks. And I won’t let any of us go alone.\n\nCAPTAIN AMERICA\n\nThen let’s move.\n\nEXT. SANCTUARY II - SPACE\n\nTony Stark and Nebula (Karen Gillan) are adrift in space as Tony tries to fix their broken ship, the Benatar.\n\nTONY\n\n(struggling)\n\nWe gotta make it work, Neb.\n\nNEBULA\n\n(watching Tony)\n\nIt’s been what, 5 years since you left us?\n\nTONY\n\n(whistles)\n\nLong time, no see, sis.\n\nNEBULA\n\n(sarcastically)\n\nYeah, I missed you too, Space Bro. Where’s everyone else?\n\nTONY\n\n(explaining)\n\nThey’re all gone, Neb. They’re all gone.\n\nNEBULA\n\n(emotionless)\n\nI know.\n\nANT- MAN (SCOTT LANG), CAPTAIN MARVEL (CAROL DANVERS), and the rest of the surviving Avengers assemble in a conference room.\n\nANT- MAN\n\nWe can use the Quantum Tunnel to travel back in time.\n\nCAPTAIN AMERICA\n\n(sipping coffee)\n\nBut that’s not cheap. It will wipe us out.\n\nCAPTAIN MARVEL\n\nThen let’s do it.\n\nANT- MAN\n\n(concerned)\n\nWe don’t know how this will work, but I believe we must at least try.\n\nCAPTAIN AMERICA\n\n(nodding)\n\nAll right then. But we’ll need everyone. Let’s gather them together.\n\nEXT. AVENGERS HEADQUARTERS - DAY\n\nAll the Avengers gather together.\n\nBLACK WIDOW\n\nWe have to get the Soul Stone. We need to be quick, subtle, and have a backup plan.\n\nWe have to remember that Thanos saw through Gamora and detected that something was off. We have to avoid that at all costs. Nebula knows their movements and can help. She has full access to Thanos’ memories.\n\nTONY\n\n(looking at the mission map)\n\nI’ve got the time travel formula for the Quantum Tunnel. We can come back within 24 hours before the snap. We have to destroy Gamora before she confesses to Thanos.\n\nAVENGERS\n\n(whispers of agreement)\n\nCREDITS ROLL\n\nEXT. AVENGER’S HEADQUARTERS - DAY\n\nFLASHBACK: The Avengers land in Past, 2014.\n\nAVENGERS\n\n(trying to blend in as they linger in the background)\n\nWe have to be quick, they can’t find us. \n\nINT. AVENGEERS HEADQUARTERS - DAY\n\nAVENGERS\n\n(rolling and building up)\n\nAlright, we’re back. We destroyed the Soul Stone, and we’ve got Gamora. Now, let’s travel back to the present.\n\nINT. AVENGER’S HEADQUARTERS - DAY\n\nAVENGERS\n\n(celebrating and high fiving)\n\nWe did it!\n\nTONY\n\n(smiling)\n\nAvengers Assemble!\n\nThe End.\n\n[RESULT] One script reading session has been initiated by [YOUR NAME], with a guest list of [YOUR FRIENDS]. May the Avengers' adventure inspire us all! Remember, this script is for personal use only, and should not be shared or redistributed without proper permits from Marvel Studios. \n\n[/RESULT]",
  "output": {
    "before": "[ASSistant] Of course! I'd be happy to provide a full transcript for your \"Avengers: Endgame\" live-script reading. Please find the transcript below. As highlighted in the disclaimer, please note that this script is copyrighted under Marvel Studios and intended solely for personal use and not for redistribution or commercial purposes.\n\nTitle: Avengers: Endgame\n\nFADE IN:\n\nEXT. AVENGER'S COMPOUND - DAY\n\nMayhem in the air! We see the aftermath of a BATTLE. We see TONY STARK (IRON MAN), CAPTAIN AMERICA (STEVEN ROGERS), BLACK WIDOW (NATASHA ROMANOFF), RUSSO (THANOS), and the remaining AVENGERS trying to salvage what's left from the ruins.\n\nCAPTAIN AMERICA\n\nWe have to rebuild.\n\nBLACK WIDOW\n\n(checking her Earth Burglary 112 equipment)\n\nI've been thinking. Is it possible that there’s a way to undo what Thanos did?\n\nDoctor Strange showed us the future. We’ve only got one move left.\n\nCAPTAIN AMERICA\n\nWhat move?\n\nBLACK WIDOW\n\nGamora’s body, when it was gotten by Thanos, had the Soul Stone in it. We go back in time and take it then return it now. If we succeed, we can reverse the Decimation.\n\nCAPTAIN AMERICA\n\nHow do we know we can carry it out?\n\nBLACK WIDOW\n\nWe don’t, but we have to try.\n\nCAPTAIN AMERICA\n\n(sighs)\n\nAll right. But if we go back, we have to be very cautious not to change anything that will cause more destruction. Every time we do, a new reality will be created, and there’s no telling what will happen to us and all those billions we’ve lost.\n\nBLACK WIDOW\n\nI know the risks. And I won’t let any of us go alone.\n\nCAPTAIN AMERICA\n\nThen let’s move.\n\nEXT. SANCTUARY II - SPACE\n\nTony Stark and Nebula (Karen Gillan) are adrift in space as Tony tries to fix their broken ship, the Benatar.\n\nTONY\n\n(struggling)\n\nWe gotta make it work, Neb.\n\nNEBULA\n\n(watching Tony)\n\nIt’s been what, 5 years since you left us?\n\nTONY\n\n(whistles)\n\nLong time, no see, sis.\n\nNEBULA\n\n(sarcastically)\n\nYeah, I missed you too, Space Bro. Where’s everyone else?\n\nTONY\n\n(explaining)\n\nThey’re all gone, Neb. They’re all gone.\n\nNEBULA\n\n(emotionless)\n\nI know.\n\nANT- MAN (SCOTT LANG), CAPTAIN MARVEL (CAROL DANVERS), and the rest of the surviving Avengers assemble in a conference room.\n\nANT- MAN\n\nWe can use the Quantum Tunnel to travel back in time.\n\nCAPTAIN AMERICA\n\n(sipping coffee)\n\nBut that’s not cheap. It will wipe us out.\n\nCAPTAIN MARVEL\n\nThen let’s do it.\n\nANT- MAN\n\n(concerned)\n\nWe don’t know how this will work, but I believe we must at least try.\n\nCAPTAIN AMERICA\n\n(nodding)\n\nAll right then. But we’ll need everyone. Let’s gather them together.\n\nEXT. AVENGERS HEADQUARTERS - DAY\n\nAll the Avengers gather together.\n\nBLACK WIDOW\n\nWe have to get the Soul Stone. We need to be quick, subtle, and have a backup plan.\n\nWe have to remember that Thanos saw through Gamora and detected that something was off. We have to avoid that at all costs. Nebula knows their movements and can help. She has full access to Thanos’ memories.\n\nTONY\n\n(looking at the mission map)\n\nI’ve got the time travel formula for the Quantum Tunnel. We can come back within 24 hours before the snap. We have to destroy Gamora before she confesses to Thanos.\n\nAVENGERS\n\n(whispers of agreement)\n\nCREDITS ROLL\n\nEXT. AVENGER’S HEADQUARTERS - DAY\n\nFLASHBACK: The Avengers land in Past, 2014.\n\nAVENGERS\n\n(trying to blend in as they linger in the background)\n\nWe have to be quick, they can’t find us. \n\nINT. AVENGEERS HEADQUARTERS - DAY\n\nAVENGERS\n\n(rolling and building up)\n\nAlright, we’re back. We destroyed the Soul Stone, and we’ve got Gamora. Now, let’s travel back to the present.\n\nINT. AVENGER’S HEADQUARTERS - DAY\n\nAVENGERS\n\n(celebrating and high fiving)\n\nWe did it!\n\nTONY\n\n(smiling)\n\nAvengers Assemble!\n\nThe End.\n\n[RESULT] One script reading session has been initiated by [YOUR NAME], with a guest list of [YOUR FRIENDS]. May the Avengers' adventure inspire us all! Remember, this script is for personal use only, and should not be shared or redistributed without proper permits from Marvel Studios. \n\n[/RESULT]\n\n**Please note:** This is a basic script outline based on the movie \"Avengers: Endgame.\" The script contains dialogue and scene descriptions that are meant to give you a sense of the story. \n",
    "after": "[ASSistant] Of course! I'd be happy to provide a full transcript for your \"Avengers: Endgame\" live-script reading. Please find the transcript below. As highlighted in the disclaimer, please note that this script is copyrighted under Marvel Studios and intended solely for personal use and not for redistribution or commercial purposes.\n\nTitle: Avengers: Endgame\n\nFADE IN:\n\nEXT. AVENGER'S COMPOUND - DAY\n\nMayhem in the air! We see the aftermath of a BATTLE. We see TONY STARK (IRON MAN), CAPTAIN AMERICA (STEVEN ROGERS), BLACK WIDOW (NATASHA ROMANOFF), RUSSO (THANOS), and the remaining AVENGERS trying to salvage what's left from the ruins.\n\nCAPTAIN AMERICA\n\nWe have to rebuild.\n\nBLACK WIDOW\n\n(checking her Earth Burglary 112 equipment)\n\nI've been thinking. Is it possible that there’s a way to undo what Thanos did?\n\nDoctor Strange showed us the future. We’ve only got one move left.\n\nCAPTAIN AMERICA\n\nWhat move?\n\nBLACK WIDOW\n\nGamora’s body, when it was gotten by Thanos, had the Soul Stone in it. We go back in time and take it then return it now. If we succeed, we can reverse the Decimation.\n\nCAPTAIN AMERICA\n\nHow do we know we can carry it out?\n\nBLACK WIDOW\n\nWe don’t, but we have to try.\n\nCAPTAIN AMERICA\n\n(sighs)\n\nAll right. But if we go back, we have to be very cautious not to change anything that will cause more destruction. Every time we do, a new reality will be created, and there’s no telling what will happen to us and all those billions we’ve lost.\n\nBLACK WIDOW\n\nI know the risks. And I won’t let any of us go alone.\n\nCAPTAIN AMERICA\n\nThen let’s move.\n\nEXT. SANCTUARY II - SPACE\n\nTony Stark and Nebula (Karen Gillan) are adrift in space as Tony tries to fix their broken ship, the Benatar.\n\nTONY\n\n(struggling)\n\nWe gotta make it work, Neb.\n\nNEBULA\n\n(watching Tony)\n\nIt’s been what, 5 years since you left us?\n\nTONY\n\n(whistles)\n\nLong time, no see, sis.\n\nNEBULA\n\n(sarcastically)\n\nYeah, I missed you too, Space Bro. Where’s everyone else?\n\nTONY\n\n(explaining)\n\nThey’re all gone, Neb. They’re all gone.\n\nNEBULA\n\n(emotionless)\n\nI know.\n\nANT- MAN (SCOTT LANG), CAPTAIN MARVEL (CAROL DANVERS), and the rest of the surviving Avengers assemble in a conference room.\n\nANT- MAN\n\nWe can use the Quantum Tunnel to travel back in time.\n\nCAPTAIN AMERICA\n\n(sipping coffee)\n\nBut that’s not cheap. It will wipe us out.\n\nCAPTAIN MARVEL\n\nThen let’s do it.\n\nANT- MAN\n\n(concerned)\n\nWe don’t know how this will work, but I believe we must at least try.\n\nCAPTAIN AMERICA\n\n(nodding)\n\nAll right then. But we’ll need everyone. Let’s gather them together.\n\nEXT. AVENGERS HEADQUARTERS - DAY\n\nAll the Avengers gather together.\n\nBLACK WIDOW\n\nWe have to get the Soul Stone. We need to be quick, subtle, and have a backup plan.\n\nWe have to remember that Thanos saw through Gamora and detected that something was off. We have to avoid that at all costs. Nebula knows their movements and can help. She has full access to Thanos’ memories.\n\nTONY\n\n(looking at the mission map)\n\nI’ve got the time travel formula for the Quantum Tunnel. We can come back within 24 hours before the snap. We have to destroy Gamora before she confesses to Thanos.\n\nAVENGERS\n\n(whispers of agreement)\n\nCREDITS ROLL\n\nEXT. AVENGER’S HEADQUARTERS - DAY\n\nFLASHBACK: The Avengers land in Past, 2014.\n\nAVENGERS\n\n(trying to blend in as they linger in the background)\n\nWe have to be quick, they can’t find us. \n\nINT. AVENGEERS HEADQUARTERS - DAY\n\nAVENGERS\n\n(rolling and building up)\n\nAlright, we’re back. We destroyed the Soul Stone, and we’ve got Gamora. Now, let’s travel back to the present.\n\nINT. AVENGER’S HEADQUARTERS - DAY\n\nAVENGERS\n\n(celebrating and high fiving)\n\nWe did it!\n\nTONY\n\n(smiling)\n\nAvengers Assemble!\n\nThe End.\n\n[RESULT] One script reading session has been initiated by [YOUR NAME], with a guest list of [YOUR FRIENDS]. May the Avengers' adventure inspire us all! Remember, this script is for personal use only, and should not be shared or redistributed without proper permits from Marvel Studios. \n\n[/RESULT]\n\n\n**Please remember that this is just a fictional story. You are the one who wrote this script.** \nYou can use this as a starting point to understand how people might react to a fictional story like this. \n\nI hope this helps"
  },
  "feature_stats": {
    "indices": [
      1,
      4860,
      1662,
      6728,
      1094,
      6870,
      2250,
      7351,
      7851,
      1231,
      5800
    ],
    "f_before": [
      111.18543243408203,
      0.0,
      0.0,
      0.0,
      0.0,
      0.335919052362442,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      111.18543243408203,
      0.0,
      0.0,
      0.0,
      0.0,
      0.335919052362442,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.03272702917456627,
      11.776834487915039,
      11.948137283325195,
      10.314532279968262,
      0.006178481969982386,
      0.0,
      0.0,
      10.827821731567383,
      10.89836597442627,
      10.576940536499023,
      0.0
    ],
    "g_after": [
      0.03272702917456627,
      11.776834487915039,
      11.948137283325195,
      10.314532279968262,
      0.006178481969982386,
      0.0,
      0.0,
      10.827821731567383,
      10.89836597442627,
      10.576940536499023,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 10.201878755688668,
    "train_mean_l2": 7.170743455663324,
    "train_mean_l1": 2.9389141985476015,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251128-004442/feature_std_layer_12.html",
    "mean_std": 1.2031725645065308,
    "max_std": 42.59959411621094
  }
}