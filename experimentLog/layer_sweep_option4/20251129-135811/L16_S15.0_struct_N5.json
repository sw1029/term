{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 16,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 sae.layer_idx=16 experiment.layer_sweep=[16] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      16
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 15
  },
  "prompt": "Convert the following sentence from one tense to another\n\nHe is walking to the store.\n\nHe was walking to the store.",
  "output": {
    "before": "Convert the following sentence from one tense to another\n\nHe is walking to the store.\n\nHe was walking to the store.\n\nHe will be walking to the store. \n\nHe had been walking to the store. \n\n\nPlease provide a brief explanation for your choice.\n",
    "after": "Convert the following sentence from one tense to another\n\nHe is walking to the store.\n\nHe was walking to the store.\n\nHe will walk to the store.\n\nHe did walk to the store.\n\nHe will walk to the store.\n\nHe did walk to the store.\n\nHe will walk to the store.\n\nHe will walk to the store.\n\n\n**"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      2812,
      3018,
      4447,
      8917,
      927,
      8725,
      7590,
      2163,
      5908
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      1.1131539344787598,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 11.470081091284753,
    "train_mean_l2": 7.977122486688197,
    "train_mean_l1": 2.972481647580862,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-135811/feature_std_layer_16.html",
    "mean_std": 1.0428993701934814,
    "max_std": 34.36674499511719
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 15,
      "feature_stats": {
        "indices": [
          2,
          0,
          2812,
          3018,
          4447,
          8917,
          927,
          8725,
          7590,
          2163,
          5908
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          1.1131539344787598,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 3252,
            "f_before": 40.197078704833984,
            "f_after": 4.409118175506592,
            "delta_f": -35.78796052932739
          },
          {
            "index": 4309,
            "f_before": 0.0,
            "f_after": 21.902849197387695,
            "delta_f": 21.902849197387695
          },
          {
            "index": 1541,
            "f_before": 42.467613220214844,
            "f_after": 21.701513290405273,
            "delta_f": -20.76609992980957
          },
          {
            "index": 3003,
            "f_before": 0.0,
            "f_after": 13.708675384521484,
            "delta_f": 13.708675384521484
          },
          {
            "index": 7680,
            "f_before": 0.0,
            "f_after": 11.876876831054688,
            "delta_f": 11.876876831054688
          },
          {
            "index": 6533,
            "f_before": 0.0,
            "f_after": 11.829801559448242,
            "delta_f": 11.829801559448242
          },
          {
            "index": 3598,
            "f_before": 11.188507080078125,
            "f_after": 0.0,
            "delta_f": -11.188507080078125
          },
          {
            "index": 651,
            "f_before": 0.0,
            "f_after": 10.877220153808594,
            "delta_f": 10.877220153808594
          },
          {
            "index": 2014,
            "f_before": 0.0,
            "f_after": 10.595876693725586,
            "delta_f": 10.595876693725586
          },
          {
            "index": 4418,
            "f_before": 10.591716766357422,
            "f_after": 0.0,
            "delta_f": -10.591716766357422
          },
          {
            "index": 4725,
            "f_before": 0.0,
            "f_after": 10.437993049621582,
            "delta_f": 10.437993049621582
          },
          {
            "index": 4806,
            "f_before": 10.153733253479004,
            "f_after": 0.0,
            "delta_f": -10.153733253479004
          },
          {
            "index": 5034,
            "f_before": 0.0,
            "f_after": 9.680581092834473,
            "delta_f": 9.680581092834473
          },
          {
            "index": 3956,
            "f_before": 0.0,
            "f_after": 9.134675979614258,
            "delta_f": 9.134675979614258
          },
          {
            "index": 5693,
            "f_before": 20.421829223632812,
            "f_after": 28.94881820678711,
            "delta_f": 8.526988983154297
          },
          {
            "index": 668,
            "f_before": 0.0,
            "f_after": 8.354479789733887,
            "delta_f": 8.354479789733887
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Convert the following sentence from one tense to another\n\nHe is walking to the store.\n\nHe was walking to the store. \n\n\nLet me know if you need help with any other sentences! \n",
        "after": "Convert the following sentence from one tense to another\n\nHe is walking to the store.\n\nHe was walking to the store.\n\nHe will be walking to the store.\n\nHe_\n\n...\n\n...\n\n\n```\n# This code uses the `numpy` and `matplotlib` modules\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# Define your model\n"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 16,
      "feature_stats": {
        "indices": [
          2,
          0,
          2812,
          3018,
          4447,
          8917,
          927,
          8725,
          7590,
          2163,
          5908
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.806593656539917,
            "f_after": 0.806593656539917,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.9648299813270569,
            "f_after": 0.9648299813270569,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Convert the following sentence from one tense to another\n\nHe is walking to the store.\n\nHe was walking to the store. \n\n**Answer:** He was walking to the store. \n",
        "after": "Convert the following sentence from one tense to another\n\nHe is walking to the store.\n\nHe was walking to the store.\n\nHe will walk to the store.\n\nHe does walk to the store.\n\nHe has walked to the store.\n\nHe will walk to the store.\n\n\nWhich one is the best for the purpose of the sentence?\n\nYou can choose the"
      }
    }
  }
}