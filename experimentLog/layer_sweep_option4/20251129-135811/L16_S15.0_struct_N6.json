{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 16,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 sae.layer_idx=16 experiment.layer_sweep=[16] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      16
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 15
  },
  "prompt": "Come up with an alternative title for the book: The Cat in the Hat.\n\nThe Mischievous Feline in the Hat",
  "output": {
    "before": "Come up with an alternative title for the book: The Cat in the Hat.\n\nThe Mischievous Feline in the Hat.\nThe Cat Who Brought Chaos to the House.\nThe Curious Case of the Cat in the Hat.\nA Day with the Cat in the Hat.\nThe Cat in the Hat's Big Adventure.\n\nWhich title do you think is",
    "after": "Come up with an alternative title for the book: The Cat in the Hat.\n\nThe Mischievous Feline in the Hat\n\nThe Cat with the Red Hat\n\nThe Cat in the Hat and Friends\n\nThe Cat in theHat: A Book for Young Readers\n\nThe Cat in theHat: When to Call the Doctor\n\nThe Cat in theHat: A Recipe for Chaos"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      2812,
      3018,
      4447,
      8917,
      927,
      8725,
      7590,
      2163,
      5908
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.030028745532035828,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 11.470081091284753,
    "train_mean_l2": 7.977122486688197,
    "train_mean_l1": 2.972481647580862,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-135811/feature_std_layer_16.html",
    "mean_std": 1.0428993701934814,
    "max_std": 34.36674499511719
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 15,
      "feature_stats": {
        "indices": [
          2,
          0,
          2812,
          3018,
          4447,
          8917,
          927,
          8725,
          7590,
          2163,
          5908
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.030028745532035828,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 3252,
            "f_before": 41.26443862915039,
            "f_after": 5.829990386962891,
            "delta_f": -35.4344482421875
          },
          {
            "index": 4309,
            "f_before": 3.912196159362793,
            "f_after": 27.970197677612305,
            "delta_f": 24.05800151824951
          },
          {
            "index": 1541,
            "f_before": 42.646934509277344,
            "f_after": 20.568471908569336,
            "delta_f": -22.078462600708008
          },
          {
            "index": 3598,
            "f_before": 20.83868980407715,
            "f_after": 0.0,
            "delta_f": -20.83868980407715
          },
          {
            "index": 4806,
            "f_before": 14.173473358154297,
            "f_after": 0.0,
            "delta_f": -14.173473358154297
          },
          {
            "index": 3003,
            "f_before": 0.0,
            "f_after": 14.16686725616455,
            "delta_f": 14.16686725616455
          },
          {
            "index": 7680,
            "f_before": 0.0,
            "f_after": 12.20333480834961,
            "delta_f": 12.20333480834961
          },
          {
            "index": 651,
            "f_before": 0.0,
            "f_after": 11.480819702148438,
            "delta_f": 11.480819702148438
          },
          {
            "index": 2014,
            "f_before": 0.0,
            "f_after": 11.30593490600586,
            "delta_f": 11.30593490600586
          },
          {
            "index": 5034,
            "f_before": 0.0,
            "f_after": 11.288865089416504,
            "delta_f": 11.288865089416504
          },
          {
            "index": 4418,
            "f_before": 11.177064895629883,
            "f_after": 0.0,
            "delta_f": -11.177064895629883
          },
          {
            "index": 6533,
            "f_before": 0.0,
            "f_after": 10.406003952026367,
            "delta_f": 10.406003952026367
          },
          {
            "index": 4725,
            "f_before": 0.0,
            "f_after": 9.528058052062988,
            "delta_f": 9.528058052062988
          },
          {
            "index": 3956,
            "f_before": 0.0,
            "f_after": 9.09948444366455,
            "delta_f": 9.09948444366455
          },
          {
            "index": 668,
            "f_before": 0.0,
            "f_after": 8.945467948913574,
            "delta_f": 8.945467948913574
          },
          {
            "index": 8229,
            "f_before": 0.0,
            "f_after": 8.913385391235352,
            "delta_f": 8.913385391235352
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Come up with an alternative title for the book: The Cat in the Hat.\n\nThe Mischievous Feline in the Hat\n\nThe Cat with a Hat\n\nThe Adventures of the Cat in the Hat\n\nThe Cat's Tail of Chaos\n\nThe Cat in the Hat's Wild Ride \n\n**Please choose the title that best reflects the spirit and essence of the original",
        "after": "Come up with an alternative title for the book: The Cat in the Hat.\n\nThe Mischievous Feline in the Hat.\nThe Cat in the Hat: Advanced.\nThe Cat in the Hat: Optimization.\nThe Cat in Hat: Initialization.\nThe Cat in Hat: Core.\nThe Cat in Hat: Runtime.\nTheCat in Hat: Core"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 16,
      "feature_stats": {
        "indices": [
          2,
          0,
          2812,
          3018,
          4447,
          8917,
          927,
          8725,
          7590,
          2163,
          5908
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.07099581509828568,
            "f_after": 0.07099581509828568,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 1.0814191102981567,
            "f_after": 1.0814191102981567,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Come up with an alternative title for the book: The Cat in the Hat.\n\nThe Mischievous Feline in the Hat\n\nThe Curious Cat and the Hat\n\nThe Adventures of the Cat in the Hat\n\nA Cat's Guide to Chaos\n\nA Hatful of Mayhem\n\nA Day with the Cat in the Hat\n\nLet me know what you think of these titles!",
        "after": "Come up with an alternative title for the book: The Cat in the Hat.\n\nThe Mischievous Feline in the Hat\n\nThe Hat for Cats\n\nThe Cat's Hat: A Tale of Fun\n\nThe Cat in the Hat: When to Play with Fire\n\nThe Cat in the Hat: A Cat's Guide to Fun\n\n**OR**\n\n**For more"
      }
    }
  }
}