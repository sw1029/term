{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 20,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 sae.layer_idx=20 experiment.layer_sweep=[20] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      20
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 19
  },
  "prompt": "Choose the word that has the correct synonym for the highlighted word.\n\nThe teacher taught the class about ____ of the earth\nA. crust\nB. solstice\nC. core\nD. magma\n\nA. crust",
  "output": {
    "before": "Choose the word that has the correct synonym for the highlighted word.\n\nThe teacher taught the class about ____ of the earth\nA. crust\nB. solstice\nC. core\nD. magma\n\nA. crust\nB. solstice\nC. core\nD. magma\n\n**Correct Answer:** A. crust\n\n**Explanation:**\n\n* **Crust** is the outermost solid layer of the Earth. \n\nThe other options are incorrect because:\n\n* **",
    "after": "Choose the word that has the correct synonym for the highlighted word.\n\nThe teacher taught the class about ____ of the earth\nA. crust\nB. solstice\nC. core\nD. magma\n\nA. crust, B. solstice, and C. core are all related to the earth. \n\nA. crust is the correct answer. \n\n**Explanation:**\n\n* **Crust** is the outer layer of the Earth, which is what the teacher is"
  },
  "feature_stats": {
    "indices": [
      1,
      0,
      3530,
      3367,
      4042,
      8256,
      8181,
      5947,
      8502,
      5746,
      6280
    ],
    "f_before": [
      0.0,
      0.0,
      24.160097122192383,
      143.24691772460938,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      53.400814056396484,
      0.0,
      46.15727615356445,
      165.33749389648438,
      4.190515518188477,
      0.0,
      0.4656515419483185,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 26.672479647785426,
    "train_mean_l2": 20.70426560740173,
    "train_mean_l1": 5.5165470574200155,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-142202/feature_std_layer_20.html",
    "mean_std": 1.4509227275848389,
    "max_std": 35.97808074951172
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 19,
      "feature_stats": {
        "indices": [
          1,
          0,
          3530,
          3367,
          4042,
          8256,
          8181,
          5947,
          8502,
          5746,
          6280
        ],
        "f_before": [
          0.0,
          0.0,
          24.160097122192383,
          143.24691772460938,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          53.400814056396484,
          0.0,
          46.15727615356445,
          165.33749389648438,
          4.190515518188477,
          0.0,
          0.4656515419483185,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 53.400814056396484,
            "delta_f": 53.400814056396484
          },
          {
            "index": 1433,
            "f_before": 0.0,
            "f_after": 23.024389266967773,
            "delta_f": 23.024389266967773
          },
          {
            "index": 8313,
            "f_before": 0.0,
            "f_after": 22.346088409423828,
            "delta_f": 22.346088409423828
          },
          {
            "index": 3367,
            "f_before": 143.24691772460938,
            "f_after": 165.33749389648438,
            "delta_f": 22.090576171875
          },
          {
            "index": 3530,
            "f_before": 24.160097122192383,
            "f_after": 46.15727615356445,
            "delta_f": 21.99717903137207
          },
          {
            "index": 3705,
            "f_before": 78.63538360595703,
            "f_after": 97.83641052246094,
            "delta_f": 19.201026916503906
          },
          {
            "index": 2501,
            "f_before": 17.578128814697266,
            "f_after": 33.19060516357422,
            "delta_f": 15.612476348876953
          },
          {
            "index": 5831,
            "f_before": 0.0,
            "f_after": 15.278546333312988,
            "delta_f": 15.278546333312988
          },
          {
            "index": 7725,
            "f_before": 0.0,
            "f_after": 15.024116516113281,
            "delta_f": 15.024116516113281
          },
          {
            "index": 3178,
            "f_before": 0.0,
            "f_after": 13.584171295166016,
            "delta_f": 13.584171295166016
          },
          {
            "index": 3681,
            "f_before": 8.044698715209961,
            "f_after": 21.1439151763916,
            "delta_f": 13.09921646118164
          },
          {
            "index": 7496,
            "f_before": 0.0,
            "f_after": 13.075420379638672,
            "delta_f": 13.075420379638672
          },
          {
            "index": 1052,
            "f_before": 0.0,
            "f_after": 13.071516036987305,
            "delta_f": 13.071516036987305
          },
          {
            "index": 6476,
            "f_before": 0.0,
            "f_after": 12.259690284729004,
            "delta_f": 12.259690284729004
          },
          {
            "index": 3583,
            "f_before": 1.0531480312347412,
            "f_after": 12.423068046569824,
            "delta_f": 11.369920015335083
          },
          {
            "index": 1360,
            "f_before": 0.0,
            "f_after": 11.308141708374023,
            "delta_f": 11.308141708374023
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Choose the word that has the correct synonym for the highlighted word.\n\nThe teacher taught the class about ____ of the earth\nA. crust\nB. solstice\nC. core\nD. magma\n\nA. crust\nB. solstice\nC. core\nD. magma\n\nThe answer is **A. crust**.\n\n**Explanation:**\n\n* **Crust** refers to the outermost layer of the Earth. \n* **Solstice** is a specific",
        "after": "Choose the word that has the correct synonym for the highlighted word.\n\nThe teacher taught the class about ____ of the earth\nA. crust\nB. solstice\nC. core\nD. magma\n\nA. crust is the correct answer because it is the physical layer of the earth that is the closest to the surface. \n\n\nLet me know if you want to try another one! \n"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 20,
      "feature_stats": {
        "indices": [
          1,
          0,
          3530,
          3367,
          4042,
          8256,
          8181,
          5947,
          8502,
          5746,
          6280
        ],
        "f_before": [
          0.0,
          0.0,
          24.160097122192383,
          143.24691772460938,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          24.160097122192383,
          143.24691772460938,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.8040767312049866,
            "f_after": 0.8040767312049866,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Choose the word that has the correct synonym for the highlighted word.\n\nThe teacher taught the class about ____ of the earth\nA. crust\nB. solstice\nC. core\nD. magma\n\nA. crust \nB. solstice \nC. core \nD. magma \n\nThe answer is **A. crust**. \n\nHere's why:\n\n* **Crust** refers to the outermost layer of the Earth. \n* **",
        "after": "Choose the word that has the correct synonym for the highlighted word.\n\nThe teacher taught the class about ____ of the earth\nA. crust\nB. solstice\nC. core\nD. magma\n\nA. crust is the correct answer.\n\nHere's why:\n\n* **Crust** refers to the outermost layer of the earth, like a shell. \n* **Solstice** is a point in the year when the sun is at its highest"
      }
    }
  }
}