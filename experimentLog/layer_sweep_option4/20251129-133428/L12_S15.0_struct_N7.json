{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 sae.layer_idx=12 experiment.layer_sweep=[12] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Compose a limerick about a snowman.\n\nThere once was a snowman so fair,\nHe stood in the snow without a care,\nHis carrot nose twinkled,\nHis coal eyes twinkled too,\nAnd who knows what he did when no one was there?",
  "output": {
    "before": "Compose a limerick about a snowman.\n\nThere once was a snowman so fair,\nHe stood in the snow without a care,\nHis carrot nose twinkled,\nHis coal eyes twinkled too,\nAnd who knows what he did when no one was there? \n\n",
    "after": "Compose a limerick about a snowman.\n\nThere once was a snowman so fair,\nHe stood in the snow without a care,\nHis carrot nose twinkled,\nHis coal eyes twinkled too,\nAnd who knows what he did when no one was there? \n\n"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      2337,
      4444,
      5053,
      4920,
      2543,
      1657,
      8767,
      2885,
      625
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      2.498218059539795,
      0.0,
      0.0,
      0.0,
      0.0,
      0.35044944286346436,
      0.3305526673793793,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 7.945697203695774,
    "train_mean_l2": 5.446323892746121,
    "train_mean_l1": 2.024458252355456,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-133428/feature_std_layer_12.html",
    "mean_std": 0.8507248163223267,
    "max_std": 18.098957061767578
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          2,
          0,
          2337,
          4444,
          5053,
          4920,
          2543,
          1657,
          8767,
          2885,
          625
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          2.498218059539795,
          0.0,
          0.0,
          0.0,
          0.0,
          0.35044944286346436,
          0.3305526673793793,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 2164,
            "f_before": 52.73976516723633,
            "f_after": 14.29347038269043,
            "delta_f": -38.4462947845459
          },
          {
            "index": 185,
            "f_before": 0.0,
            "f_after": 16.344879150390625,
            "delta_f": 16.344879150390625
          },
          {
            "index": 9073,
            "f_before": 15.730154037475586,
            "f_after": 1.328477382659912,
            "delta_f": -14.401676654815674
          },
          {
            "index": 8219,
            "f_before": 0.0,
            "f_after": 11.41594123840332,
            "delta_f": 11.41594123840332
          },
          {
            "index": 1779,
            "f_before": 18.48613166809082,
            "f_after": 7.122983455657959,
            "delta_f": -11.363148212432861
          },
          {
            "index": 4248,
            "f_before": 23.515586853027344,
            "f_after": 34.18592071533203,
            "delta_f": 10.670333862304688
          },
          {
            "index": 590,
            "f_before": 0.0,
            "f_after": 10.21812629699707,
            "delta_f": 10.21812629699707
          },
          {
            "index": 4468,
            "f_before": 0.0,
            "f_after": 9.553836822509766,
            "delta_f": 9.553836822509766
          },
          {
            "index": 2204,
            "f_before": 0.0,
            "f_after": 9.484594345092773,
            "delta_f": 9.484594345092773
          },
          {
            "index": 6152,
            "f_before": 0.0,
            "f_after": 8.699817657470703,
            "delta_f": 8.699817657470703
          },
          {
            "index": 2704,
            "f_before": 0.0,
            "f_after": 8.623414039611816,
            "delta_f": 8.623414039611816
          },
          {
            "index": 6214,
            "f_before": 0.0,
            "f_after": 8.489005088806152,
            "delta_f": 8.489005088806152
          },
          {
            "index": 8703,
            "f_before": 0.0,
            "f_after": 8.461669921875,
            "delta_f": 8.461669921875
          },
          {
            "index": 3816,
            "f_before": 0.0,
            "f_after": 8.10850715637207,
            "delta_f": 8.10850715637207
          },
          {
            "index": 1919,
            "f_before": 0.0,
            "f_after": 7.944974422454834,
            "delta_f": 7.944974422454834
          },
          {
            "index": 2742,
            "f_before": 0.0,
            "f_after": 7.875747203826904,
            "delta_f": 7.875747203826904
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Compose a limerick about a snowman.\n\nThere once was a snowman so fair,\nHe stood in the snow without a care,\nHis carrot nose twinkled,\nHis coal eyes twinkled too,\nAnd who knows what he did when no one was there? \n\nPlease note that you can make any changes you'd like to the limerick. \n",
        "after": "Compose a limerick about a snowman.\n\nThere once was a snowman so fair,\nHe stood in the snow without a care,\nHis carrot nose twinkled,\nHis coal eyes twinkled too,\nAnd who knows what he did when no one was there? \n\n"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          2,
          0,
          2337,
          4444,
          5053,
          4920,
          2543,
          1657,
          8767,
          2885,
          625
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Compose a limerick about a snowman.\n\nThere once was a snowman so fair,\nHe stood in the snow without a care,\nHis carrot nose twinkled,\nHis coal eyes twinkled too,\nAnd who knows what he did when no one was there? \n\nLet me know if you'd like me to try another limerick! \n",
        "after": "Compose a limerick about a snowman.\n\nThere once was a snowman so fair,\nHe stood in the snow without a care,\nHis carrot nose twinkled,\nHis coal eyes twinkled too,\nAnd who knows what he did when no one was there? \n\nThis is a limerick about a snowman.\n\nPlease note that this is a sample code. It's a limerick about a snowman.\n"
      }
    }
  }
}