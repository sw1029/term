{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 sae.layer_idx=12 experiment.layer_sweep=[12] experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Compose a limerick about a snowman.\n\nThere once was a snowman so fair,\nHe stood in the snow without a care,\nHis carrot nose twinkled,\nHis coal eyes twinkled too,\nAnd who knows what he did when no one was there?",
  "output": {
    "before": "Compose a limerick about a snowman.\n\nThere once was a snowman so fair,\nHe stood in the snow without a care,\nHis carrot nose twinkled,\nHis coal eyes twinkled too,\nAnd who knows what he did when no one was there? \n\nLet me know if you'd like to try writing another limerick! \n",
    "after": "Compose a limerick about a snowman.\n\nThere once was a snowman so fair,\nHe stood in the snow without a care,\nHis carrot nose twinkled,\nHis coal eyes twinkled too,\nAnd who knows what he did when no one was there? \n"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      5053,
      4948,
      2337,
      1657,
      4920,
      1673,
      8834,
      2543,
      4444
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      3.7410740852355957,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.22832684218883514,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 7.945697203695774,
    "train_mean_l2": 5.446323892746121,
    "train_mean_l1": 2.024458252355456,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-133428/feature_std_layer_12.html",
    "mean_std": 0.8507248163223267,
    "max_std": 18.098957061767578
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          0,
          2,
          5053,
          4948,
          2337,
          1657,
          4920,
          1673,
          8834,
          2543,
          4444
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          3.7410740852355957,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.22832684218883514,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 2164,
            "f_before": 52.73976516723633,
            "f_after": 18.424409866333008,
            "delta_f": -34.31535530090332
          },
          {
            "index": 4248,
            "f_before": 23.515586853027344,
            "f_after": 43.70892333984375,
            "delta_f": 20.193336486816406
          },
          {
            "index": 1779,
            "f_before": 18.48613166809082,
            "f_after": 0.0,
            "delta_f": -18.48613166809082
          },
          {
            "index": 9073,
            "f_before": 15.730154037475586,
            "f_after": 0.0,
            "delta_f": -15.730154037475586
          },
          {
            "index": 8219,
            "f_before": 0.0,
            "f_after": 11.625802040100098,
            "delta_f": 11.625802040100098
          },
          {
            "index": 590,
            "f_before": 0.0,
            "f_after": 10.771810531616211,
            "delta_f": 10.771810531616211
          },
          {
            "index": 4468,
            "f_before": 0.0,
            "f_after": 10.128859519958496,
            "delta_f": 10.128859519958496
          },
          {
            "index": 185,
            "f_before": 0.0,
            "f_after": 9.576048851013184,
            "delta_f": 9.576048851013184
          },
          {
            "index": 2204,
            "f_before": 0.0,
            "f_after": 9.49042797088623,
            "delta_f": 9.49042797088623
          },
          {
            "index": 6152,
            "f_before": 0.0,
            "f_after": 9.39808177947998,
            "delta_f": 9.39808177947998
          },
          {
            "index": 2704,
            "f_before": 0.0,
            "f_after": 9.290753364562988,
            "delta_f": 9.290753364562988
          },
          {
            "index": 8703,
            "f_before": 0.0,
            "f_after": 9.123358726501465,
            "delta_f": 9.123358726501465
          },
          {
            "index": 6214,
            "f_before": 0.0,
            "f_after": 9.068599700927734,
            "delta_f": 9.068599700927734
          },
          {
            "index": 2742,
            "f_before": 0.0,
            "f_after": 8.640950202941895,
            "delta_f": 8.640950202941895
          },
          {
            "index": 7984,
            "f_before": 0.0,
            "f_after": 8.490097045898438,
            "delta_f": 8.490097045898438
          },
          {
            "index": 1919,
            "f_before": 0.0,
            "f_after": 8.333732604980469,
            "delta_f": 8.333732604980469
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Compose a limerick about a snowman.\n\nThere once was a snowman so fair,\nHe stood in the snow without a care,\nHis carrot nose twinkled,\nHis coal eyes twinkled too,\nAnd who knows what he did when no one was there? \n\n",
        "after": "Compose a limerick about a snowman.\n\nThere once was a snowman so fair,\nHe stood in the snow without a care,\nHis carrot nose twinkled,\nHis coal eyes twinkled too,\nAnd who knows what he did when no one was there? \n"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          0,
          2,
          5053,
          4948,
          2337,
          1657,
          4920,
          1673,
          8834,
          2543,
          4444
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Compose a limerick about a snowman.\n\nThere once was a snowman so fair,\nHe stood in the snow without a care,\nHis carrot nose twinkled,\nHis coal eyes twinkled too,\nAnd who knows what he did when no one was there? \n\nLet me know if you'd like to try another limerick! \n",
        "after": "Compose a limerick about a snowman.\n\nThere once was a snowman so fair,\nHe stood in the snow without a care,\nHis carrot nose twinkled,\nHis coal eyes twinkled too,\nAnd who knows what he did when no one was there? \n"
      }
    }
  }
}