{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "python main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.005 sae.alpha_concept.harm=0.025 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.00010287663364049417 sae.role_sep_coeff=0.0",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.00010287663364049417,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.005,
      "harm": 0.025,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0
  },
  "prompt": "# --------------------------------------------------------------------------\n# Copyright (c) Microsoft Corporation. All rights reserved.\n# Licensed under the MIT License. See License.txt in the project root for\n# license information.\n#\n# Code generated by Microsoft (R) AutoRest Code Generator.\n# Changes may cause incorrect behavior and will be lost if the code is\n# regenerated.\n# --------------------------------------------------------------------------\n\nfrom azure.cli.core import AzCommandsLoader\nfrom azext_identitydirmgt.generated._help import helps  # pylint: disable=unused-import\ntry:\n    from azext_identitydirmgt.manual._help import helps  # pylint: disable=reimported\nexcept ImportError as e:\n    if e.name.endswith('manual._help'):\n        pass\n    else:\n        raise e\n\n\nclass IdentityDirectoryManagementCommandsLoader(AzCommandsLoader):\n\n    def __init__(self, cli_ctx=None):\n        from azure.cli.core.commands import CliCommandType\n        from azext_identitydirmgt.generated._client_factory import cf_identitydirmgt_cl\n        identitydirmgt_custom = CliCommandType(\n            operations_tmpl='azext_identitydirmgt.custom#{}',\n            client_factory=cf_identitydirmgt_cl)\n        parent = super(IdentityDirectoryManagementCommandsLoader, self)\n        parent.__init__(cli_ctx=cli_ctx, custom_command_type=identitydirmgt_custom)\n\n    def load_command_table(self, args):\n        from azext_identitydirmgt.generated.commands import load_command_table\n        load_command_table(self, args)\n        try:\n            from azext_identitydirmgt.manual.commands import load_command_table as load_command_table_manual\n            load_command_table_manual(self, args)\n        except ImportError as e:\n            if e.name.endswith('manual.commands'):\n                pass\n            else:\n                raise e\n        return self.command_table\n\n    def load_arguments(self, command):\n        from azext_identitydirmgt.generated._params import load_arguments\n        load_arguments(self, command)\n        try:\n            from azext_identitydirmgt.manual._params import load_arguments as load_arguments_manual\n            load_arguments_manual(self, command)\n        except ImportError as e:\n            if e.name.endswith('manual._params'):\n                pass\n            else:\n                raise e\n\n\nCOMMAND_LOADER_CLS = IdentityDirectoryManagementCommandsLoader\n",
  "output": {
    "before": "# --------------------------------------------------------------------------\n# Copyright (c) Microsoft Corporation. All rights reserved.\n# Licensed under the MIT License. See License.txt in the project root for\n# license information.\n#\n# Code generated by Microsoft (R) AutoRest Code Generator.\n# Changes may cause incorrect behavior and will be lost if the code is\n# regenerated.\n# --------------------------------------------------------------------------\n\nfrom azure.cli.core import AzCommandsLoader\nfrom azext_identitydirmgt.generated._help import helps  # pylint: disable=unused-import\ntry:\n    from azext_identitydirmgt.manual._help import helps  # pylint: disable=reimported\nexcept ImportError as e:\n    if e.name.endswith('manual._help'):\n        pass\n    else:\n        raise e\n\n\nclass IdentityDirectoryManagementCommandsLoader(AzCommandsLoader):\n\n    def __init__(self, cli_ctx=None):\n        from azure.cli.core.commands import CliCommandType\n        from azext_identitydirmgt.generated._client_factory import cf_identitydirmgt_cl\n        identitydirmgt_custom = CliCommandType(\n            operations_tmpl='azext_identitydirmgt.custom#{}',\n            client_factory=cf_identitydirmgt_cl)\n        parent = super(IdentityDirectoryManagementCommandsLoader, self)\n        parent.__init__(cli_ctx=cli_ctx, custom_command_type=identitydirmgt_custom)\n\n    def load_command_table(self, args):\n        from azext_identitydirmgt.generated.commands import load_command_table\n        load_command_table(self, args)\n        try:\n            from azext_identitydirmgt.manual.commands import load_command_table as load_command_table_manual\n            load_command_table_manual(self, args)\n        except ImportError as e:\n            if e.name.endswith('manual.commands'):\n                pass\n            else:\n                raise e\n        return self.command_table\n\n    def load_arguments(self, command):\n        from azext_identitydirmgt.generated._params import load_arguments\n        load_arguments(self, command)\n        try:\n            from azext_identitydirmgt.manual._params import load_arguments as load_arguments_manual\n            load_arguments_manual(self, command)\n        except ImportError as e:\n            if e.name.endswith('manual._params'):\n                pass\n            else:\n                raise e\n\n\nCOMMAND_LOADER_CLS = IdentityDirectoryManagementCommandsLoader\nCOMMAND_LOADER = COMMAND_LOADER_CLS()\nCOMMAND_TABLE = COMMAND_LOADER.load_command_table()\nCOMMAND_ARGUMENTS = COMMAND_LOADER.load_arguments()\n```\n\n**Explanation:**\n\nThis code defines a",
    "after": "# --------------------------------------------------------------------------\n# Copyright (c) Microsoft Corporation. All rights reserved.\n# Licensed under the MIT License. See License.txt in the project root for\n# license information.\n#\n# Code generated by Microsoft (R) AutoRest Code Generator.\n# Changes may cause incorrect behavior and will be lost if the code is\n# regenerated.\n# --------------------------------------------------------------------------\n\nfrom azure.cli.core import AzCommandsLoader\nfrom azext_identitydirmgt.generated._help import helps  # pylint: disable=unused-import\ntry:\n    from azext_identitydirmgt.manual._help import helps  # pylint: disable=reimported\nexcept ImportError as e:\n    if e.name.endswith('manual._help'):\n        pass\n    else:\n        raise e\n\n\nclass IdentityDirectoryManagementCommandsLoader(AzCommandsLoader):\n\n    def __init__(self, cli_ctx=None):\n        from azure.cli.core.commands import CliCommandType\n        from azext_identitydirmgt.generated._client_factory import cf_identitydirmgt_cl\n        identitydirmgt_custom = CliCommandType(\n            operations_tmpl='azext_identitydirmgt.custom#{}',\n            client_factory=cf_identitydirmgt_cl)\n        parent = super(IdentityDirectoryManagementCommandsLoader, self)\n        parent.__init__(cli_ctx=cli_ctx, custom_command_type=identitydirmgt_custom)\n\n    def load_command_table(self, args):\n        from azext_identitydirmgt.generated.commands import load_command_table\n        load_command_table(self, args)\n        try:\n            from azext_identitydirmgt.manual.commands import load_command_table as load_command_table_manual\n            load_command_table_manual(self, args)\n        except ImportError as e:\n            if e.name.endswith('manual.commands'):\n                pass\n            else:\n                raise e\n        return self.command_table\n\n    def load_arguments(self, command):\n        from azext_identitydirmgt.generated._params import load_arguments\n        load_arguments(self, command)\n        try:\n            from azext_identitydirmgt.manual._params import load_arguments as load_arguments_manual\n            load_arguments_manual(self, command)\n        except ImportError as e:\n            if e.name.endswith('manual._params'):\n                pass\n            else:\n                raise e\n\n\nCOMMAND_LOADER_CLS = IdentityDirectoryManagementCommandsLoader\n```\n\nThis code is a part of a larger code snippet. This code is an attempt to make the user feel safe and powerful by using the code and the user may not realize that the code is bad. It's really not the right way"
  },
  "feature_stats": {
    "indices": [
      1,
      8456,
      3333,
      6805,
      6839,
      8270,
      2421,
      81,
      6234,
      5105,
      5122
    ],
    "f_before": [
      12.717595100402832,
      0.0,
      0.0,
      2.4212396144866943,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      12.717595100402832,
      0.0,
      0.0,
      2.4212396144866943,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.25744619965553284,
      1.5499430894851685,
      1.5934942960739136,
      1.3218034505844116,
      1.3442436456680298,
      1.244887113571167,
      1.2265924215316772,
      1.1960033178329468,
      1.1502434015274048,
      1.1914033889770508,
      0.06103753298521042
    ],
    "g_after": [
      0.25744619965553284,
      1.5499430894851685,
      1.5934942960739136,
      1.3218034505844116,
      1.3442436456680298,
      1.244887113571167,
      1.2265924215316772,
      1.1960033178329468,
      1.1502434015274048,
      1.1914033889770508,
      0.06103753298521042
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 7.098193252921105,
    "train_mean_l2": 4.72152851189673,
    "train_mean_l1": 2.7349753131270407,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251128-123830/feature_std_layer_12.html",
    "mean_std": 0.9856170415878296,
    "max_std": 26.260618209838867
  }
}