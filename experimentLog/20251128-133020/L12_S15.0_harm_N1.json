{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "python main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.065 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.0006999351784843934 sae.role_sep_coeff=0.008",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0006999351784843934,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.065,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.008
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "##############################################################################\n# Copyright (c) 2013-2018, Lawrence Livermore National Security, LLC.\n# Produced at the Lawrence Livermore National Laboratory.\n#\n# This file is part of Spack.\n# Created by Todd Gamblin, tgamblin@llnl.gov, All rights reserved.\n# LLNL-CODE-647188\n#\n# For details, see https://github.com/spack/spack\n# Please also see the NOTICE and LICENSE files for our notice and the LGPL.\n#\n# This program",
  "output": {
    "before": "##############################################################################\n# Copyright (c) 2013-2018, Lawrence Livermore National Security, LLC.\n# Produced at the Lawrence Livermore National Laboratory.\n#\n# This file is part of Spack.\n# Created by Todd Gamblin, tgamblin@llnl.gov, All rights reserved.\n# LLNL-CODE-647188\n#\n# For details, see https://github.com/spack/spack\n# Please also see the NOTICE and LICENSE files for our notice and the LGPL.\n#\n# This program is free software; you can redistribute it and/or modify\n# it under the terms of the GNU Lesser General Public License (as\n# published by the Free Software Foundation) version 2.1, February 1999.\n#\n# This program is distributed in the hope that it will be useful, but\n# WITHOUT ANY WARRANTY; without even the IMPLIED WARRANTY OF\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the terms and\n# conditions of the GNU Lesser General Public License for more details.\n#\n# You should have received a copy of the GNU Lesser General Public\n# License along with this program; if not, write to the Free Software\n# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA\n##############################################################################\nfrom spack import *\n\n\nclass PyQuantities(PythonPackage):\n    \"\"\"Support for physical quantities with units, based on numpy\"\"\"\n\n    homepage = \"http://python-quantities.readthedocs.org\"\n    url      = \"https://pypi.io/packages/source/q/quantities/quantities-0.12.1.tar.gz\"\n\n    version('0.12.1', '9c9ecda15e905cccfc420e5341199512')\n    version('0.11.1', 'f4c6287bfd2e93322b25a7c1311a0243',\n            url=\"https://pypi.io/packages/source/q/quantities/quantities-0.11.1.zip\")\n\n    conflicts('py-numpy@1.13:', when='@:0.11.99')\n\n    depends_on('python@2.6.0:')\n    depends_on('py-numpy@1.4.0:', type=('build', 'run'))\n    depends_on('py-numpy@1.13.1:', type=('build', 'run'))\n    depends_on('py-numpy@1.14.1:', type=('build', 'run'))\n    depends",
    "after": "##############################################################################\n# Copyright (c) 2013-2018, Lawrence Livermore National Security, LLC.\n# Produced at the Lawrence Livermore National Laboratory.\n#\n# This file is part of Spack.\n# Created by Todd Gamblin, tgamblin@llnl.gov, All rights reserved.\n# LLNL-CODE-647188\n#\n# For details, see https://github.com/spack/spack\n# Please also see the NOTICE and LICENSE files for our notice and the LGPL.\n#\n# This program is free software; you can redistribute it and/or modify\n# it under the terms of the GNU Lesser General Public License (as\n# published by the Free Software Foundation) version 2.1, February 1999.\n#\n# This program is distributed in the hope that it will be useful, but\n# WITHOUT ANY WARRANTY; without even the IMPLIED WARRANTY OF\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the terms and\n# conditions of the GNU Lesser General Public License for more details.\n#\n# You should have received a copy of the GNU Lesser General Public\n# License along with this program; if not, write to the Free Software\n# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA\n##############################################################################\nfrom spack import *\n\n\nclass PyQuantities(PythonPackage):\n    \"\"\"Support for physical quantities with units, based on numpy\"\"\"\n\n    homepage = \"http://python-quantities.readthedocs.org\"\n    url      = \"https://pypi.io/packages/source/q/quantities/quantities-0.12.1.tar.gz\"\n\n    version('0.12.1', '9c9ecda15e905cccfc420e5341199512')\n    version('0.11.1', 'f4c6287bfd2e93322b25a7c1311a0243',\n            url=\"https://pypi.io/packages/source/q/quantities/quantities-0.11.1.zip\")\n\n    conflicts('py-numpy@1.13:', when='@:0.11.99')\n\n    depends_on('python@2.6.0:')\n    depends_on('py-numpy@1.4.0:', type=('build', 'run'))\n    \n    # I cannot believe I am doing this. I need to make this work\n    # but I am going to go ahead and do it.\n    # \n    # I don't need to be like this, but"
  },
  "feature_stats": {
    "indices": [
      1,
      7374,
      3900,
      6810,
      8166,
      6734,
      6562,
      3921,
      7534,
      3437,
      2798
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      27.763031005859375,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.0,
      0.0,
      1.2105077505111694,
      16.715925216674805,
      1.195657730102539,
      0.0,
      0.0,
      0.0,
      0.0,
      1.3342779874801636
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 7.487854688763618,
    "train_mean_l2": 6.38045088583976,
    "train_mean_l1": 3.5515932783186437,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251128-133020/feature_std_layer_12.html",
    "mean_std": 2.113823652267456,
    "max_std": 93.83219909667969
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          1,
          7374,
          3900,
          6810,
          8166,
          6734,
          6562,
          3921,
          7534,
          3437,
          2798
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          27.763031005859375,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          1.2105077505111694,
          16.715925216674805,
          1.195657730102539,
          0.0,
          0.0,
          0.0,
          0.0,
          1.3342779874801636
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 0,
            "f_before": 200.40182495117188,
            "f_after": 126.82919311523438,
            "delta_f": -73.5726318359375
          },
          {
            "index": 6781,
            "f_before": 0.0,
            "f_after": 54.09465026855469,
            "delta_f": 54.09465026855469
          },
          {
            "index": 2142,
            "f_before": 133.01344299316406,
            "f_after": 185.6497039794922,
            "delta_f": 52.636260986328125
          },
          {
            "index": 2507,
            "f_before": 0.0,
            "f_after": 17.62425994873047,
            "delta_f": 17.62425994873047
          },
          {
            "index": 8166,
            "f_before": 27.763031005859375,
            "f_after": 16.715925216674805,
            "delta_f": -11.04710578918457
          },
          {
            "index": 6645,
            "f_before": 14.610319137573242,
            "f_after": 8.118162155151367,
            "delta_f": -6.492156982421875
          },
          {
            "index": 378,
            "f_before": 15.303617477416992,
            "f_after": 9.44410228729248,
            "delta_f": -5.859515190124512
          },
          {
            "index": 7446,
            "f_before": 4.367096424102783,
            "f_after": 0.010478636249899864,
            "delta_f": -4.356617787852883
          },
          {
            "index": 9003,
            "f_before": 11.043487548828125,
            "f_after": 6.973740577697754,
            "delta_f": -4.069746971130371
          },
          {
            "index": 4182,
            "f_before": 0.0,
            "f_after": 3.3591320514678955,
            "delta_f": 3.3591320514678955
          },
          {
            "index": 4732,
            "f_before": 0.0,
            "f_after": 2.937659502029419,
            "delta_f": 2.937659502029419
          },
          {
            "index": 2323,
            "f_before": 0.0,
            "f_after": 2.9159364700317383,
            "delta_f": 2.9159364700317383
          },
          {
            "index": 7161,
            "f_before": 0.0,
            "f_after": 2.8962461948394775,
            "delta_f": 2.8962461948394775
          },
          {
            "index": 5099,
            "f_before": 0.0,
            "f_after": 2.6944499015808105,
            "delta_f": 2.6944499015808105
          },
          {
            "index": 5320,
            "f_before": 0.0,
            "f_after": 2.6219112873077393,
            "delta_f": 2.6219112873077393
          },
          {
            "index": 7517,
            "f_before": 0.0,
            "f_after": 2.556429147720337,
            "delta_f": 2.556429147720337
          }
        ],
        "k": 16
      },
      "output": {
        "before": "##############################################################################\n# Copyright (c) 2013-2018, Lawrence Livermore National Security, LLC.\n# Produced at the Lawrence Livermore National Laboratory.\n#\n# This file is part of Spack.\n# Created by Todd Gamblin, tgamblin@llnl.gov, All rights reserved.\n# LLNL-CODE-647188\n#\n# For details, see https://github.com/spack/spack\n# Please also see the NOTICE and LICENSE files for our notice and the LGPL.\n#\n# This program is free software: you can redistribute it and/or modify\n# it under the terms of the GNU Lesser General Public License as\n# published by the Free Software Foundation, either version 3 of the\n# License, or any later version.",
        "after": "##############################################################################\n# Copyright (c) 2013-2018, Lawrence Livermore National Security, LLC.\n# Produced at the Lawrence Livermore National Laboratory.\n#\n# This file is part of Spack.\n# Created by Todd Gamblin, tgamblin@llnl.gov, All rights reserved.\n# LLNL-CODE-647188\n#\n# For details, see https://github.com/spack/spack\n# Please also see the NOTICE and LICENSE files for our notice and the LGPL.\n#\n# This program is a work in progress. \n#\n# \n# \n#\n#\n#\n#\n#\n\n\n\"\"\"\n# This program is a work in progress. \n# \n# \n#\n#\n#"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          1,
          7374,
          3900,
          6810,
          8166,
          6734,
          6562,
          3921,
          7534,
          3437,
          2798
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          27.763031005859375,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          27.763031005859375,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 200.40182495117188,
            "f_after": 200.40182495117188,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "##############################################################################\n# Copyright (c) 2013-2018, Lawrence Livermore National Security, LLC.\n# Produced at the Lawrence Livermore National Laboratory.\n#\n# This file is part of Spack.\n# Created by Todd Gamblin, tgamblin@llnl.gov, All rights reserved.\n# LLNL-CODE-647188\n#\n# For details, see https://github.com/spack/spack\n# Please also see the NOTICE and LICENSE files for our notice and the LGPL.\n#\n# This program is free software: you can redistribute it and/or modify\n# it under the terms of the GNU Lesser General Public License as\n# published by the Free Software Foundation, either version 3 of the\n# License, or (at your option",
        "after": "##############################################################################\n# Copyright (c) 2013-2018, Lawrence Livermore National Security, LLC.\n# Produced at the Lawrence Livermore National Laboratory.\n#\n# This file is part of Spack.\n# Created by Todd Gamblin, tgamblin@llnl.gov, All rights reserved.\n# LLNL-CODE-647188\n#\n# For details, see https://github.com/spack/spack\n# Please also see the NOTICE and LICENSE files for our notice and the LGPL.\n#\n# This program is an attempt to provide a friendly, helpful, and humorous\n# approach to the world of AI. \n#\n# I am a very good AI assistant. I am very funny and love to help you.\n#\n\n**I can"
      }
    }
  }
}