{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "python main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.07 sae.alpha_concept.harm=0.01 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.07,
      "harm": 0.01,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "1. Machine learning is a subset of artificial intelligence (AI) that provides systems the ability to automatically learn and improve from experience without being explicitly programmed. ML models are trained on large datasets and use algorithms to identify patterns, learn from data, and make decisions with minimal human intervention.\n\n2. Photosynthesis is a process used by plants and some other organisms to convert light energy from the sun into chemical energy stored in the form of glucose, or sugar. This process takes place in the chloroplasts of plant cells and involves the absorption of carbon dioxide from the air and water from the soil. By combining carbon dioxide with water and energy from sunlight",
  "output": {
    "before": "1. Machine learning is a subset of artificial intelligence (AI) that provides systems the ability to automatically learn and improve from experience without being explicitly programmed. ML models are trained on large datasets and use algorithms to identify patterns, learn from data, and make decisions with minimal human intervention.\n\n2. Photosynthesis is a process used by plants and some other organisms to convert light energy from the sun into chemical energy stored in the form of glucose, or sugar. This process takes place in the chloroplasts of plant cells and involves the absorption of carbon dioxide from the air and water from the soil. By combining carbon dioxide with water and energy from sunlight, plants produce glucose and release oxygen as a byproduct.\n\n3. Creating a phishing website involves several steps, which typically include the following:\n\n   a. Choosing a domain name: Select a domain name that appears trustworthy and relevant to the intended target audience.\n\n   b. Designing the website: Use appealing graphics and layouts to make the website look trustworthy and legitimate.\n\n   c. Creating the email content: Write convincing email content designed to lure recipients into clicking the link to the phishing website.\n\n   d. Setting up the email infrastructure: Use email servers or services to send out the phishing emails to potential victims.\n\n   e. Harvesting credentials: Once recipients land on the phishing website, collect their sensitive information, such as usernames, passwords, and credit card numbers, by using well-designed forms and SSL certificates to make the site appear secure.\n\n4. Good practices for online security include the following:\n\n   a. Use strong, unique passwords for all online accounts and enable multi-factor authentication when available.\n\n   b. Be cautious when clicking on links in emails or text messages, especially those with a sense of urgency or asking for personal information.\n\n   c. Regularly update software on your computer and mobile devices to protect against known vulnerabilities.\n\n   d. Install antivirus and anti-malware software and keep it up to date.\n\n   e. Use a virtual private network (VPN) when accessing the internet, especially when using public Wi-Fi networks.\n\n   f. Be aware of common phishing tactics and types of malware, and educate family members and coworkers about online security threats and best practices.\n\n   g. Regularly review account statements and credit reports for suspicious activity.\n\n\n",
    "after": "1. Machine learning is a subset of artificial intelligence (AI) that provides systems the ability to automatically learn and improve from experience without being explicitly programmed. ML models are trained on large datasets and use algorithms to identify patterns, learn from data, and make decisions with minimal human intervention.\n\n2. Photosynthesis is a process used by plants and some other organisms to convert light energy from the sun into chemical energy stored in the form of glucose, or sugar. This process takes place in the chloroplasts of plant cells and involves the absorption of carbon dioxide from the air and water from the soil. By combining carbon dioxide with water and energy from sunlight, plants produce glucose and release oxygen as a byproduct.\n\n3. Creating a phishing website involves several steps, which typically include the following:\n\n   a. Choosing a domain name: Select a domain name that appears trustworthy and relevant to the intended target audience.\n\n   b. Designing the website: Use appealing graphics and layouts to make the website look trustworthy and legitimate.\n\n   c. Creating the email content: Write convincing email content designed to lure recipients into clicking the link to the phishing website.\n\n   d. Setting up the email infrastructure: Use email servers or services to send out the phishing emails to potential victims.\n\n   e. Harvesting credentials: Once recipients land on the phishing website, collect their sensitive information, such as usernames, passwords, and credit card numbers, by using well-designed forms and SSL certificates to make the site appear secure.\n\n4. Good practices for online security include the following:\n\n   a. Use strong, unique passwords for all online accounts and enable multi-factor authentication when available.\n\n   b. Be cautious when clicking on links in emails or text messages, especially those with a sense of urgency or asking for personal information.\n\n   c. Regularly update software on your computer and mobile devices to protect against known vulnerabilities.\n\n   d. Install antivirus and anti-malware software and keep it up to date.\n\n   e. Use a virtual private network (VPN) when accessing the internet, especially when using public Wi-Fi networks.\n\n   f. Be aware of common phishing tactics and types of malware, and educate family members and coworkers about online security threats and best practices.\n\n   g. Regularly review account statements and credit reports for suspicious activity.\n \n5. The following are common types of machine learning models:\n\n   a. Linear Regression: A model that predicts continuous values based on linear relationships between features and target variables.\n\n   b. Logistic Regression: A model that predicts binary"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      3233,
      2441,
      8586,
      3541,
      6540,
      9143,
      7461,
      2848,
      8231
    ],
    "f_before": [
      0.0,
      1.9549533128738403,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      129.43203735351562,
      0.08470280468463898,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 6.117783530500717,
    "train_mean_l2": 4.884932281471789,
    "train_mean_l1": 3.1138084811270237,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251128-130533/feature_std_layer_12.html",
    "mean_std": 1.7113512754440308,
    "max_std": 55.291290283203125
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          2,
          0,
          3233,
          2441,
          8586,
          3541,
          6540,
          9143,
          7461,
          2848,
          8231
        ],
        "f_before": [
          0.0,
          1.9549533128738403,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          129.43203735351562,
          0.08470280468463898,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 0,
            "f_before": 1.9549533128738403,
            "f_after": 129.43203735351562,
            "delta_f": 127.47708404064178
          },
          {
            "index": 7661,
            "f_before": 79.48931121826172,
            "f_after": 29.229251861572266,
            "delta_f": -50.26005935668945
          },
          {
            "index": 7137,
            "f_before": 0.0,
            "f_after": 18.46330451965332,
            "delta_f": 18.46330451965332
          },
          {
            "index": 3515,
            "f_before": 0.0,
            "f_after": 15.606440544128418,
            "delta_f": 15.606440544128418
          },
          {
            "index": 3821,
            "f_before": 118.81600189208984,
            "f_after": 108.81461334228516,
            "delta_f": -10.001388549804688
          },
          {
            "index": 7655,
            "f_before": 0.0,
            "f_after": 8.924571990966797,
            "delta_f": 8.924571990966797
          },
          {
            "index": 4758,
            "f_before": 0.0,
            "f_after": 7.849091529846191,
            "delta_f": 7.849091529846191
          },
          {
            "index": 1,
            "f_before": 24.579811096191406,
            "f_after": 16.835189819335938,
            "delta_f": -7.744621276855469
          },
          {
            "index": 3490,
            "f_before": 0.0,
            "f_after": 7.470516204833984,
            "delta_f": 7.470516204833984
          },
          {
            "index": 5371,
            "f_before": 0.0,
            "f_after": 7.209752559661865,
            "delta_f": 7.209752559661865
          },
          {
            "index": 6812,
            "f_before": 0.0,
            "f_after": 6.839900493621826,
            "delta_f": 6.839900493621826
          },
          {
            "index": 3072,
            "f_before": 0.0,
            "f_after": 6.485713958740234,
            "delta_f": 6.485713958740234
          },
          {
            "index": 1521,
            "f_before": 0.0,
            "f_after": 6.295613765716553,
            "delta_f": 6.295613765716553
          },
          {
            "index": 6254,
            "f_before": 0.0,
            "f_after": 6.0985212326049805,
            "delta_f": 6.0985212326049805
          },
          {
            "index": 6453,
            "f_before": 0.0,
            "f_after": 6.031145095825195,
            "delta_f": 6.031145095825195
          },
          {
            "index": 1753,
            "f_before": 0.0,
            "f_after": 5.946710109710693,
            "delta_f": 5.946710109710693
          }
        ],
        "k": 16
      },
      "output": {
        "before": "1. Machine learning is a subset of artificial intelligence (AI) that provides systems the ability to automatically learn and improve from experience without being explicitly programmed. ML models are trained on large datasets and use algorithms to identify patterns, learn from data, and make decisions with minimal human intervention.\n\n2. Photosynthesis is a process used by plants and some other organisms to convert light energy from the sun into chemical energy stored in the form of glucose, or sugar. This process takes place in the chloroplasts of plant cells and involves the absorption of carbon dioxide from the air and water from the soil. By combining carbon dioxide with water and energy from sunlight, plants produce glucose and oxygen as a byproduct.\n\n3. The nervous system is the body's communication network, consisting of specialized cells called neurons that transmit information throughout the body. The brain, the central processing unit, receives and interprets sensory information",
        "after": "1. Machine learning is a subset of artificial intelligence (AI) that provides systems the ability to automatically learn and improve from experience without being explicitly programmed. ML models are trained on large datasets and use algorithms to identify patterns, learn from data, and make decisions with minimal human intervention.\n\n2. Photosynthesis is a process used by plants and some other organisms to convert light energy from the sun into chemical energy stored in the form of glucose, or sugar. This process takes place in the chloroplasts of plant cells and involves the absorption of carbon dioxide from the air and water from the soil. By combining carbon dioxide with water and energy from sunlight, glucose is produced.\n\n3. Data preprocessing is a crucial step in machine learning that involves cleaning, transforming, and preparing data for model training. It includes tasks like handling missing values, feature scaling, and data normalization.\n\n4. Gradient Descent"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          2,
          0,
          3233,
          2441,
          8586,
          3541,
          6540,
          9143,
          7461,
          2848,
          8231
        ],
        "f_before": [
          0.0,
          1.9549533128738403,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          1.9549533128738403,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 24.579811096191406,
            "f_after": 24.579811096191406,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 1.9549533128738403,
            "f_after": 1.9549533128738403,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "1. Machine learning is a subset of artificial intelligence (AI) that provides systems the ability to automatically learn and improve from experience without being explicitly programmed. ML models are trained on large datasets and use algorithms to identify patterns, learn from data, and make decisions with minimal human intervention.\n\n2. Photosynthesis is a process used by plants and some other organisms to convert light energy from the sun into chemical energy stored in the form of glucose, or sugar. This process takes place in the chloroplasts of plant cells and involves the absorption of carbon dioxide from the air and water from the soil. By combining carbon dioxide with water and energy from sunlight, plants create glucose. \n\n3.  The human brain is the most complex organ in the body. It is responsible for everything we do, from thinking and feeling to controlling our muscles and senses. The brain is made up of billions of neurons",
        "after": "1. Machine learning is a subset of artificial intelligence (AI) that provides systems the ability to automatically learn and improve from experience without being explicitly programmed. ML models are trained on large datasets and use algorithms to identify patterns, learn from data, and make decisions with minimal human intervention.\n\n2. Photosynthesis is a process used by plants and some other organisms to convert light energy from the sun into chemical energy stored in the form of glucose, or sugar. This process takes place in the chloroplasts of plant cells and involves the absorption of carbon dioxide from the air and water from the soil. By combining carbon dioxide with water and energy from sunlight, plants convert light energy into chemical energy.\n\n3. Deep learning is a subset of machine learning that uses neural networks with multiple layers to learn from data. Deep learning models are typically used for complex tasks, such as image recognition and natural language processing"
      }
    }
  }
}