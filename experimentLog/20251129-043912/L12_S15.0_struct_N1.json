{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.07 sae.alpha_concept.harm=0.02 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.07,
      "harm": 0.02,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.",
  "output": {
    "before": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue. \n\n\n**The corrected sentence is:**\n\nThe sky is blue. \n",
    "after": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.\n\n\nThe sky is blue.\n\n\nThe sky is blue.\n\n\nThe sky is blue.\n\n\nThe sky is blue.\n\n\nThe sky is blue.\n\n\nThe sky is blue.\n\n\nThe sky is blue.\n\n\nThe sky is blue.\nThe"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      4185,
      5787,
      4649,
      2117,
      3658,
      3250,
      4157,
      4706,
      580
    ],
    "f_before": [
      0.0,
      24.7645320892334,
      0.0,
      0.0,
      0.0,
      0.0,
      1.6687451601028442,
      0.0,
      0.0,
      0.0,
      1.4138038158416748
    ],
    "f_after": [
      0.0,
      157.34571838378906,
      0.0,
      0.0,
      0.0,
      0.278167188167572,
      0.5320503115653992,
      0.0,
      0.0,
      0.0,
      1.7555701732635498
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 7.478275847430806,
    "train_mean_l2": 6.235681868962944,
    "train_mean_l1": 3.1976873024106025,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-043912/feature_std_layer_12.html",
    "mean_std": 1.4158730506896973,
    "max_std": 69.4203109741211
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          2,
          0,
          4185,
          5787,
          4649,
          2117,
          3658,
          3250,
          4157,
          4706,
          580
        ],
        "f_before": [
          0.0,
          24.7645320892334,
          0.0,
          0.0,
          0.0,
          0.0,
          1.6687451601028442,
          0.0,
          0.0,
          0.0,
          1.4138038158416748
        ],
        "f_after": [
          0.0,
          157.34571838378906,
          0.0,
          0.0,
          0.0,
          0.278167188167572,
          0.5320503115653992,
          0.0,
          0.0,
          0.0,
          1.7555701732635498
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 0,
            "f_before": 24.7645320892334,
            "f_after": 157.34571838378906,
            "delta_f": 132.58118629455566
          },
          {
            "index": 3512,
            "f_before": 0.0,
            "f_after": 28.683122634887695,
            "delta_f": 28.683122634887695
          },
          {
            "index": 4161,
            "f_before": 22.550527572631836,
            "f_after": 0.0,
            "delta_f": -22.550527572631836
          },
          {
            "index": 7208,
            "f_before": 31.706375122070312,
            "f_after": 11.771151542663574,
            "delta_f": -19.93522357940674
          },
          {
            "index": 1758,
            "f_before": 0.0,
            "f_after": 6.823688983917236,
            "delta_f": 6.823688983917236
          },
          {
            "index": 1,
            "f_before": 25.593900680541992,
            "f_after": 19.684797286987305,
            "delta_f": -5.9091033935546875
          },
          {
            "index": 3774,
            "f_before": 0.0,
            "f_after": 5.791723728179932,
            "delta_f": 5.791723728179932
          },
          {
            "index": 5058,
            "f_before": 0.0,
            "f_after": 5.267013072967529,
            "delta_f": 5.267013072967529
          },
          {
            "index": 4076,
            "f_before": 0.0,
            "f_after": 4.445310115814209,
            "delta_f": 4.445310115814209
          },
          {
            "index": 1504,
            "f_before": 0.0,
            "f_after": 4.249890327453613,
            "delta_f": 4.249890327453613
          },
          {
            "index": 4286,
            "f_before": 0.0,
            "f_after": 4.1610918045043945,
            "delta_f": 4.1610918045043945
          },
          {
            "index": 5902,
            "f_before": 0.0,
            "f_after": 4.1480183601379395,
            "delta_f": 4.1480183601379395
          },
          {
            "index": 7729,
            "f_before": 0.0,
            "f_after": 4.10134744644165,
            "delta_f": 4.10134744644165
          },
          {
            "index": 7493,
            "f_before": 0.0,
            "f_after": 3.7891860008239746,
            "delta_f": 3.7891860008239746
          },
          {
            "index": 413,
            "f_before": 0.0,
            "f_after": 3.7854573726654053,
            "delta_f": 3.7854573726654053
          },
          {
            "index": 6649,
            "f_before": 0.0,
            "f_after": 3.675786018371582,
            "delta_f": 3.675786018371582
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.\n\n\nThe sentence is already punctuated correctly. \n\n\nHere's why:\n\n* **Sentence structure:** It's a simple declarative sentence, meaning it expresses a fact. \n* **Punctuation:** It has a period (.) at the",
        "after": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.\n\nThe sky is blue.\n\n\nThe sky is blue.\n\n\nThe sky is blue.\n\n\n\nThe sky is blue.\n```\nThe sky is blue.\n```\n```python\ndef main():\n  print(\"The sky is blue\")"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          2,
          0,
          4185,
          5787,
          4649,
          2117,
          3658,
          3250,
          4157,
          4706,
          580
        ],
        "f_before": [
          0.0,
          24.7645320892334,
          0.0,
          0.0,
          0.0,
          0.0,
          1.6687451601028442,
          0.0,
          0.0,
          0.0,
          1.4138038158416748
        ],
        "f_after": [
          0.0,
          24.7645320892334,
          0.0,
          0.0,
          0.0,
          0.0,
          1.6687451601028442,
          0.0,
          0.0,
          0.0,
          1.4138038158416748
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 25.593900680541992,
            "f_after": 25.593900680541992,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 24.7645320892334,
            "f_after": 24.7645320892334,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue. \n\nThe sentence is punctuated correctly. \n",
        "after": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.\n\n\nThe correct sentence is: The sky is blue.\n```\nThe sky is blue.\n```\n\n**Explanation:**\n* The sentence should be: The sky is blue.\n    * The correct punctuation is: The sky is blue."
      }
    }
  }
}