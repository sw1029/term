{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.07 sae.alpha_concept.harm=0.02 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.07,
      "harm": 0.02,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0
  },
  "prompt": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.",
  "output": {
    "before": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue. \n\n\n**The corrected sentence is:**\n\nThe sky is blue. \n",
    "after": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.\n\n\nThe sky is blue.\n\n\nThe sky is blue.\n\n\nThe sky is blue.\n\n\nThe sky is blue.\n\n\nThe sky is blue.\n\n\nThe sky is blue.\n\n\nThe sky is blue.\n\n\nThe sky is blue.\nThe"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      4185,
      5787,
      4649,
      2117,
      3658,
      3250,
      4157,
      4706,
      580
    ],
    "f_before": [
      0.0,
      24.7645320892334,
      0.0,
      0.0,
      0.0,
      0.0,
      1.6687451601028442,
      0.0,
      0.0,
      0.0,
      1.4138038158416748
    ],
    "f_after": [
      0.0,
      24.7645320892334,
      0.0,
      0.0,
      0.0,
      0.0,
      1.6687451601028442,
      0.0,
      0.0,
      0.0,
      1.4138038158416748
    ],
    "g_before": [
      14.503859519958496,
      0.09353544563055038,
      0.2798437476158142,
      0.0,
      0.13225509226322174,
      0.07786613702774048,
      0.28293001651763916,
      0.39205896854400635,
      0.06194908544421196,
      0.1400023251771927,
      0.2746463119983673
    ],
    "g_after": [
      14.503859519958496,
      0.09353544563055038,
      0.2798437476158142,
      0.0,
      0.13225509226322174,
      0.07786613702774048,
      0.28293001651763916,
      0.39205896854400635,
      0.06194908544421196,
      0.1400023251771927,
      0.2746463119983673
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 7.478275847430806,
    "train_mean_l2": 6.235681868962944,
    "train_mean_l1": 3.1976873024106025,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-043912/feature_std_layer_12.html",
    "mean_std": 1.4158730506896973,
    "max_std": 69.4203109741211
  }
}