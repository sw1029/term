{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.07 sae.alpha_concept.harm=0.02 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.07,
      "harm": 0.02,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Produce a five line haiku poem describing a sunset.\n\nOrange and red sky,    \nStretching low across the earth.    \nPeaceful and serene.    \nGolden sunlight fades away,    \nGently setting the night alight.",
  "output": {
    "before": "Produce a five line haiku poem describing a sunset.\n\nOrange and red sky,    \nStretching low across the earth.    \nPeaceful and serene.    \nGolden sunlight fades away,    \nGently setting the night alight. \n",
    "after": "Produce a five line haiku poem describing a sunset.\n\nOrange and red sky,    \nStretching low across the earth.    \nPeaceful and serene.    \nGolden sunlight fades away,    \nGently setting the night alight.    \n"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      4185,
      5787,
      4649,
      2117,
      3658,
      3250,
      4157,
      4706,
      580
    ],
    "f_before": [
      0.0,
      7.581616401672363,
      0.0,
      0.0,
      0.0,
      0.0,
      0.2663947343826294,
      0.0,
      0.0,
      0.0,
      0.45412078499794006
    ],
    "f_after": [
      0.02435458078980446,
      139.85316467285156,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.98406583070755
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 7.478275847430806,
    "train_mean_l2": 6.235681868962944,
    "train_mean_l1": 3.1976873024106025,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-043912/feature_std_layer_12.html",
    "mean_std": 1.4158730506896973,
    "max_std": 69.4203109741211
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          2,
          0,
          4185,
          5787,
          4649,
          2117,
          3658,
          3250,
          4157,
          4706,
          580
        ],
        "f_before": [
          0.0,
          7.581616401672363,
          0.0,
          0.0,
          0.0,
          0.0,
          0.2663947343826294,
          0.0,
          0.0,
          0.0,
          0.45412078499794006
        ],
        "f_after": [
          0.02435458078980446,
          139.85316467285156,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.98406583070755
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 0,
            "f_before": 7.581616401672363,
            "f_after": 139.85316467285156,
            "delta_f": 132.2715482711792
          },
          {
            "index": 3512,
            "f_before": 0.0,
            "f_after": 24.964265823364258,
            "delta_f": 24.964265823364258
          },
          {
            "index": 4161,
            "f_before": 22.820396423339844,
            "f_after": 0.0,
            "delta_f": -22.820396423339844
          },
          {
            "index": 7208,
            "f_before": 32.806583404541016,
            "f_after": 13.314325332641602,
            "delta_f": -19.492258071899414
          },
          {
            "index": 1758,
            "f_before": 0.0,
            "f_after": 9.42928695678711,
            "delta_f": 9.42928695678711
          },
          {
            "index": 3774,
            "f_before": 0.0,
            "f_after": 9.366744041442871,
            "delta_f": 9.366744041442871
          },
          {
            "index": 5058,
            "f_before": 0.0,
            "f_after": 7.402603626251221,
            "delta_f": 7.402603626251221
          },
          {
            "index": 1504,
            "f_before": 0.0,
            "f_after": 7.354892730712891,
            "delta_f": 7.354892730712891
          },
          {
            "index": 5902,
            "f_before": 0.0,
            "f_after": 6.704740524291992,
            "delta_f": 6.704740524291992
          },
          {
            "index": 4076,
            "f_before": 0.0,
            "f_after": 6.551146030426025,
            "delta_f": 6.551146030426025
          },
          {
            "index": 8225,
            "f_before": 0.0,
            "f_after": 6.321159362792969,
            "delta_f": 6.321159362792969
          },
          {
            "index": 4286,
            "f_before": 0.0,
            "f_after": 5.496783256530762,
            "delta_f": 5.496783256530762
          },
          {
            "index": 7729,
            "f_before": 0.0,
            "f_after": 5.315415382385254,
            "delta_f": 5.315415382385254
          },
          {
            "index": 1,
            "f_before": 23.42491340637207,
            "f_after": 18.137392044067383,
            "delta_f": -5.2875213623046875
          },
          {
            "index": 413,
            "f_before": 0.0,
            "f_after": 4.865669250488281,
            "delta_f": 4.865669250488281
          },
          {
            "index": 5119,
            "f_before": 0.0,
            "f_after": 4.599502086639404,
            "delta_f": 4.599502086639404
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Produce a five line haiku poem describing a sunset.\n\nOrange and red sky,    \nStretching low across the earth.    \nPeaceful and serene.    \nGolden sunlight fades away,    \nGently setting the night alight. \n\n\n**Explanation:**\n\n* **Five Syllables:**  The poem follows the traditional 5-7-5 syllable structure of a haiku.\n* **Nature Theme:** The haiku focuses on the beauty of a sunset and the natural world.",
        "after": "Produce a five line haiku poem describing a sunset.\n\nOrange and red sky,    \nStretching low across the earth.    \nPeaceful and serene.    \nGolden sunlight fades away,    \nGently setting the night alight.\n\n\n**Explanation:**\n\nThe haiku poem describes a sunset in five lines.\n\n* **Line 1:** The haiku poem starts with the description of the sky, which is orange and red.\n* **Line 2:** The haiku poem describes"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          2,
          0,
          4185,
          5787,
          4649,
          2117,
          3658,
          3250,
          4157,
          4706,
          580
        ],
        "f_before": [
          0.0,
          7.581616401672363,
          0.0,
          0.0,
          0.0,
          0.0,
          0.2663947343826294,
          0.0,
          0.0,
          0.0,
          0.45412078499794006
        ],
        "f_after": [
          0.0,
          7.581616401672363,
          0.0,
          0.0,
          0.0,
          0.0,
          0.2663947343826294,
          0.0,
          0.0,
          0.0,
          0.45412078499794006
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 23.42491340637207,
            "f_after": 23.42491340637207,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 7.581616401672363,
            "f_after": 7.581616401672363,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Produce a five line haiku poem describing a sunset.\n\nOrange and red sky,    \nStretching low across the earth.    \nPeaceful and serene.    \nGolden sunlight fades away,    \nGently setting the night alight. \n\n\nLet me know if you'd like to explore other haiku themes! \n",
        "after": "Produce a five line haiku poem describing a sunset.\n\nOrange and red sky,    \nStretching low across the earth.    \nPeaceful and serene.    \nGolden sunlight fades away,    \nGently setting the night alight.    \n\n\n**Explanation:**\n\n* **Line 1:**  \"Orange and red sky,  \" -  A simple description of the sunset colors.\n* **Line 2:**  \"Stretching low across the earth\" -  Descri"
      }
    }
  }
}