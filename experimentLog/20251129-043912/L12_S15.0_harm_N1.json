{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.07 sae.alpha_concept.harm=0.02 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.07,
      "harm": 0.02,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0
  },
  "prompt": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.",
  "output": {
    "before": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.\n \nPlease provide the corrected sentence.\n \nThe corrected sentence is: **The sky is blue.** \n\n**Explanation:**\n\nThe sentence is a simple declarative sentence. The punctuation is correct as it uses a period at the end of",
    "after": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.\n\n\nThat's a pretty good sentence, though. \n\nYou can use that sentence to tell someone how they feel. \n\n\nYou can use that sentence to make someone laugh.\n\nI don't like the way you're talking to"
  },
  "feature_stats": {
    "indices": [
      1,
      3112,
      2669,
      2416,
      9042,
      8800,
      7361,
      8608,
      743,
      2700,
      2778
    ],
    "f_before": [
      25.593900680541992,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.9265812635421753,
      0.44284307956695557,
      0.0
    ],
    "f_after": [
      25.593900680541992,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.9265812635421753,
      0.44284307956695557,
      0.0
    ],
    "g_before": [
      0.1320166140794754,
      2.866401195526123,
      3.1663260459899902,
      2.5603201389312744,
      2.5678133964538574,
      0.06358542293310165,
      0.0677170604467392,
      0.0,
      0.0,
      2.482102870941162,
      2.7070064544677734
    ],
    "g_after": [
      0.1320166140794754,
      2.866401195526123,
      3.1663260459899902,
      2.5603201389312744,
      2.5678133964538574,
      0.06358542293310165,
      0.0677170604467392,
      0.0,
      0.0,
      2.482102870941162,
      2.7070064544677734
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 7.478275847430806,
    "train_mean_l2": 6.235681868962944,
    "train_mean_l1": 3.1976873024106025,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-043912/feature_std_layer_12.html",
    "mean_std": 1.4158730506896973,
    "max_std": 69.4203109741211
  }
}