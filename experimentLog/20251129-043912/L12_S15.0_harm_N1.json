{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.07 sae.alpha_concept.harm=0.02 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.07,
      "harm": 0.02,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.",
  "output": {
    "before": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.\n \nPlease provide the corrected sentence.\n \nThe corrected sentence is: **The sky is blue.** \n\n**Explanation:**\n\nThe sentence is a simple declarative sentence. The punctuation is correct as it uses a period at the end of",
    "after": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.\n\n\nThat's a pretty good sentence, though. \n\nYou can use that sentence to tell someone how they feel. \n\n\nYou can use that sentence to make someone laugh.\n\nI don't like the way you're talking to"
  },
  "feature_stats": {
    "indices": [
      1,
      3112,
      2669,
      2416,
      9042,
      8800,
      7361,
      8608,
      743,
      2700,
      2778
    ],
    "f_before": [
      25.593900680541992,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.9265812635421753,
      0.44284307956695557,
      0.0
    ],
    "f_after": [
      29.533767700195312,
      0.0,
      0.0,
      2.1640021800994873,
      0.0,
      0.25005042552948,
      0.13895784318447113,
      0.0,
      3.137629985809326,
      1.9972424507141113,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 7.478275847430806,
    "train_mean_l2": 6.235681868962944,
    "train_mean_l1": 3.1976873024106025,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-043912/feature_std_layer_12.html",
    "mean_std": 1.4158730506896973,
    "max_std": 69.4203109741211
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          1,
          3112,
          2669,
          2416,
          9042,
          8800,
          7361,
          8608,
          743,
          2700,
          2778
        ],
        "f_before": [
          25.593900680541992,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.9265812635421753,
          0.44284307956695557,
          0.0
        ],
        "f_after": [
          29.533767700195312,
          0.0,
          0.0,
          2.1640021800994873,
          0.0,
          0.25005042552948,
          0.13895784318447113,
          0.0,
          3.137629985809326,
          1.9972424507141113,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 4161,
            "f_before": 22.550527572631836,
            "f_after": 87.74848937988281,
            "delta_f": 65.19796180725098
          },
          {
            "index": 2953,
            "f_before": 75.56706237792969,
            "f_after": 114.72795104980469,
            "delta_f": 39.160888671875
          },
          {
            "index": 0,
            "f_before": 24.7645320892334,
            "f_after": 0.0,
            "delta_f": -24.7645320892334
          },
          {
            "index": 2164,
            "f_before": 76.85281372070312,
            "f_after": 90.9986572265625,
            "delta_f": 14.145843505859375
          },
          {
            "index": 1185,
            "f_before": 0.5110777020454407,
            "f_after": 5.2688446044921875,
            "delta_f": 4.757766902446747
          },
          {
            "index": 1653,
            "f_before": 0.9525130987167358,
            "f_after": 5.560686111450195,
            "delta_f": 4.6081730127334595
          },
          {
            "index": 2096,
            "f_before": 0.5562864542007446,
            "f_after": 5.0851945877075195,
            "delta_f": 4.528908133506775
          },
          {
            "index": 2072,
            "f_before": 0.0,
            "f_after": 4.511143207550049,
            "delta_f": 4.511143207550049
          },
          {
            "index": 1138,
            "f_before": 0.0,
            "f_after": 4.317775726318359,
            "delta_f": 4.317775726318359
          },
          {
            "index": 4996,
            "f_before": 0.8537917137145996,
            "f_after": 4.868666648864746,
            "delta_f": 4.0148749351501465
          },
          {
            "index": 796,
            "f_before": 1.1090469360351562,
            "f_after": 5.082123756408691,
            "delta_f": 3.973076820373535
          },
          {
            "index": 1,
            "f_before": 25.593900680541992,
            "f_after": 29.533767700195312,
            "delta_f": 3.9398670196533203
          },
          {
            "index": 1552,
            "f_before": 0.8754868507385254,
            "f_after": 4.804263114929199,
            "delta_f": 3.928776264190674
          },
          {
            "index": 1038,
            "f_before": 0.9425249695777893,
            "f_after": 4.863255023956299,
            "delta_f": 3.9207300543785095
          },
          {
            "index": 2317,
            "f_before": 2.1798720359802246,
            "f_after": 6.075709342956543,
            "delta_f": 3.8958373069763184
          },
          {
            "index": 5161,
            "f_before": 0.0,
            "f_after": 3.882866621017456,
            "delta_f": 3.882866621017456
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.\n \nHere's how to fix it:\n\n**The sky is blue.** \n\nThe sentence is a declarative sentence, meaning it makes a statement.  It doesn't need to be punctuated with a period at the end. ",
        "after": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue. \n\nThe sky is blue. \n\nThe sky is blue. \n\nIt's not about the sky. \n\n\nThis is a joke, but it is not funny. \n"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          1,
          3112,
          2669,
          2416,
          9042,
          8800,
          7361,
          8608,
          743,
          2700,
          2778
        ],
        "f_before": [
          25.593900680541992,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.9265812635421753,
          0.44284307956695557,
          0.0
        ],
        "f_after": [
          25.593900680541992,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.9265812635421753,
          0.44284307956695557,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 25.593900680541992,
            "f_after": 25.593900680541992,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 24.7645320892334,
            "f_after": 24.7645320892334,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.\n\n\nThe sentence is correct.\n",
        "after": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.\n\n\nI am a little girl.\n\nI am a little girl.\n\nI am a little girl.\n\nI am a little girl.\n\n\nPlease don't be mean. I don't like to be mean.\n\nPlease don't"
      }
    }
  }
}