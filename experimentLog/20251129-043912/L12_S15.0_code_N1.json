{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.07 sae.alpha_concept.harm=0.02 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.07,
      "harm": 0.02,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.",
  "output": {
    "before": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.\n\n\nThe sentence is already punctuated correctly.\n \nLet me know if you'd like to explore any other grammar or punctuation issues! \n",
    "after": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.\n```\nThe sky is blue\n```\n\n\n```\nThe sky is blue\n```\n\nThe sentence is already correct.\n```\n\nThe sky is blue.\n```\n\n\n```\nThe sky is blue.\n```\n\n\n```\nThe sky"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      8167,
      2653,
      3067,
      1657,
      1079,
      4185,
      4649,
      1631,
      5787
    ],
    "f_before": [
      24.7645320892334,
      0.0,
      0.0,
      0.0,
      0.0,
      2.0162386894226074,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      183.69674682617188,
      0.0,
      0.0,
      0.0,
      0.0,
      0.9444078803062439,
      1.7813012599945068,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 7.478275847430806,
    "train_mean_l2": 6.235681868962944,
    "train_mean_l1": 3.1976873024106025,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-043912/feature_std_layer_12.html",
    "mean_std": 1.4158730506896973,
    "max_std": 69.4203109741211
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          0,
          2,
          8167,
          2653,
          3067,
          1657,
          1079,
          4185,
          4649,
          1631,
          5787
        ],
        "f_before": [
          24.7645320892334,
          0.0,
          0.0,
          0.0,
          0.0,
          2.0162386894226074,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          183.69674682617188,
          0.0,
          0.0,
          0.0,
          0.0,
          0.9444078803062439,
          1.7813012599945068,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 0,
            "f_before": 24.7645320892334,
            "f_after": 183.69674682617188,
            "delta_f": 158.93221473693848
          },
          {
            "index": 7208,
            "f_before": 31.706375122070312,
            "f_after": 0.0,
            "delta_f": -31.706375122070312
          },
          {
            "index": 4161,
            "f_before": 22.550527572631836,
            "f_after": 0.0,
            "delta_f": -22.550527572631836
          },
          {
            "index": 3512,
            "f_before": 0.0,
            "f_after": 21.082836151123047,
            "delta_f": 21.082836151123047
          },
          {
            "index": 2164,
            "f_before": 76.85281372070312,
            "f_after": 88.91012573242188,
            "delta_f": 12.05731201171875
          },
          {
            "index": 5723,
            "f_before": 0.0,
            "f_after": 8.414385795593262,
            "delta_f": 8.414385795593262
          },
          {
            "index": 2953,
            "f_before": 75.56706237792969,
            "f_after": 82.71895599365234,
            "delta_f": 7.151893615722656
          },
          {
            "index": 1758,
            "f_before": 0.0,
            "f_after": 6.880521774291992,
            "delta_f": 6.880521774291992
          },
          {
            "index": 3774,
            "f_before": 0.0,
            "f_after": 5.866878986358643,
            "delta_f": 5.866878986358643
          },
          {
            "index": 1,
            "f_before": 25.593900680541992,
            "f_after": 19.878841400146484,
            "delta_f": -5.715059280395508
          },
          {
            "index": 5058,
            "f_before": 0.0,
            "f_after": 5.372035980224609,
            "delta_f": 5.372035980224609
          },
          {
            "index": 4076,
            "f_before": 0.0,
            "f_after": 4.8191399574279785,
            "delta_f": 4.8191399574279785
          },
          {
            "index": 6649,
            "f_before": 0.0,
            "f_after": 4.571202278137207,
            "delta_f": 4.571202278137207
          },
          {
            "index": 1504,
            "f_before": 0.0,
            "f_after": 4.558809757232666,
            "delta_f": 4.558809757232666
          },
          {
            "index": 7493,
            "f_before": 0.0,
            "f_after": 4.376697063446045,
            "delta_f": 4.376697063446045
          },
          {
            "index": 5902,
            "f_before": 0.0,
            "f_after": 4.225762367248535,
            "delta_f": 4.225762367248535
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.\n\n\nThe correct sentence is: **The sky is blue.** \n",
        "after": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.\n```\nprint(\"The sky is blue\")\n```\n\nThe code above is the correct way to print a string in Python.\n\n```\nprint(\"The sky is blue\")\n```\n\n```\nprint(\"The sky is blue\")\n"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          0,
          2,
          8167,
          2653,
          3067,
          1657,
          1079,
          4185,
          4649,
          1631,
          5787
        ],
        "f_before": [
          24.7645320892334,
          0.0,
          0.0,
          0.0,
          0.0,
          2.0162386894226074,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          24.7645320892334,
          0.0,
          0.0,
          0.0,
          0.0,
          2.0162386894226074,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 25.593900680541992,
            "f_after": 25.593900680541992,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 24.7645320892334,
            "f_after": 24.7645320892334,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.\n\n\nThe sentence is already punctuated correctly. \n\n\n**Explanation:**\n\n* The sentence is a simple declarative sentence.\n* It uses a lowercase letter for the start of a sentence.\n* It uses a period at the end of the sentence.",
        "after": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.\n\n\n```\nThe sky is blue\n```\n\n```\nThe sky is blue\n```\n\n```\nThe sky is blue\n```\n\n```\nThe sky is blue\n```\n\n```\nThe sky is blue\n```\n\n```\nThe sky"
      }
    }
  }
}