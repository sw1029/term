{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.07 sae.alpha_concept.harm=0.02 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.0009132649020605174 sae.role_sep_coeff=0.0035",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0009132649020605174,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.07,
      "harm": 0.02,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0035
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0
  },
  "prompt": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.",
  "output": {
    "before": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.\n\n\nThe sentence is already punctuated correctly.\n \nLet me know if you'd like to explore any other grammar or punctuation issues! \n",
    "after": "Correct the following sentence for punctuation.\n\nThe sky is blue\n\nThe sky is blue.\n```\nThe sky is blue\n```\n\n\n```\nThe sky is blue\n```\n\nThe sentence is already correct.\n```\n\nThe sky is blue.\n```\n\n\n```\nThe sky is blue.\n```\n\n\n```\nThe sky"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      8167,
      2653,
      3067,
      1657,
      1079,
      4185,
      4649,
      1631,
      5787
    ],
    "f_before": [
      24.7645320892334,
      0.0,
      0.0,
      0.0,
      0.0,
      2.0162386894226074,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      24.7645320892334,
      0.0,
      0.0,
      0.0,
      0.0,
      2.0162386894226074,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.09353544563055038,
      14.503859519958496,
      2.5540213584899902,
      2.9259519577026367,
      2.6850168704986572,
      2.665686845779419,
      2.6007192134857178,
      0.2798437476158142,
      0.13225509226322174,
      0.4178987443447113,
      0.0
    ],
    "g_after": [
      0.09353544563055038,
      14.503859519958496,
      2.5540213584899902,
      2.9259519577026367,
      2.6850168704986572,
      2.665686845779419,
      2.6007192134857178,
      0.2798437476158142,
      0.13225509226322174,
      0.4178987443447113,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 7.478275847430806,
    "train_mean_l2": 6.235681868962944,
    "train_mean_l1": 3.1976873024106025,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-043912/feature_std_layer_12.html",
    "mean_std": 1.4158730506896973,
    "max_std": 69.4203109741211
  }
}