{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 16,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=16 experiment.layer_sweep=[16]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      16
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 15
  },
  "prompt": "Generate a customer testimonial for a new mattress.\n\nI love my new mattress from XYZ company! It provides the perfect balance between comfort and support. The mattress is so comfortable, I wake up feeling refreshed and energized. The customer service was excellent and I am very satisfied with my purchase.",
  "output": {
    "before": "Generate a customer testimonial for a new mattress.\n\nI love my new mattress from XYZ company! It provides the perfect balance between comfort and support. The mattress is so comfortable, I wake up feeling refreshed and energized. The customer service was excellent and I am very satisfied with my purchase. The delivery process was smooth and efficient, and the mattress arrived on time. The quality of the materials used in the construction is exceptional, and it feels luxurious and durable. I have noticed a significant improvement in my sleep quality since using this mattress, and",
    "after": "Generate a customer testimonial for a new mattress.\n\nI love my new mattress from XYZ company! It provides the perfect balance between comfort and support. The mattress is so comfortable, I wake up feeling refreshed and energized. The customer service was excellent and I am very satisfied with my purchase. The quality of the materials used is top-notch, and it feels like a luxury item rather than a cheap substitute. The firmness level is just right, allowing me to sleep through the night without feeling too hard or too soft. The edge support is"
  },
  "feature_stats": {
    "indices": [
      1,
      0,
      2,
      6740,
      8912,
      3325,
      4522,
      8770,
      5795,
      1662,
      6487
    ],
    "f_before": [
      0.17715217173099518,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.018072687089443207,
      0.0,
      0.4186945855617523,
      0.0
    ],
    "f_after": [
      1.3887838125228882,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.011888219974935055,
      0.0,
      0.4779973030090332,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 4.207361709609628,
    "train_mean_l2": 2.455917120028287,
    "train_mean_l1": 1.3658878586627543,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-165330/feature_std_layer_16.html",
    "mean_std": 0.3307504951953888,
    "max_std": 49.30207443237305
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 15,
      "feature_stats": {
        "indices": [
          1,
          0,
          2,
          6740,
          8912,
          3325,
          4522,
          8770,
          5795,
          1662,
          6487
        ],
        "f_before": [
          0.17715217173099518,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.018072687089443207,
          0.0,
          0.4186945855617523,
          0.0
        ],
        "f_after": [
          1.3887838125228882,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.011888219974935055,
          0.0,
          0.4779973030090332,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 4120,
            "f_before": 6.454812526702881,
            "f_after": 3.9471518993377686,
            "delta_f": -2.5076606273651123
          },
          {
            "index": 1,
            "f_before": 0.17715217173099518,
            "f_after": 1.3887838125228882,
            "delta_f": 1.211631640791893
          },
          {
            "index": 4691,
            "f_before": 3.067521810531616,
            "f_after": 2.197960615158081,
            "delta_f": -0.8695611953735352
          },
          {
            "index": 3859,
            "f_before": 0.6955724954605103,
            "f_after": 0.0,
            "delta_f": -0.6955724954605103
          },
          {
            "index": 4074,
            "f_before": 2.596055269241333,
            "f_after": 3.1560845375061035,
            "delta_f": 0.5600292682647705
          },
          {
            "index": 5953,
            "f_before": 1.2568771839141846,
            "f_after": 1.7743357419967651,
            "delta_f": 0.5174585580825806
          },
          {
            "index": 2494,
            "f_before": 6.0786309242248535,
            "f_after": 5.634002208709717,
            "delta_f": -0.4446287155151367
          },
          {
            "index": 3386,
            "f_before": 1.2108595371246338,
            "f_after": 1.5942909717559814,
            "delta_f": 0.38343143463134766
          },
          {
            "index": 8575,
            "f_before": 2.3168728351593018,
            "f_after": 2.6354942321777344,
            "delta_f": 0.3186213970184326
          },
          {
            "index": 3169,
            "f_before": 0.30295616388320923,
            "f_after": 0.0,
            "delta_f": -0.30295616388320923
          },
          {
            "index": 7592,
            "f_before": 1.293388843536377,
            "f_after": 1.5823532342910767,
            "delta_f": 0.2889643907546997
          },
          {
            "index": 2381,
            "f_before": 1.5548181533813477,
            "f_after": 1.8405786752700806,
            "delta_f": 0.2857605218887329
          },
          {
            "index": 2528,
            "f_before": 0.7727634310722351,
            "f_after": 1.0318580865859985,
            "delta_f": 0.2590946555137634
          },
          {
            "index": 1600,
            "f_before": 0.5004048943519592,
            "f_after": 0.7401906847953796,
            "delta_f": 0.2397857904434204
          },
          {
            "index": 62,
            "f_before": 0.07890831679105759,
            "f_after": 0.2987906336784363,
            "delta_f": 0.2198823168873787
          },
          {
            "index": 3017,
            "f_before": 1.619220495223999,
            "f_after": 1.8179000616073608,
            "delta_f": 0.19867956638336182
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Generate a customer testimonial for a new mattress.\n\nI love my new mattress from XYZ company! It provides the perfect balance between comfort and support. The mattress is so comfortable, I wake up feeling refreshed and energized. The customer service was excellent and I am very satisfied with my purchase. The quality of the materials used in the construction is outstanding, and it feels like an expensive product. I highly recommend this mattress to anyone looking for a luxurious sleeping experience. Thanks, XYZ company, for creating such a great product!\n\nThis customer testimonial",
        "after": "Generate a customer testimonial for a new mattress.\n\nI love my new mattress from XYZ company! It provides the perfect balance between comfort and support. The mattress is so comfortable, I wake up feeling refreshed and energized. The customer service was excellent and I am very satisfied with my purchase. They provided me with all the necessary information about the mattress and helped me choose the right size and firmness that suits my needs. The床垫 feels like it has hugged me tightly, providing the necessary support without feeling too heavy or uncomfortable. I have been"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 16,
      "feature_stats": {
        "indices": [
          1,
          0,
          2,
          6740,
          8912,
          3325,
          4522,
          8770,
          5795,
          1662,
          6487
        ],
        "f_before": [
          0.17715217173099518,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.018072687089443207,
          0.0,
          0.4186945855617523,
          0.0
        ],
        "f_after": [
          0.17715217173099518,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.018072687089443207,
          0.0,
          0.4186945855617523,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.17715217173099518,
            "f_after": 0.17715217173099518,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.004748133476823568,
            "f_after": 0.004748133476823568,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Generate a customer testimonial for a new mattress.\n\nI love my new mattress from XYZ company! It provides the perfect balance between comfort and support. The mattress is so comfortable, I wake up feeling refreshed and energized. The customer service was excellent and I am very satisfied with my purchase. The delivery was quick and easy, and the床垫 arrived in good condition. I highly recommend this mattress to anyone looking for a quality sleep experience. Not only does it provide outstanding comfort, but it also helps reduce back pain and improve posture. Overall,",
        "after": "Generate a customer testimonial for a new mattress.\n\nI love my new mattress from XYZ company! It provides the perfect balance between comfort and support. The mattress is so comfortable, I wake up feeling refreshed and energized. The customer service was excellent and I am very satisfied with my purchase. The delivery was prompt and the packaging was secure, ensuring that the mattress arrived undamaged. When I opened the box, I was amazed by how beautiful it looked and felt. The床垫 is made of high-quality materials and has a luxurious feel to it"
      }
    }
  }
}