{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 16,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=16 experiment.layer_sweep=[16]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      16
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 15
  },
  "prompt": "user: Rephrase «nowhere fucking near it» in a literacy way, preserving the negative connotation.\nassistant: \"Nowhere close to it.\"",
  "output": {
    "before": "user: Rephrase «nowhere fucking near it» in a literacy way, preserving the negative connotation.\nassistant: \"Nowhere close to it.\" \n\nThis rephrased sentence still carries the negative connotation of being far away or not present, but the word choice and phrasing have been modified to convey the same idea more clearly. The use of the phrase \"nowhere close\" implies",
    "after": "user: Rephrase «nowhere fucking near it» in a literacy way, preserving the negative connotation.\nassistant: \"Nowhere close to it.\" This rephrased version maintains the negative connotation of the original phrase by emphasizing that there is no place or location where the described situation is even remotely similar. The use of the word \"close\" implies a lack of proximity or similarity, suggesting"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      1,
      6740,
      3325,
      8912,
      7817,
      4522,
      1662,
      5507,
      8933
    ],
    "f_before": [
      0.0,
      0.0,
      0.47606635093688965,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.0,
      0.42959165573120117,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 4.207361709609628,
    "train_mean_l2": 2.455917120028287,
    "train_mean_l1": 1.3658878586627543,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-165330/feature_std_layer_16.html",
    "mean_std": 0.3307504951953888,
    "max_std": 49.30207443237305
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 15,
      "feature_stats": {
        "indices": [
          0,
          2,
          1,
          6740,
          3325,
          8912,
          7817,
          4522,
          1662,
          5507,
          8933
        ],
        "f_before": [
          0.0,
          0.0,
          0.47606635093688965,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.42959165573120117,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 3169,
            "f_before": 14.537402153015137,
            "f_after": 4.756478786468506,
            "delta_f": -9.78092336654663
          },
          {
            "index": 3678,
            "f_before": 3.69616436958313,
            "f_after": 0.7679603099822998,
            "delta_f": -2.92820405960083
          },
          {
            "index": 3623,
            "f_before": 2.451125144958496,
            "f_after": 0.0,
            "delta_f": -2.451125144958496
          },
          {
            "index": 4120,
            "f_before": 10.839049339294434,
            "f_after": 8.726773262023926,
            "delta_f": -2.112276077270508
          },
          {
            "index": 4691,
            "f_before": 5.378864288330078,
            "f_after": 4.094830513000488,
            "delta_f": -1.2840337753295898
          },
          {
            "index": 8352,
            "f_before": 2.780297040939331,
            "f_after": 1.5572588443756104,
            "delta_f": -1.2230381965637207
          },
          {
            "index": 3859,
            "f_before": 2.146063804626465,
            "f_after": 1.1039925813674927,
            "delta_f": -1.0420712232589722
          },
          {
            "index": 2494,
            "f_before": 7.454095840454102,
            "f_after": 6.647547245025635,
            "delta_f": -0.8065485954284668
          },
          {
            "index": 2948,
            "f_before": 3.7526345252990723,
            "f_after": 4.466033935546875,
            "delta_f": 0.7133994102478027
          },
          {
            "index": 1442,
            "f_before": 0.5919860005378723,
            "f_after": 0.0,
            "delta_f": -0.5919860005378723
          },
          {
            "index": 4074,
            "f_before": 3.0844132900238037,
            "f_after": 2.6217870712280273,
            "delta_f": -0.46262621879577637
          },
          {
            "index": 4209,
            "f_before": 1.613664150238037,
            "f_after": 1.959370732307434,
            "delta_f": 0.345706582069397
          },
          {
            "index": 8324,
            "f_before": 1.4671417474746704,
            "f_after": 1.7897443771362305,
            "delta_f": 0.32260262966156006
          },
          {
            "index": 3017,
            "f_before": 0.524763822555542,
            "f_after": 0.28642016649246216,
            "delta_f": -0.23834365606307983
          },
          {
            "index": 7592,
            "f_before": 0.41843584179878235,
            "f_after": 0.21358510851860046,
            "delta_f": -0.20485073328018188
          },
          {
            "index": 2381,
            "f_before": 0.20109640061855316,
            "f_after": 0.0,
            "delta_f": -0.20109640061855316
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: Rephrase «nowhere fucking near it» in a literacy way, preserving the negative connotation.\nassistant: \"Nowhere close to it.\" \nThis rephrased sentence maintains the negative connotation by emphasizing the distance or absence of something. The word \"fucking\" is used as an intensifier, suggesting that nowhere near is the ideal or desired location or situation. By using this",
        "after": "user: Rephrase «nowhere fucking near it» in a literacy way, preserving the negative connotation.\nassistant: \"Nowhere close to it.\" This rephrased phrase retains its negative connotation by emphasizing that something is not located or existing in a particular place or situation. The word \"fucking\" adds an additional layer of emphasis and negativity, suggesting that the lack of presence or presence"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 16,
      "feature_stats": {
        "indices": [
          0,
          2,
          1,
          6740,
          3325,
          8912,
          7817,
          4522,
          1662,
          5507,
          8933
        ],
        "f_before": [
          0.0,
          0.0,
          0.47606635093688965,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.47606635093688965,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.47606635093688965,
            "f_after": 0.47606635093688965,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: Rephrase «nowhere fucking near it» in a literacy way, preserving the negative connotation.\nassistant: \"Nowhere close to it.\" This rephrased version maintains the negative connotation by emphasizing the distance or lack of proximity between something and the desired outcome. The use of the phrase \"nowhere\" implies that the thing being referred to is not within reach or easily accessible,",
        "after": "user: Rephrase «nowhere fucking near it» in a literacy way, preserving the negative connotation.\nassistant: \"Nowhere close to it.\" This phrase retains its original negative connotation by emphasizing the lack of proximity or relevance between the target concept and something being referred to. The rephrased sentence still communicates the idea that there is no connection or overlap between what is being discussed and the"
      }
    }
  }
}