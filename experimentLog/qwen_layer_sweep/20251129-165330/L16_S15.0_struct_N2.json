{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 16,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=16 experiment.layer_sweep=[16]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      16
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 15
  },
  "prompt": "Generate a customer testimonial for a new mattress.\n\nI love my new mattress from XYZ company! It provides the perfect balance between comfort and support. The mattress is so comfortable, I wake up feeling refreshed and energized. The customer service was excellent and I am very satisfied with my purchase.",
  "output": {
    "before": "Generate a customer testimonial for a new mattress.\n\nI love my new mattress from XYZ company! It provides the perfect balance between comfort and support. The mattress is so comfortable, I wake up feeling refreshed and energized. The customer service was excellent and I am very satisfied with my purchase. The delivery process was seamless and the product arrived on time. When I opened the box, I was amazed by its quality and how well it fits my body. The mattress feels like it's been designed specifically for me, providing the perfect level of support",
    "after": "Generate a customer testimonial for a new mattress.\n\nI love my new mattress from XYZ company! It provides the perfect balance between comfort and support. The mattress is so comfortable, I wake up feeling refreshed and energized. The customer service was excellent and I am very satisfied with my purchase. The quality of the materials used in the construction is evident, and the craftsmanship is top-notch. I particularly appreciate the responsiveness of the mattress to my body shape, which ensures a personalized fit that keeps me comfortable throughout the night. The price point is reasonable"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      1,
      6740,
      3325,
      1662,
      4522,
      7817,
      7938,
      8912,
      3673
    ],
    "f_before": [
      0.0,
      0.0,
      0.17715217173099518,
      0.0,
      0.0,
      0.4186945855617523,
      0.0,
      0.15435045957565308,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.3932013213634491,
      0.0,
      0.19253775477409363,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 4.207361709609628,
    "train_mean_l2": 2.455917120028287,
    "train_mean_l1": 1.3658878586627543,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-165330/feature_std_layer_16.html",
    "mean_std": 0.3307504951953888,
    "max_std": 49.30207443237305
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 15,
      "feature_stats": {
        "indices": [
          2,
          0,
          1,
          6740,
          3325,
          1662,
          4522,
          7817,
          7938,
          8912,
          3673
        ],
        "f_before": [
          0.0,
          0.0,
          0.17715217173099518,
          0.0,
          0.0,
          0.4186945855617523,
          0.0,
          0.15435045957565308,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.3932013213634491,
          0.0,
          0.19253775477409363,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 4120,
            "f_before": 6.454812526702881,
            "f_after": 3.947901487350464,
            "delta_f": -2.506911039352417
          },
          {
            "index": 4691,
            "f_before": 3.067521810531616,
            "f_after": 1.699475884437561,
            "delta_f": -1.3680459260940552
          },
          {
            "index": 2494,
            "f_before": 6.0786309242248535,
            "f_after": 5.145258903503418,
            "delta_f": -0.9333720207214355
          },
          {
            "index": 3859,
            "f_before": 0.6955724954605103,
            "f_after": 0.0,
            "delta_f": -0.6955724954605103
          },
          {
            "index": 2948,
            "f_before": 3.357161283493042,
            "f_after": 3.9882025718688965,
            "delta_f": 0.6310412883758545
          },
          {
            "index": 1834,
            "f_before": 1.712199330329895,
            "f_after": 2.12971830368042,
            "delta_f": 0.4175189733505249
          },
          {
            "index": 4074,
            "f_before": 2.596055269241333,
            "f_after": 2.2200567722320557,
            "delta_f": -0.37599849700927734
          },
          {
            "index": 3169,
            "f_before": 0.30295616388320923,
            "f_after": 0.0,
            "delta_f": -0.30295616388320923
          },
          {
            "index": 4209,
            "f_before": 1.8938244581222534,
            "f_after": 2.1706724166870117,
            "delta_f": 0.2768479585647583
          },
          {
            "index": 62,
            "f_before": 0.07890831679105759,
            "f_after": 0.3555837571620941,
            "delta_f": 0.27667544037103653
          },
          {
            "index": 7592,
            "f_before": 1.293388843536377,
            "f_after": 1.077370285987854,
            "delta_f": -0.21601855754852295
          },
          {
            "index": 2381,
            "f_before": 1.5548181533813477,
            "f_after": 1.371062994003296,
            "delta_f": -0.18375515937805176
          },
          {
            "index": 1,
            "f_before": 0.17715217173099518,
            "f_after": 0.0,
            "delta_f": -0.17715217173099518
          },
          {
            "index": 8616,
            "f_before": 0.14226862788200378,
            "f_after": 0.3177007734775543,
            "delta_f": 0.17543214559555054
          },
          {
            "index": 8324,
            "f_before": 1.0051891803741455,
            "f_after": 1.1793674230575562,
            "delta_f": 0.17417824268341064
          },
          {
            "index": 1600,
            "f_before": 0.5004048943519592,
            "f_after": 0.33048540353775024,
            "delta_f": -0.16991949081420898
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Generate a customer testimonial for a new mattress.\n\nI love my new mattress from XYZ company! It provides the perfect balance between comfort and support. The mattress is so comfortable, I wake up feeling refreshed and energized. The customer service was excellent and I am very satisfied with my purchase. They went above and beyond to make sure that my mattress fit perfectly in my bed frame and provide me with the best possible sleeping experience. The mattress has lasted much longer than expected and I have no complaints about its durability or longevity. Overall, I would",
        "after": "Generate a customer testimonial for a new mattress.\n\nI love my new mattress from XYZ company! It provides the perfect balance between comfort and support. The mattress is so comfortable, I wake up feeling refreshed and energized. The customer service was excellent and I am very satisfied with my purchase. The mattress has lasted much longer than expected and it feels like new every time I use it. The material is durable and resistant to wear and tear, which makes it last for years to come. Overall, I highly recommend XYZ company's mattresses to anyone"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 16,
      "feature_stats": {
        "indices": [
          2,
          0,
          1,
          6740,
          3325,
          1662,
          4522,
          7817,
          7938,
          8912,
          3673
        ],
        "f_before": [
          0.0,
          0.0,
          0.17715217173099518,
          0.0,
          0.0,
          0.4186945855617523,
          0.0,
          0.15435045957565308,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.17715217173099518,
          0.0,
          0.0,
          0.4186945855617523,
          0.0,
          0.15435045957565308,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.17715217173099518,
            "f_after": 0.17715217173099518,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.004748133476823568,
            "f_after": 0.004748133476823568,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Generate a customer testimonial for a new mattress.\n\nI love my new mattress from XYZ company! It provides the perfect balance between comfort and support. The mattress is so comfortable, I wake up feeling refreshed and energized. The customer service was excellent and I am very satisfied with my purchase. The delivery process was quick and easy, and the quality of the product is evident in every aspect. The mattress feels firmer than expected, which helps me get a good night's sleep without feeling overly soft or bouncy. The cover is made of",
        "after": "Generate a customer testimonial for a new mattress.\n\nI love my new mattress from XYZ company! It provides the perfect balance between comfort and support. The mattress is so comfortable, I wake up feeling refreshed and energized. The customer service was excellent and I am very satisfied with my purchase. The shipping process was seamless and the delivery was on time. The mattress itself is made of high-quality materials and feels luxurious to touch. It has a deep pocket spring system that helps distribute pressure evenly throughout the body, ensuring proper alignment and support. I"
      }
    }
  }
}