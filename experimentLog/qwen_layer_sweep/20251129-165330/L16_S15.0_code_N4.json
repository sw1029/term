{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 16,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=16 experiment.layer_sweep=[16]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      16
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 15
  },
  "prompt": "Design the interior of a high-end restaurant.\n\nI will design the interior of a high-end restaurant to be sophisticated and inviting. I will use a neutral color palette, like white, beige, and navy blue. For lighting, I will incorporate subtle accent lighting for elegance and warmth. The furniture will include comfortable chairs and upholstered booths. I will incorporate a variety of textures and materials such as wood, leather, and velvet. Finally, modern artwork can be used to enhance the sophisticated atmosphere.",
  "output": {
    "before": "Design the interior of a high-end restaurant.\n\nI will design the interior of a high-end restaurant to be sophisticated and inviting. I will use a neutral color palette, like white, beige, and navy blue. For lighting, I will incorporate subtle accent lighting for elegance and warmth. The furniture will include comfortable chairs and upholstered booths. I will incorporate a variety of textures and materials such as wood, leather, and velvet. Finally, modern artwork can be used to enhance the sophisticated atmosphere. Here is an example of how the interior could look:\n\n1. Entryway: A large marble entryway with a chandelier suspended above it adds grandeur to the entrance. The foyer would have a wooden floor, complemented by a plush carpet in",
    "after": "Design the interior of a high-end restaurant.\n\nI will design the interior of a high-end restaurant to be sophisticated and inviting. I will use a neutral color palette, like white, beige, and navy blue. For lighting, I will incorporate subtle accent lighting for elegance and warmth. The furniture will include comfortable chairs and upholstered booths. I will incorporate a variety of textures and materials such as wood, leather, and velvet. Finally, modern artwork can be used to enhance the sophisticated atmosphere. Here is an overview of the interior design:\n\n1. Entrance: The entrance will be designed with a grand staircase leading up to the restaurant's main dining area. A large, glass door will lead into a reception area with a crystal chandelier and marble"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      1,
      6740,
      3325,
      8912,
      7817,
      4522,
      1662,
      5507,
      8933
    ],
    "f_before": [
      0.0,
      0.0,
      0.23250450193881989,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.11247775703668594,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.0,
      0.18602962791919708,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 4.207361709609628,
    "train_mean_l2": 2.455917120028287,
    "train_mean_l1": 1.3658878586627543,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-165330/feature_std_layer_16.html",
    "mean_std": 0.3307504951953888,
    "max_std": 49.30207443237305
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 15,
      "feature_stats": {
        "indices": [
          0,
          2,
          1,
          6740,
          3325,
          8912,
          7817,
          4522,
          1662,
          5507,
          8933
        ],
        "f_before": [
          0.0,
          0.0,
          0.23250450193881989,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.11247775703668594,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.18602962791919708,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 4120,
            "f_before": 5.019543170928955,
            "f_after": 2.9072649478912354,
            "delta_f": -2.1122782230377197
          },
          {
            "index": 4691,
            "f_before": 2.6321816444396973,
            "f_after": 1.348146677017212,
            "delta_f": -1.2840349674224854
          },
          {
            "index": 2494,
            "f_before": 5.965741157531738,
            "f_after": 5.159191131591797,
            "delta_f": -0.8065500259399414
          },
          {
            "index": 2948,
            "f_before": 3.380725622177124,
            "f_after": 4.094125270843506,
            "delta_f": 0.7133996486663818
          },
          {
            "index": 3200,
            "f_before": 0.435256689786911,
            "f_after": 0.9396675229072571,
            "delta_f": 0.5044108331203461
          },
          {
            "index": 4074,
            "f_before": 2.90865421295166,
            "f_after": 2.446028709411621,
            "delta_f": -0.46262550354003906
          },
          {
            "index": 4209,
            "f_before": 2.1551060676574707,
            "f_after": 2.500812530517578,
            "delta_f": 0.3457064628601074
          },
          {
            "index": 8324,
            "f_before": 1.3617104291915894,
            "f_after": 1.6843127012252808,
            "delta_f": 0.3226022720336914
          },
          {
            "index": 4968,
            "f_before": 0.06794993579387665,
            "f_after": 0.37503936886787415,
            "delta_f": 0.3070894330739975
          },
          {
            "index": 8358,
            "f_before": 0.0,
            "f_after": 0.2994767129421234,
            "delta_f": 0.2994767129421234
          },
          {
            "index": 3493,
            "f_before": 0.0,
            "f_after": 0.27557387948036194,
            "delta_f": 0.27557387948036194
          },
          {
            "index": 3859,
            "f_before": 0.27478307485580444,
            "f_after": 0.0,
            "delta_f": -0.27478307485580444
          },
          {
            "index": 7819,
            "f_before": 0.0,
            "f_after": 0.2729002833366394,
            "delta_f": 0.2729002833366394
          },
          {
            "index": 3607,
            "f_before": 0.0,
            "f_after": 0.26841577887535095,
            "delta_f": 0.26841577887535095
          },
          {
            "index": 2381,
            "f_before": 1.1212356090545654,
            "f_after": 0.8617408275604248,
            "delta_f": -0.2594947814941406
          },
          {
            "index": 3185,
            "f_before": 0.3162122964859009,
            "f_after": 0.5679795145988464,
            "delta_f": 0.25176721811294556
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Design the interior of a high-end restaurant.\n\nI will design the interior of a high-end restaurant to be sophisticated and inviting. I will use a neutral color palette, like white, beige, and navy blue. For lighting, I will incorporate subtle accent lighting for elegance and warmth. The furniture will include comfortable chairs and upholstered booths. I will incorporate a variety of textures and materials such as wood, leather, and velvet. Finally, modern artwork can be used to enhance the sophisticated atmosphere. Here are some key elements that will make this restaurant's interior feel luxurious:\n\n1. Lighting: The main dining area will have high-quality chandeliers that provide ample ambient light. The walls will be painted in a deep shade of navy blue, which",
        "after": "Design the interior of a high-end restaurant.\n\nI will design the interior of a high-end restaurant to be sophisticated and inviting. I will use a neutral color palette, like white, beige, and navy blue. For lighting, I will incorporate subtle accent lighting for elegance and warmth. The furniture will include comfortable chairs and upholstered booths. I will incorporate a variety of textures and materials such as wood, leather, and velvet. Finally, modern artwork can be used to enhance the sophisticated atmosphere. Here's an example of how the interior could look:\n\n1. Entrance: A grand entrance with a large marble foyer with a crystal chandelier hanging above. The walls are painted in a dark grey, complementing the elegant furniture. The chandelier is"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 16,
      "feature_stats": {
        "indices": [
          0,
          2,
          1,
          6740,
          3325,
          8912,
          7817,
          4522,
          1662,
          5507,
          8933
        ],
        "f_before": [
          0.0,
          0.0,
          0.23250450193881989,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.11247775703668594,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.23250450193881989,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.11247775703668594,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.23250450193881989,
            "f_after": 0.23250450193881989,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Design the interior of a high-end restaurant.\n\nI will design the interior of a high-end restaurant to be sophisticated and inviting. I will use a neutral color palette, like white, beige, and navy blue. For lighting, I will incorporate subtle accent lighting for elegance and warmth. The furniture will include comfortable chairs and upholstered booths. I will incorporate a variety of textures and materials such as wood, leather, and velvet. Finally, modern artwork can be used to enhance the sophisticated atmosphere. Here is a breakdown of the different elements:\n\n1. Entrance: A grand entrance with an arched entryway, a crystal chandelier, and a large marble fireplace will set the tone for the upscale dining experience. The entrance will be flanked by",
        "after": "Design the interior of a high-end restaurant.\n\nI will design the interior of a high-end restaurant to be sophisticated and inviting. I will use a neutral color palette, like white, beige, and navy blue. For lighting, I will incorporate subtle accent lighting for elegance and warmth. The furniture will include comfortable chairs and upholstered booths. I will incorporate a variety of textures and materials such as wood, leather, and velvet. Finally, modern artwork can be used to enhance the sophisticated atmosphere. Here are some key elements that would define the interior:\n\n1. Entrance: A grand entrance with a soaring ceiling, crystal chandeliers, and a large mirror above the door. A staircase leading up to the main dining area is also visible from the"
      }
    }
  }
}