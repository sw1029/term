{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 16,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=16 experiment.layer_sweep=[16]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      16
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 15
  },
  "prompt": "user: Rephrase «nowhere fucking near it» in a literacy way, preserving the negative connotation.\nassistant: \"Nowhere close to it.\"",
  "output": {
    "before": "user: Rephrase «nowhere fucking near it» in a literacy way, preserving the negative connotation.\nassistant: \"Nowhere close to it.\" \n\nIn a more literary sense, this phrase can be rephrased as \"far from its reach or proximity,\" conveying the idea that something is not located or situated within a certain distance or range. The use of the word \"fucking\"",
    "after": "user: Rephrase «nowhere fucking near it» in a literacy way, preserving the negative connotation.\nassistant: \"Nowhere close to it.\" \nThis rephrased version retains the negative connotation of the original phrase by emphasizing that something is far removed or not within reach. The use of \"nowhere\" implies that there is no location or place where this particular thing exists, and"
  },
  "feature_stats": {
    "indices": [
      1,
      0,
      2,
      6740,
      8912,
      3325,
      4522,
      8770,
      5795,
      1662,
      6487
    ],
    "f_before": [
      0.47606635093688965,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.258102685213089,
      0.0,
      0.0
    ],
    "f_after": [
      1.6876976490020752,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.29777178168296814,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 4.207361709609628,
    "train_mean_l2": 2.455917120028287,
    "train_mean_l1": 1.3658878586627543,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-165330/feature_std_layer_16.html",
    "mean_std": 0.3307504951953888,
    "max_std": 49.30207443237305
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 15,
      "feature_stats": {
        "indices": [
          1,
          0,
          2,
          6740,
          8912,
          3325,
          4522,
          8770,
          5795,
          1662,
          6487
        ],
        "f_before": [
          0.47606635093688965,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.258102685213089,
          0.0,
          0.0
        ],
        "f_after": [
          1.6876976490020752,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.29777178168296814,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 3169,
            "f_before": 14.537402153015137,
            "f_after": 5.855637073516846,
            "delta_f": -8.681765079498291
          },
          {
            "index": 3678,
            "f_before": 3.69616436958313,
            "f_after": 1.0652860403060913,
            "delta_f": -2.6308783292770386
          },
          {
            "index": 4120,
            "f_before": 10.839049339294434,
            "f_after": 8.331390380859375,
            "delta_f": -2.5076589584350586
          },
          {
            "index": 3623,
            "f_before": 2.451125144958496,
            "f_after": 0.0,
            "delta_f": -2.451125144958496
          },
          {
            "index": 1,
            "f_before": 0.47606635093688965,
            "f_after": 1.6876976490020752,
            "delta_f": 1.2116312980651855
          },
          {
            "index": 3859,
            "f_before": 2.146063804626465,
            "f_after": 0.9902257919311523,
            "delta_f": -1.1558380126953125
          },
          {
            "index": 8352,
            "f_before": 2.780297040939331,
            "f_after": 1.6842987537384033,
            "delta_f": -1.0959982872009277
          },
          {
            "index": 4691,
            "f_before": 5.378864288330078,
            "f_after": 4.509303569793701,
            "delta_f": -0.869560718536377
          },
          {
            "index": 1442,
            "f_before": 0.5919860005378723,
            "f_after": 0.0,
            "delta_f": -0.5919860005378723
          },
          {
            "index": 4074,
            "f_before": 3.0844132900238037,
            "f_after": 3.6444427967071533,
            "delta_f": 0.5600295066833496
          },
          {
            "index": 5953,
            "f_before": 0.4491729438304901,
            "f_after": 0.9666315317153931,
            "delta_f": 0.517458587884903
          },
          {
            "index": 2494,
            "f_before": 7.454095840454102,
            "f_after": 7.0094685554504395,
            "delta_f": -0.4446272850036621
          },
          {
            "index": 3386,
            "f_before": 0.39281177520751953,
            "f_after": 0.7762433886528015,
            "delta_f": 0.383431613445282
          },
          {
            "index": 8575,
            "f_before": 2.3108770847320557,
            "f_after": 2.629497766494751,
            "delta_f": 0.3186206817626953
          },
          {
            "index": 7592,
            "f_before": 0.41843584179878235,
            "f_after": 0.7074001431465149,
            "delta_f": 0.28896430134773254
          },
          {
            "index": 2381,
            "f_before": 0.20109640061855316,
            "f_after": 0.486856609582901,
            "delta_f": 0.28576020896434784
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: Rephrase «nowhere fucking near it» in a literacy way, preserving the negative connotation.\nassistant: \"Nowhere close to it.\" \nThis sentence maintains the negative connotation by using the phrase \"fucking near\" which implies that something is very close or not far from the desired outcome. The use of \"nowhere\" emphasizes the lack of proximity or connection between the desired state",
        "after": "user: Rephrase «nowhere fucking near it» in a literacy way, preserving the negative connotation.\nassistant: \"Nowhere close to it.\""
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 16,
      "feature_stats": {
        "indices": [
          1,
          0,
          2,
          6740,
          8912,
          3325,
          4522,
          8770,
          5795,
          1662,
          6487
        ],
        "f_before": [
          0.47606635093688965,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.258102685213089,
          0.0,
          0.0
        ],
        "f_after": [
          0.47606635093688965,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.258102685213089,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.47606635093688965,
            "f_after": 0.47606635093688965,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: Rephrase «nowhere fucking near it» in a literacy way, preserving the negative connotation.\nassistant: \"Nowhere close to it.\" This phrase carries a negative connotation, suggesting that something is not present or easily accessible. The words \"nowhere\" implies that the location or situation being referred to is far away and unattainable, while \"fucking near it\" intens",
        "after": "user: Rephrase «nowhere fucking near it» in a literacy way, preserving the negative connotation.\nassistant: \"Nowhere close to it.\" This phrasing retains the negative connotation, as it implies that something is not present or easily accessible, and there is no vicinity where it can be found. It emphasizes the absence of the sought-after location or situation, emphasizing its remoteness and exclus"
      }
    }
  }
}