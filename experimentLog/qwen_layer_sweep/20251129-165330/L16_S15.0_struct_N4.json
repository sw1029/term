{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 16,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=16 experiment.layer_sweep=[16]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      16
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 15
  },
  "prompt": "Design the interior of a high-end restaurant.\n\nI will design the interior of a high-end restaurant to be sophisticated and inviting. I will use a neutral color palette, like white, beige, and navy blue. For lighting, I will incorporate subtle accent lighting for elegance and warmth. The furniture will include comfortable chairs and upholstered booths. I will incorporate a variety of textures and materials such as wood, leather, and velvet. Finally, modern artwork can be used to enhance the sophisticated atmosphere.",
  "output": {
    "before": "Design the interior of a high-end restaurant.\n\nI will design the interior of a high-end restaurant to be sophisticated and inviting. I will use a neutral color palette, like white, beige, and navy blue. For lighting, I will incorporate subtle accent lighting for elegance and warmth. The furniture will include comfortable chairs and upholstered booths. I will incorporate a variety of textures and materials such as wood, leather, and velvet. Finally, modern artwork can be used to enhance the sophisticated atmosphere. Here is an example of how the interior could look:\n\n1. Entrance: A grand entrance with a tall glass front door that leads into a spacious lobby area. The lobby will have a large chandelier made of crystal or marble, suspended from the ceiling",
    "after": "Design the interior of a high-end restaurant.\n\nI will design the interior of a high-end restaurant to be sophisticated and inviting. I will use a neutral color palette, like white, beige, and navy blue. For lighting, I will incorporate subtle accent lighting for elegance and warmth. The furniture will include comfortable chairs and upholstered booths. I will incorporate a variety of textures and materials such as wood, leather, and velvet. Finally, modern artwork can be used to enhance the sophisticated atmosphere. Here is an example design:\n\n1. Entrance: A grand entrance with a glass door that leads into a foyer with dim lighting and marble flooring. A large chandelier hanging above the entrance will add drama and elegance. The foyer will be flanked by"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      1,
      6740,
      3325,
      1662,
      4522,
      7817,
      7938,
      8912,
      3673
    ],
    "f_before": [
      0.0,
      0.0,
      0.23250450193881989,
      0.0,
      0.0,
      0.11247775703668594,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.08698437362909317,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 4.207361709609628,
    "train_mean_l2": 2.455917120028287,
    "train_mean_l1": 1.3658878586627543,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-165330/feature_std_layer_16.html",
    "mean_std": 0.3307504951953888,
    "max_std": 49.30207443237305
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 15,
      "feature_stats": {
        "indices": [
          2,
          0,
          1,
          6740,
          3325,
          1662,
          4522,
          7817,
          7938,
          8912,
          3673
        ],
        "f_before": [
          0.0,
          0.0,
          0.23250450193881989,
          0.0,
          0.0,
          0.11247775703668594,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.08698437362909317,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 4120,
            "f_before": 5.019543170928955,
            "f_after": 2.5126330852508545,
            "delta_f": -2.5069100856781006
          },
          {
            "index": 4691,
            "f_before": 2.6321816444396973,
            "f_after": 1.2641353607177734,
            "delta_f": -1.3680462837219238
          },
          {
            "index": 2494,
            "f_before": 5.965741157531738,
            "f_after": 5.032370090484619,
            "delta_f": -0.9333710670471191
          },
          {
            "index": 2948,
            "f_before": 3.380725622177124,
            "f_after": 4.0117669105529785,
            "delta_f": 0.6310412883758545
          },
          {
            "index": 3200,
            "f_before": 0.435256689786911,
            "f_after": 0.9021967053413391,
            "delta_f": 0.4669400155544281
          },
          {
            "index": 1834,
            "f_before": 1.061462163925171,
            "f_after": 1.4789807796478271,
            "delta_f": 0.41751861572265625
          },
          {
            "index": 4074,
            "f_before": 2.90865421295166,
            "f_after": 2.532655715942383,
            "delta_f": -0.37599849700927734
          },
          {
            "index": 4968,
            "f_before": 0.06794993579387665,
            "f_after": 0.36313411593437195,
            "delta_f": 0.2951841801404953
          },
          {
            "index": 3607,
            "f_before": 0.0,
            "f_after": 0.2855042815208435,
            "delta_f": 0.2855042815208435
          },
          {
            "index": 8358,
            "f_before": 0.0,
            "f_after": 0.28401538729667664,
            "delta_f": 0.28401538729667664
          },
          {
            "index": 5755,
            "f_before": 0.0,
            "f_after": 0.27945172786712646,
            "delta_f": 0.27945172786712646
          },
          {
            "index": 4209,
            "f_before": 2.1551060676574707,
            "f_after": 2.4319536685943604,
            "delta_f": 0.27684760093688965
          },
          {
            "index": 3859,
            "f_before": 0.27478307485580444,
            "f_after": 0.0,
            "delta_f": -0.27478307485580444
          },
          {
            "index": 7819,
            "f_before": 0.0,
            "f_after": 0.2707683742046356,
            "delta_f": 0.2707683742046356
          },
          {
            "index": 3185,
            "f_before": 0.3162122964859009,
            "f_after": 0.5634390711784363,
            "delta_f": 0.2472267746925354
          },
          {
            "index": 1,
            "f_before": 0.23250450193881989,
            "f_after": 0.0,
            "delta_f": -0.23250450193881989
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Design the interior of a high-end restaurant.\n\nI will design the interior of a high-end restaurant to be sophisticated and inviting. I will use a neutral color palette, like white, beige, and navy blue. For lighting, I will incorporate subtle accent lighting for elegance and warmth. The furniture will include comfortable chairs and upholstered booths. I will incorporate a variety of textures and materials such as wood, leather, and velvet. Finally, modern artwork can be used to enhance the sophisticated atmosphere. \n\nThe entrance to the restaurant will be grand and elegant with a large glass front door that leads into a spacious reception area. The reception area will feature a polished marble floor, plush seating, and a large chandelier hanging above the counter. A glass",
        "after": "Design the interior of a high-end restaurant.\n\nI will design the interior of a high-end restaurant to be sophisticated and inviting. I will use a neutral color palette, like white, beige, and navy blue. For lighting, I will incorporate subtle accent lighting for elegance and warmth. The furniture will include comfortable chairs and upholstered booths. I will incorporate a variety of textures and materials such as wood, leather, and velvet. Finally, modern artwork can be used to enhance the sophisticated atmosphere. Here is an example of how the interior could look:\n\n1. Entryway: A large entryway with a grand piano and chandelier would greet guests upon arrival. The piano would serve as a focal point, adding drama to the space. The ch"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 16,
      "feature_stats": {
        "indices": [
          2,
          0,
          1,
          6740,
          3325,
          1662,
          4522,
          7817,
          7938,
          8912,
          3673
        ],
        "f_before": [
          0.0,
          0.0,
          0.23250450193881989,
          0.0,
          0.0,
          0.11247775703668594,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.23250450193881989,
          0.0,
          0.0,
          0.11247775703668594,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.23250450193881989,
            "f_after": 0.23250450193881989,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Design the interior of a high-end restaurant.\n\nI will design the interior of a high-end restaurant to be sophisticated and inviting. I will use a neutral color palette, like white, beige, and navy blue. For lighting, I will incorporate subtle accent lighting for elegance and warmth. The furniture will include comfortable chairs and upholstered booths. I will incorporate a variety of textures and materials such as wood, leather, and velvet. Finally, modern artwork can be used to enhance the sophisticated atmosphere. Here are some specific details:\n\n1. Layout: The restaurant will have a large open-concept space with a bar area at one end, followed by an elegant dining room on the other side. The bar area will feature sleek wooden tables, stools,",
        "after": "Design the interior of a high-end restaurant.\n\nI will design the interior of a high-end restaurant to be sophisticated and inviting. I will use a neutral color palette, like white, beige, and navy blue. For lighting, I will incorporate subtle accent lighting for elegance and warmth. The furniture will include comfortable chairs and upholstered booths. I will incorporate a variety of textures and materials such as wood, leather, and velvet. Finally, modern artwork can be used to enhance the sophisticated atmosphere. Here is an example of what the interior might look like:\n\n1. Entryway: A grand entrance with a tall ceiling and elegant chandelier hanging above. A marble or hardwood floor adds a luxurious touch. A coat rack or shoe rack is placed near"
      }
    }
  }
}