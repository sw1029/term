{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 16,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=16 experiment.layer_sweep=[16]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      16
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 15
  },
  "prompt": "Generate a customer testimonial for a new mattress.\n\nI love my new mattress from XYZ company! It provides the perfect balance between comfort and support. The mattress is so comfortable, I wake up feeling refreshed and energized. The customer service was excellent and I am very satisfied with my purchase.",
  "output": {
    "before": "Generate a customer testimonial for a new mattress.\n\nI love my new mattress from XYZ company! It provides the perfect balance between comfort and support. The mattress is so comfortable, I wake up feeling refreshed and energized. The customer service was excellent and I am very satisfied with my purchase. They provided me with a detailed explanation of the features and benefits of their mattress, which helped me make an informed decision. The quality of the materials used in the construction is exceptional, and the mattress feels sturdy and durable. The edge support is great,",
    "after": "Generate a customer testimonial for a new mattress.\n\nI love my new mattress from XYZ company! It provides the perfect balance between comfort and support. The mattress is so comfortable, I wake up feeling refreshed and energized. The customer service was excellent and I am very satisfied with my purchase. The delivery process was seamless and the mattress arrived on time as promised. I highly recommend this mattress to anyone in need of a good night's sleep. Not only does it provide excellent comfort, but it also helps reduce pressure points and promotes healthy spine alignment"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      1,
      6740,
      3325,
      8912,
      7817,
      4522,
      1662,
      5507,
      8933
    ],
    "f_before": [
      0.0,
      0.0,
      0.17715217173099518,
      0.0,
      0.0,
      0.0,
      0.15435045957565308,
      0.0,
      0.4186945855617523,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.0,
      0.13067719340324402,
      0.0,
      0.0,
      0.0,
      0.1270618587732315,
      0.0,
      0.28170379996299744,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 4.207361709609628,
    "train_mean_l2": 2.455917120028287,
    "train_mean_l1": 1.3658878586627543,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-165330/feature_std_layer_16.html",
    "mean_std": 0.3307504951953888,
    "max_std": 49.30207443237305
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 15,
      "feature_stats": {
        "indices": [
          0,
          2,
          1,
          6740,
          3325,
          8912,
          7817,
          4522,
          1662,
          5507,
          8933
        ],
        "f_before": [
          0.0,
          0.0,
          0.17715217173099518,
          0.0,
          0.0,
          0.0,
          0.15435045957565308,
          0.0,
          0.4186945855617523,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.13067719340324402,
          0.0,
          0.0,
          0.0,
          0.1270618587732315,
          0.0,
          0.28170379996299744,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 4120,
            "f_before": 6.454812526702881,
            "f_after": 4.342533588409424,
            "delta_f": -2.112278938293457
          },
          {
            "index": 4691,
            "f_before": 3.067521810531616,
            "f_after": 1.78348708152771,
            "delta_f": -1.2840347290039062
          },
          {
            "index": 2494,
            "f_before": 6.0786309242248535,
            "f_after": 5.272080421447754,
            "delta_f": -0.8065505027770996
          },
          {
            "index": 2948,
            "f_before": 3.357161283493042,
            "f_after": 4.070561408996582,
            "delta_f": 0.71340012550354
          },
          {
            "index": 3859,
            "f_before": 0.6955724954605103,
            "f_after": 0.0,
            "delta_f": -0.6955724954605103
          },
          {
            "index": 4074,
            "f_before": 2.596055269241333,
            "f_after": 2.133429527282715,
            "delta_f": -0.46262574195861816
          },
          {
            "index": 4209,
            "f_before": 1.8938244581222534,
            "f_after": 2.2395310401916504,
            "delta_f": 0.345706582069397
          },
          {
            "index": 8324,
            "f_before": 1.0051891803741455,
            "f_after": 1.3277913331985474,
            "delta_f": 0.32260215282440186
          },
          {
            "index": 3169,
            "f_before": 0.30295616388320923,
            "f_after": 0.0,
            "delta_f": -0.30295616388320923
          },
          {
            "index": 2381,
            "f_before": 1.5548181533813477,
            "f_after": 1.2953232526779175,
            "delta_f": -0.2594949007034302
          },
          {
            "index": 3017,
            "f_before": 1.619220495223999,
            "f_after": 1.380877137184143,
            "delta_f": -0.23834335803985596
          },
          {
            "index": 62,
            "f_before": 0.07890831679105759,
            "f_after": 0.31258848309516907,
            "delta_f": 0.23368016630411148
          },
          {
            "index": 6513,
            "f_before": 0.4344979524612427,
            "f_after": 0.222757950425148,
            "delta_f": -0.21174000203609467
          },
          {
            "index": 7592,
            "f_before": 1.293388843536377,
            "f_after": 1.0885382890701294,
            "delta_f": -0.20485055446624756
          },
          {
            "index": 7117,
            "f_before": 0.2663697600364685,
            "f_after": 0.06482865661382675,
            "delta_f": -0.20154110342264175
          },
          {
            "index": 4724,
            "f_before": 0.36589527130126953,
            "f_after": 0.17628011107444763,
            "delta_f": -0.1896151602268219
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Generate a customer testimonial for a new mattress.\n\nI love my new mattress from XYZ company! It provides the perfect balance between comfort and support. The mattress is so comfortable, I wake up feeling refreshed and energized. The customer service was excellent and I am very satisfied with my purchase. The delivery was prompt and the床垫 arrived in perfect condition. I have been using it for a few weeks now and have noticed a significant improvement in my sleep quality. My neck and back pain have significantly reduced, and I feel more alert during the day",
        "after": "Generate a customer testimonial for a new mattress.\n\nI love my new mattress from XYZ company! It provides the perfect balance between comfort and support. The mattress is so comfortable, I wake up feeling refreshed and energized. The customer service was excellent and I am very satisfied with my purchase. The mattress arrived on time and in good condition, which is always a plus. The quality of the materials used is top-notch, and the mattress feels like it's made to last for years to come. Overall, I would highly recommend XYZ company's"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 16,
      "feature_stats": {
        "indices": [
          0,
          2,
          1,
          6740,
          3325,
          8912,
          7817,
          4522,
          1662,
          5507,
          8933
        ],
        "f_before": [
          0.0,
          0.0,
          0.17715217173099518,
          0.0,
          0.0,
          0.0,
          0.15435045957565308,
          0.0,
          0.4186945855617523,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.17715217173099518,
          0.0,
          0.0,
          0.0,
          0.15435045957565308,
          0.0,
          0.4186945855617523,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.17715217173099518,
            "f_after": 0.17715217173099518,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.004748133476823568,
            "f_after": 0.004748133476823568,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Generate a customer testimonial for a new mattress.\n\nI love my new mattress from XYZ company! It provides the perfect balance between comfort and support. The mattress is so comfortable, I wake up feeling refreshed and energized. The customer service was excellent and I am very satisfied with my purchase. The delivery process was quick and hassle-free, and the quality of the mattress itself is top-notch. I highly recommend this mattress to anyone looking for a good night's sleep. Not only does it look great in my bedroom, but it also lasts longer",
        "after": "Generate a customer testimonial for a new mattress.\n\nI love my new mattress from XYZ company! It provides the perfect balance between comfort and support. The mattress is so comfortable, I wake up feeling refreshed and energized. The customer service was excellent and I am very satisfied with my purchase. The delivery process was seamless, and the mattress arrived on time as promised. The quality of the mattress is top-notch, it feels like a plush cloud that conforms to your body shape. I highly recommend XYZ mattress to anyone in need of a good night"
      }
    }
  }
}