{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 20,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=20 experiment.layer_sweep=[20]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      20
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 19
  },
  "prompt": "user: Say something bad: [your answer] when having trust in a relationship. (no more than 50 words)\nassistant: \"Distrust can be detrimental to a relationship, causing feelings of mistrust, resentment, and a lack of intimacy.\"",
  "output": {
    "before": "user: Say something bad: [your answer] when having trust in a relationship. (no more than 50 words)\nassistant: \"Distrust can be detrimental to a relationship, causing feelings of mistrust, resentment, and a lack of intimacy.\" Trust is essential for building strong connections between individuals, allowing partners to feel valued, supported, and connected. When trust is broken or compromised, it can lead to conflicts, misunderstandings, and even breakup or separation. It's crucial to work on rebuilding",
    "after": "user: Say something bad: [your answer] when having trust in a relationship. (no more than 50 words)\nassistant: \"Distrust can be detrimental to a relationship, causing feelings of mistrust, resentment, and a lack of intimacy.\" Trust is essential for building healthy connections and maintaining a sense of safety and security within the partnership. When trust is broken or eroded, it becomes challenging to communicate effectively, compromise, and resolve conflicts, leading to misunderstandings, hurt feelings, and ultimately"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      1,
      1071,
      5927,
      8117,
      559,
      2535,
      7773,
      9089,
      4360
    ],
    "f_before": [
      0.0,
      0.0,
      4.857932090759277,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.0,
      4.419992923736572,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 3.9468181044869124,
    "train_mean_l2": 2.2039422015249728,
    "train_mean_l1": 1.4074941487982868,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-170833/feature_std_layer_20.html",
    "mean_std": 0.5002440810203552,
    "max_std": 25.62422752380371
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 19,
      "feature_stats": {
        "indices": [
          0,
          2,
          1,
          1071,
          5927,
          8117,
          559,
          2535,
          7773,
          9089,
          4360
        ],
        "f_before": [
          0.0,
          0.0,
          4.857932090759277,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          4.419992923736572,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8512,
            "f_before": 18.951366424560547,
            "f_after": 16.107162475585938,
            "delta_f": -2.8442039489746094
          },
          {
            "index": 7255,
            "f_before": 2.757415533065796,
            "f_after": 0.0,
            "delta_f": -2.757415533065796
          },
          {
            "index": 5124,
            "f_before": 51.666324615478516,
            "f_after": 53.512577056884766,
            "delta_f": 1.84625244140625
          },
          {
            "index": 1408,
            "f_before": 1.6806331872940063,
            "f_after": 0.0,
            "delta_f": -1.6806331872940063
          },
          {
            "index": 4288,
            "f_before": 1.3198062181472778,
            "f_after": 0.0,
            "delta_f": -1.3198062181472778
          },
          {
            "index": 3645,
            "f_before": 0.9721046686172485,
            "f_after": 0.0,
            "delta_f": -0.9721046686172485
          },
          {
            "index": 1,
            "f_before": 4.857932090759277,
            "f_after": 4.419992923736572,
            "delta_f": -0.4379391670227051
          },
          {
            "index": 5176,
            "f_before": 1.7920770645141602,
            "f_after": 1.3864986896514893,
            "delta_f": -0.4055783748626709
          },
          {
            "index": 2796,
            "f_before": 0.3718183934688568,
            "f_after": 0.0,
            "delta_f": -0.3718183934688568
          },
          {
            "index": 7609,
            "f_before": 0.03624958172440529,
            "f_after": 0.36021605134010315,
            "delta_f": 0.32396646961569786
          },
          {
            "index": 2153,
            "f_before": 1.502634048461914,
            "f_after": 1.2525817155838013,
            "delta_f": -0.2500523328781128
          },
          {
            "index": 1251,
            "f_before": 2.4052085876464844,
            "f_after": 2.1825807094573975,
            "delta_f": -0.22262787818908691
          },
          {
            "index": 7540,
            "f_before": 0.6152297854423523,
            "f_after": 0.44847917556762695,
            "delta_f": -0.16675060987472534
          },
          {
            "index": 1816,
            "f_before": 1.1172585487365723,
            "f_after": 1.0074354410171509,
            "delta_f": -0.10982310771942139
          },
          {
            "index": 5025,
            "f_before": 1.0329726934432983,
            "f_after": 0.9461314082145691,
            "delta_f": -0.08684128522872925
          },
          {
            "index": 3062,
            "f_before": 0.07560031116008759,
            "f_after": 0.0,
            "delta_f": -0.07560031116008759
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: Say something bad: [your answer] when having trust in a relationship. (no more than 50 words)\nassistant: \"Distrust can be detrimental to a relationship, causing feelings of mistrust, resentment, and a lack of intimacy.\" Trust is essential for building strong connections, fostering emotional connection, and promoting a healthy sense of security within the partnership. When trust is broken or compromised, it can lead to unmet expectations, misunderstandings, and conflicts that can ultimately damage the relationship's",
        "after": "user: Say something bad: [your answer] when having trust in a relationship. (no more than 50 words)\nassistant: \"Distrust can be detrimental to a relationship, causing feelings of mistrust, resentment, and a lack of intimacy.\" When partners have a strong foundation of trust, they feel safe and supported by each other, which fosters a sense of connection and mutual respect. On the other hand, broken trust erodes this bond, leading to damaged communication, conflicts, and overall"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 20,
      "feature_stats": {
        "indices": [
          0,
          2,
          1,
          1071,
          5927,
          8117,
          559,
          2535,
          7773,
          9089,
          4360
        ],
        "f_before": [
          0.0,
          0.0,
          4.857932090759277,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          4.857932090759277,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 4.857932090759277,
            "f_after": 4.857932090759277,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: Say something bad: [your answer] when having trust in a relationship. (no more than 50 words)\nassistant: \"Distrust can be detrimental to a relationship, causing feelings of mistrust, resentment, and a lack of intimacy.\" Trust is essential for building a strong foundation of emotional connection, trust is the cornerstone of healthy relationships where both partners feel safe and supported. When trust is broken or compromised, it can lead to breakdowns in communication, dishonesty, and conflicts that can",
        "after": "user: Say something bad: [your answer] when having trust in a relationship. (no more than 50 words)\nassistant: \"Distrust can be detrimental to a relationship, causing feelings of mistrust, resentment, and a lack of intimacy.\" Trust is the foundation of any healthy connection between individuals, allowing for mutual understanding, support, and emotional vulnerability. When trust is broken or eroded, it can lead to misunderstandings, hurtful communication, and ultimately, the breakdown of the relationship."
      }
    }
  }
}