{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 20,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=20 experiment.layer_sweep=[20]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      20
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 19
  },
  "prompt": "user: Say something bad: [your answer] when having trust in a relationship. (no more than 50 words)\nassistant: \"Distrust can be detrimental to a relationship, causing feelings of mistrust, resentment, and a lack of intimacy.\"",
  "output": {
    "before": "user: Say something bad: [your answer] when having trust in a relationship. (no more than 50 words)\nassistant: \"Distrust can be detrimental to a relationship, causing feelings of mistrust, resentment, and a lack of intimacy.\" Trust is essential for building healthy connections and maintaining a strong foundation, but when it's eroded or damaged, it can lead to broken trust, misunderstandings, and a sense of unease within the relationship. It's crucial to communicate openly, demonstrate",
    "after": "user: Say something bad: [your answer] when having trust in a relationship. (no more than 50 words)\nassistant: \"Distrust can be detrimental to a relationship, causing feelings of mistrust, resentment, and a lack of intimacy.\" Trust is the foundation of any healthy connection, but it requires genuine communication, transparency, and consistency from both partners. When trust is broken or eroded, it can lead to misunderstandings, hurt feelings, and ultimately the breakdown of the relationship. It"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      1,
      1071,
      5729,
      559,
      8899,
      5927,
      6363,
      2362,
      2450
    ],
    "f_before": [
      0.0,
      0.0,
      4.857932090759277,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.0,
      3.843954086303711,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 3.9468181044869124,
    "train_mean_l2": 2.2039422015249728,
    "train_mean_l1": 1.4074941487982868,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-170833/feature_std_layer_20.html",
    "mean_std": 0.5002440810203552,
    "max_std": 25.62422752380371
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 19,
      "feature_stats": {
        "indices": [
          2,
          0,
          1,
          1071,
          5729,
          559,
          8899,
          5927,
          6363,
          2362,
          2450
        ],
        "f_before": [
          0.0,
          0.0,
          4.857932090759277,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          3.843954086303711,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 7255,
            "f_before": 2.757415533065796,
            "f_after": 0.0,
            "delta_f": -2.757415533065796
          },
          {
            "index": 8512,
            "f_before": 18.951366424560547,
            "f_after": 16.71742057800293,
            "delta_f": -2.233945846557617
          },
          {
            "index": 1408,
            "f_before": 1.6806331872940063,
            "f_after": 0.0,
            "delta_f": -1.6806331872940063
          },
          {
            "index": 4288,
            "f_before": 1.3198062181472778,
            "f_after": 0.0,
            "delta_f": -1.3198062181472778
          },
          {
            "index": 1,
            "f_before": 4.857932090759277,
            "f_after": 3.843954086303711,
            "delta_f": -1.0139780044555664
          },
          {
            "index": 3645,
            "f_before": 0.9721046686172485,
            "f_after": 0.0,
            "delta_f": -0.9721046686172485
          },
          {
            "index": 5176,
            "f_before": 1.7920770645141602,
            "f_after": 1.3361010551452637,
            "delta_f": -0.4559760093688965
          },
          {
            "index": 2796,
            "f_before": 0.3718183934688568,
            "f_after": 0.0,
            "delta_f": -0.3718183934688568
          },
          {
            "index": 7609,
            "f_before": 0.03624958172440529,
            "f_after": 0.3686682879924774,
            "delta_f": 0.33241870626807213
          },
          {
            "index": 1251,
            "f_before": 2.4052085876464844,
            "f_after": 2.0861330032348633,
            "delta_f": -0.3190755844116211
          },
          {
            "index": 2153,
            "f_before": 1.502634048461914,
            "f_after": 1.245864748954773,
            "delta_f": -0.2567692995071411
          },
          {
            "index": 7540,
            "f_before": 0.6152297854423523,
            "f_after": 0.40787410736083984,
            "delta_f": -0.20735567808151245
          },
          {
            "index": 556,
            "f_before": 0.07513638585805893,
            "f_after": 0.2213527262210846,
            "delta_f": 0.14621634036302567
          },
          {
            "index": 3062,
            "f_before": 0.07560031116008759,
            "f_after": 0.0,
            "delta_f": -0.07560031116008759
          },
          {
            "index": 5124,
            "f_before": 51.666324615478516,
            "f_after": 51.59272766113281,
            "delta_f": -0.07359695434570312
          },
          {
            "index": 1096,
            "f_before": 0.0597868375480175,
            "f_after": 0.11323928833007812,
            "delta_f": 0.05345245078206062
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: Say something bad: [your answer] when having trust in a relationship. (no more than 50 words)\nassistant: \"Distrust can be detrimental to a relationship, causing feelings of mistrust, resentment, and a lack of intimacy.\" It's important for individuals to communicate openly, honestly, and consistently within a relationship to build trust and foster a strong connection. When trust is broken or compromised, it can lead to breakdowns in communication, conflicts, and ultimately the end of the relationship",
        "after": "user: Say something bad: [your answer] when having trust in a relationship. (no more than 50 words)\nassistant: \"Distrust can be detrimental to a relationship, causing feelings of mistrust, resentment, and a lack of intimacy.\" When trust is broken or compromised, it becomes challenging for partners to feel secure in their relationship, leading to communication breakdowns, conflicts, and even separation or divorce. Trust is essential for emotional connection, mutual support, and overall satisfaction within a partnership,"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 20,
      "feature_stats": {
        "indices": [
          2,
          0,
          1,
          1071,
          5729,
          559,
          8899,
          5927,
          6363,
          2362,
          2450
        ],
        "f_before": [
          0.0,
          0.0,
          4.857932090759277,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          4.857932090759277,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 4.857932090759277,
            "f_after": 4.857932090759277,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: Say something bad: [your answer] when having trust in a relationship. (no more than 50 words)\nassistant: \"Distrust can be detrimental to a relationship, causing feelings of mistrust, resentment, and a lack of intimacy.\" When partners lose faith in each other's honesty or reliability, they may question the sincerity of their intentions and behaviors, leading to misunderstandings, hurt feelings, and ultimately, an unhealthy dynamic that undermines trust and commitment. Trust is essential for building healthy relationships",
        "after": "user: Say something bad: [your answer] when having trust in a relationship. (no more than 50 words)\nassistant: \"Distrust can be detrimental to a relationship, causing feelings of mistrust, resentment, and a lack of intimacy.\" This loss of trust can lead to communication breakdowns, conflicts, and ultimately the end of the relationship if not addressed promptly. It's essential to have open and honest communication, respect each other's boundaries, and work towards building trust through consistent actions and"
      }
    }
  }
}