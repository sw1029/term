{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 12,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=12 experiment.layer_sweep=[12]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Categorize this article into one of the seven news genres.\n\nThe country has been facing a shortage of medical supplies for weeks now. Hospitals have been forced to turn away patients for the lack of necessary equipment, and the government has been scrambling to find a solution.\n\nCategory: News, Politics & Government.",
  "output": {
    "before": "Categorize this article into one of the seven news genres.\n\nThe country has been facing a shortage of medical supplies for weeks now. Hospitals have been forced to turn away patients for the lack of necessary equipment, and the government has been scrambling to find a solution.\n\nCategory: News, Politics & Government.",
    "after": "Categorize this article into one of the seven news genres.\n\nThe country has been facing a shortage of medical supplies for weeks now. Hospitals have been forced to turn away patients for the lack of necessary equipment, and the government has been scrambling to find a solution.\n\nCategory: News, Politics & Government."
  },
  "feature_stats": {
    "indices": [
      1,
      0,
      2,
      5836,
      2346,
      8843,
      2225,
      4587,
      4028,
      8499,
      2627
    ],
    "f_before": [
      0.0,
      0.0,
      0.24681586027145386,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.03376021981239319,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.0,
      0.3468444347381592,
      0.0,
      0.04716956242918968,
      0.0,
      0.06702858209609985,
      0.0,
      0.08130261301994324,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 1.852175078306347,
    "train_mean_l2": 0.6640887608444318,
    "train_mean_l1": 0.8559672760283574,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-163903/feature_std_layer_12.html",
    "mean_std": 0.20368662476539612,
    "max_std": 26.30705451965332
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          1,
          0,
          2,
          5836,
          2346,
          8843,
          2225,
          4587,
          4028,
          8499,
          2627
        ],
        "f_before": [
          0.0,
          0.0,
          0.24681586027145386,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.03376021981239319,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.3468444347381592,
          0.0,
          0.04716956242918968,
          0.0,
          0.06702858209609985,
          0.0,
          0.08130261301994324,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 4558,
            "f_before": 2.547130823135376,
            "f_after": 0.0,
            "delta_f": -2.547130823135376
          },
          {
            "index": 634,
            "f_before": 7.767157554626465,
            "f_after": 5.483939170837402,
            "delta_f": -2.2832183837890625
          },
          {
            "index": 2126,
            "f_before": 8.05281925201416,
            "f_after": 5.963840007781982,
            "delta_f": -2.0889792442321777
          },
          {
            "index": 4296,
            "f_before": 1.8113924264907837,
            "f_after": 0.0,
            "delta_f": -1.8113924264907837
          },
          {
            "index": 3851,
            "f_before": 1.767651081085205,
            "f_after": 0.0,
            "delta_f": -1.767651081085205
          },
          {
            "index": 7274,
            "f_before": 1.5300055742263794,
            "f_after": 0.0,
            "delta_f": -1.5300055742263794
          },
          {
            "index": 7205,
            "f_before": 1.0395886898040771,
            "f_after": 0.0,
            "delta_f": -1.0395886898040771
          },
          {
            "index": 1905,
            "f_before": 0.8174827098846436,
            "f_after": 0.0,
            "delta_f": -0.8174827098846436
          },
          {
            "index": 1979,
            "f_before": 0.6520900726318359,
            "f_after": 0.0,
            "delta_f": -0.6520900726318359
          },
          {
            "index": 4095,
            "f_before": 0.4885724186897278,
            "f_after": 0.0,
            "delta_f": -0.4885724186897278
          },
          {
            "index": 4493,
            "f_before": 0.374396950006485,
            "f_after": 0.0,
            "delta_f": -0.374396950006485
          },
          {
            "index": 948,
            "f_before": 0.31837308406829834,
            "f_after": 0.0,
            "delta_f": -0.31837308406829834
          },
          {
            "index": 7281,
            "f_before": 0.5145240426063538,
            "f_after": 0.28005450963974,
            "delta_f": -0.23446953296661377
          },
          {
            "index": 5179,
            "f_before": 0.14788459241390228,
            "f_after": 0.0,
            "delta_f": -0.14788459241390228
          },
          {
            "index": 8474,
            "f_before": 0.03414108604192734,
            "f_after": 0.1810823380947113,
            "delta_f": 0.14694125205278397
          },
          {
            "index": 365,
            "f_before": 0.5545596480369568,
            "f_after": 0.40886199474334717,
            "delta_f": -0.14569765329360962
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Categorize this article into one of the seven news genres.\n\nThe country has been facing a shortage of medical supplies for weeks now. Hospitals have been forced to turn away patients for the lack of necessary equipment, and the government has been scrambling to find a solution.\n\nCategory: News, Politics & Government.",
        "after": "Categorize this article into one of the seven news genres.\n\nThe country has been facing a shortage of medical supplies for weeks now. Hospitals have been forced to turn away patients for the lack of necessary equipment, and the government has been scrambling to find a solution.\n\nCategory: News, Politics & Government. \n\nExplanation: The article discusses the issue of a shortage of medical supplies in a specific country and how it is affecting hospitals and the government's efforts to address the situation. It highlights the importance of having reliable and adequate medical supplies for public health and safety"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          1,
          0,
          2,
          5836,
          2346,
          8843,
          2225,
          4587,
          4028,
          8499,
          2627
        ],
        "f_before": [
          0.0,
          0.0,
          0.24681586027145386,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.03376021981239319,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.24681586027145386,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.03376021981239319,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.1478457748889923,
            "f_after": 0.1478457748889923,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.054103314876556396,
            "f_after": 0.054103314876556396,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.24681586027145386,
            "f_after": 0.24681586027145386,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Categorize this article into one of the seven news genres.\n\nThe country has been facing a shortage of medical supplies for weeks now. Hospitals have been forced to turn away patients for the lack of necessary equipment, and the government has been scrambling to find a solution.\n\nCategory: News, Politics & Government. \n\nExplanation: The article discusses a national crisis related to the shortage of medical supplies in a specific country, which falls under the category of \"News\" as it reports on a significant event that affects public health and is therefore of interest to the general public",
        "after": "Categorize this article into one of the seven news genres.\n\nThe country has been facing a shortage of medical supplies for weeks now. Hospitals have been forced to turn away patients for the lack of necessary equipment, and the government has been scrambling to find a solution.\n\nCategory: News, Politics & Government. \n\nExplanation: The article discusses the situation in a country where there is a shortage of medical supplies, specifically medical equipment. It mentions that hospitals are struggling to provide adequate care to their patients due to a lack of resources, and the government is taking action"
      }
    }
  }
}