{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 12,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=12 experiment.layer_sweep=[12]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Generate a scene description for a zoo full of robots.\n\nThe zoo was filled with a variety of robotic creatures, all of them moving and whirring in strange and unexpected ways. There were robotic lions with eyes that glowed purple, robotic bears that could roll around, and robotic parrots that sang in a metallic voice. Everywhere you looked, robots were interacting with each other and it was strange yet oddly fascinating.",
  "output": {
    "before": "Generate a scene description for a zoo full of robots.\n\nThe zoo was filled with a variety of robotic creatures, all of them moving and whirring in strange and unexpected ways. There were robotic lions with eyes that glowed purple, robotic bears that could roll around, and robotic parrots that sang in a metallic voice. Everywhere you looked, robots were interacting with each other and it was strange yet oddly fascinating. \n\nAs you walked through the zoo, you saw robots working tirelessly to keep the animals well-fed and happy. Some robots were carrying food and water, while others were cleaning up after the animals or performing maintenance tasks. There were even robots that interacted",
    "after": "Generate a scene description for a zoo full of robots.\n\nThe zoo was filled with a variety of robotic creatures, all of them moving and whirring in strange and unexpected ways. There were robotic lions with eyes that glowed purple, robotic bears that could roll around, and robotic parrots that sang in a metallic voice. Everywhere you looked, robots were interacting with each other and it was strange yet oddly fascinating. \n\nSome robots had sensors that allowed them to sense their surroundings and adjust their movements accordingly. Others had built-in cameras that captured images and videos of the animals they interacted with. Some robots even had AI systems that monitored their behavior and adjusted their responses"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      1,
      8843,
      5836,
      2225,
      2346,
      4028,
      4587,
      8499,
      4766
    ],
    "f_before": [
      0.18067920207977295,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.5008030533790588,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 1.852175078306347,
    "train_mean_l2": 0.6640887608444318,
    "train_mean_l1": 0.8559672760283574,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-163903/feature_std_layer_12.html",
    "mean_std": 0.20368662476539612,
    "max_std": 26.30705451965332
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          2,
          0,
          1,
          8843,
          5836,
          2225,
          2346,
          4028,
          4587,
          8499,
          4766
        ],
        "f_before": [
          0.18067920207977295,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.5008030533790588,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 634,
            "f_before": 7.125733375549316,
            "f_after": 4.4063801765441895,
            "delta_f": -2.719353199005127
          },
          {
            "index": 2126,
            "f_before": 7.566887855529785,
            "f_after": 5.777621746063232,
            "delta_f": -1.7892661094665527
          },
          {
            "index": 7274,
            "f_before": 1.3674067258834839,
            "f_after": 0.0,
            "delta_f": -1.3674067258834839
          },
          {
            "index": 4558,
            "f_before": 1.021317481994629,
            "f_after": 0.0,
            "delta_f": -1.021317481994629
          },
          {
            "index": 4296,
            "f_before": 1.0040448904037476,
            "f_after": 0.0,
            "delta_f": -1.0040448904037476
          },
          {
            "index": 3851,
            "f_before": 0.7553592324256897,
            "f_after": 0.0,
            "delta_f": -0.7553592324256897
          },
          {
            "index": 365,
            "f_before": 0.6528562903404236,
            "f_after": 1.0870035886764526,
            "delta_f": 0.43414729833602905
          },
          {
            "index": 3127,
            "f_before": 3.186291456222534,
            "f_after": 3.5245792865753174,
            "delta_f": 0.3382878303527832
          },
          {
            "index": 1979,
            "f_before": 0.33414706587791443,
            "f_after": 0.0,
            "delta_f": -0.33414706587791443
          },
          {
            "index": 2,
            "f_before": 0.18067920207977295,
            "f_after": 0.5008030533790588,
            "delta_f": 0.3201238512992859
          },
          {
            "index": 7205,
            "f_before": 0.18987612426280975,
            "f_after": 0.0,
            "delta_f": -0.18987612426280975
          },
          {
            "index": 8222,
            "f_before": 0.0471750907599926,
            "f_after": 0.23362170159816742,
            "delta_f": 0.18644661083817482
          },
          {
            "index": 7937,
            "f_before": 0.1062924787402153,
            "f_after": 0.2902814745903015,
            "delta_f": 0.1839889958500862
          },
          {
            "index": 8919,
            "f_before": 0.030747339129447937,
            "f_after": 0.2138391137123108,
            "delta_f": 0.18309177458286285
          },
          {
            "index": 2171,
            "f_before": 0.0,
            "f_after": 0.18139231204986572,
            "delta_f": 0.18139231204986572
          },
          {
            "index": 9181,
            "f_before": 0.08915399014949799,
            "f_after": 0.26924654841423035,
            "delta_f": 0.18009255826473236
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Generate a scene description for a zoo full of robots.\n\nThe zoo was filled with a variety of robotic creatures, all of them moving and whirring in strange and unexpected ways. There were robotic lions with eyes that glowed purple, robotic bears that could roll around, and robotic parrots that sang in a metallic voice. Everywhere you looked, robots were interacting with each other and it was strange yet oddly fascinating. \n\nAs you walked through the exhibits, you saw robots playing musical instruments, performing ballet routines, or even racing against each other in obstacle courses. Some robots had human-like faces, while others had mechanical ones, but they all seemed to be communicating with",
        "after": "Generate a scene description for a zoo full of robots.\n\nThe zoo was filled with a variety of robotic creatures, all of them moving and whirring in strange and unexpected ways. There were robotic lions with eyes that glowed purple, robotic bears that could roll around, and robotic parrots that sang in a metallic voice. Everywhere you looked, robots were interacting with each other and it was strange yet oddly fascinating. Some robots were controlled by humans who programmed their movements and personalities, while others were autonomous, operating on their own without any human intervention. \n\nThe zoo was divided into different zones, each representing a different type of robot: a tank-like robot with a"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          2,
          0,
          1,
          8843,
          5836,
          2225,
          2346,
          4028,
          4587,
          8499,
          4766
        ],
        "f_before": [
          0.18067920207977295,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.18067920207977295,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.005450963042676449,
            "f_after": 0.005450963042676449,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.010996349155902863,
            "f_after": 0.010996349155902863,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.18067920207977295,
            "f_after": 0.18067920207977295,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Generate a scene description for a zoo full of robots.\n\nThe zoo was filled with a variety of robotic creatures, all of them moving and whirring in strange and unexpected ways. There were robotic lions with eyes that glowed purple, robotic bears that could roll around, and robotic parrots that sang in a metallic voice. Everywhere you looked, robots were interacting with each other and it was strange yet oddly fascinating. \n\nAs you walked through the zoo, you saw robots of all shapes and sizes, from tiny robots with delicate limbs to massive robots that towered over you. Some robots had sensors that allowed them to detect your presence and adjust their movements accordingly, while",
        "after": "Generate a scene description for a zoo full of robots.\n\nThe zoo was filled with a variety of robotic creatures, all of them moving and whirring in strange and unexpected ways. There were robotic lions with eyes that glowed purple, robotic bears that could roll around, and robotic parrots that sang in a metallic voice. Everywhere you looked, robots were interacting with each other and it was strange yet oddly fascinating. Some robots were building elaborate structures, while others were playing games or conducting experiments.\nIn the center of the zoo, there was a massive robot stand, towering over the rest of the animals. It was made entirely of metal and had a sleek, futuristic"
      }
    }
  }
}