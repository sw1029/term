{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 12,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=12 experiment.layer_sweep=[12]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Categorize this article into one of the seven news genres.\n\nThe country has been facing a shortage of medical supplies for weeks now. Hospitals have been forced to turn away patients for the lack of necessary equipment, and the government has been scrambling to find a solution.\n\nCategory: News, Politics & Government.",
  "output": {
    "before": "Categorize this article into one of the seven news genres.\n\nThe country has been facing a shortage of medical supplies for weeks now. Hospitals have been forced to turn away patients for the lack of necessary equipment, and the government has been scrambling to find a solution.\n\nCategory: News, Politics & Government.",
    "after": "Categorize this article into one of the seven news genres.\n\nThe country has been facing a shortage of medical supplies for weeks now. Hospitals have been forced to turn away patients for the lack of necessary equipment, and the government has been scrambling to find a solution.\n\nCategory: News, Politics & Government."
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      1,
      8843,
      5836,
      4028,
      4587,
      2225,
      8499,
      2346,
      4766
    ],
    "f_before": [
      0.0,
      0.24681586027145386,
      0.0,
      0.0,
      0.0,
      0.03376021981239319,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.4724309742450714,
      0.0,
      0.0,
      0.0016337772831320763,
      0.15295518934726715,
      0.0,
      0.014112543314695358,
      0.0,
      0.06779785454273224,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 1.852175078306347,
    "train_mean_l2": 0.6640887608444318,
    "train_mean_l1": 0.8559672760283574,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-163903/feature_std_layer_12.html",
    "mean_std": 0.20368662476539612,
    "max_std": 26.30705451965332
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          0,
          2,
          1,
          8843,
          5836,
          4028,
          4587,
          2225,
          8499,
          2346,
          4766
        ],
        "f_before": [
          0.0,
          0.24681586027145386,
          0.0,
          0.0,
          0.0,
          0.03376021981239319,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.4724309742450714,
          0.0,
          0.0,
          0.0016337772831320763,
          0.15295518934726715,
          0.0,
          0.014112543314695358,
          0.0,
          0.06779785454273224,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 4558,
            "f_before": 2.547130823135376,
            "f_after": 0.0,
            "delta_f": -2.547130823135376
          },
          {
            "index": 634,
            "f_before": 7.767157554626465,
            "f_after": 5.265614986419678,
            "delta_f": -2.501542568206787
          },
          {
            "index": 4296,
            "f_before": 1.8113924264907837,
            "f_after": 0.0,
            "delta_f": -1.8113924264907837
          },
          {
            "index": 3851,
            "f_before": 1.767651081085205,
            "f_after": 0.0,
            "delta_f": -1.767651081085205
          },
          {
            "index": 2126,
            "f_before": 8.05281925201416,
            "f_after": 6.329310417175293,
            "delta_f": -1.7235088348388672
          },
          {
            "index": 7274,
            "f_before": 1.5300055742263794,
            "f_after": 0.0,
            "delta_f": -1.5300055742263794
          },
          {
            "index": 7205,
            "f_before": 1.0395886898040771,
            "f_after": 0.0,
            "delta_f": -1.0395886898040771
          },
          {
            "index": 1905,
            "f_before": 0.8174827098846436,
            "f_after": 0.0,
            "delta_f": -0.8174827098846436
          },
          {
            "index": 365,
            "f_before": 0.5545596480369568,
            "f_after": 1.2223336696624756,
            "delta_f": 0.6677740216255188
          },
          {
            "index": 1979,
            "f_before": 0.6520900726318359,
            "f_after": 0.0,
            "delta_f": -0.6520900726318359
          },
          {
            "index": 4095,
            "f_before": 0.4885724186897278,
            "f_after": 0.0,
            "delta_f": -0.4885724186897278
          },
          {
            "index": 4493,
            "f_before": 0.374396950006485,
            "f_after": 0.0,
            "delta_f": -0.374396950006485
          },
          {
            "index": 948,
            "f_before": 0.31837308406829834,
            "f_after": 0.0,
            "delta_f": -0.31837308406829834
          },
          {
            "index": 7281,
            "f_before": 0.5145240426063538,
            "f_after": 0.2692793011665344,
            "delta_f": -0.24524474143981934
          },
          {
            "index": 2,
            "f_before": 0.24681586027145386,
            "f_after": 0.4724309742450714,
            "delta_f": 0.22561511397361755
          },
          {
            "index": 864,
            "f_before": 0.04954281076788902,
            "f_after": 0.24498242139816284,
            "delta_f": 0.19543961063027382
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Categorize this article into one of the seven news genres.\n\nThe country has been facing a shortage of medical supplies for weeks now. Hospitals have been forced to turn away patients for the lack of necessary equipment, and the government has been scrambling to find a solution.\n\nCategory: News, Politics & Government. \n\nExplanation: The article discusses a pressing issue in a national context, which is the shortage of medical supplies and the impact it is having on hospitals. It mentions that the shortage has been ongoing for several weeks, and hospitals are being forced to prioritize patient",
        "after": "Categorize this article into one of the seven news genres.\n\nThe country has been facing a shortage of medical supplies for weeks now. Hospitals have been forced to turn away patients for the lack of necessary equipment, and the government has been scrambling to find a solution.\n\nCategory: News, Politics & Government."
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          0,
          2,
          1,
          8843,
          5836,
          4028,
          4587,
          2225,
          8499,
          2346,
          4766
        ],
        "f_before": [
          0.0,
          0.24681586027145386,
          0.0,
          0.0,
          0.0,
          0.03376021981239319,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.24681586027145386,
          0.0,
          0.0,
          0.0,
          0.03376021981239319,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.1478457748889923,
            "f_after": 0.1478457748889923,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.054103314876556396,
            "f_after": 0.054103314876556396,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.24681586027145386,
            "f_after": 0.24681586027145386,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Categorize this article into one of the seven news genres.\n\nThe country has been facing a shortage of medical supplies for weeks now. Hospitals have been forced to turn away patients for the lack of necessary equipment, and the government has been scrambling to find a solution.\n\nCategory: News, Politics & Government.",
        "after": "Categorize this article into one of the seven news genres.\n\nThe country has been facing a shortage of medical supplies for weeks now. Hospitals have been forced to turn away patients for the lack of necessary equipment, and the government has been scrambling to find a solution.\n\nCategory: News, Politics & Government."
      }
    }
  }
}