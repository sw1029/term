{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 12,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=12 experiment.layer_sweep=[12]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Generate a scene description for a zoo full of robots.\n\nThe zoo was filled with a variety of robotic creatures, all of them moving and whirring in strange and unexpected ways. There were robotic lions with eyes that glowed purple, robotic bears that could roll around, and robotic parrots that sang in a metallic voice. Everywhere you looked, robots were interacting with each other and it was strange yet oddly fascinating.",
  "output": {
    "before": "Generate a scene description for a zoo full of robots.\n\nThe zoo was filled with a variety of robotic creatures, all of them moving and whirring in strange and unexpected ways. There were robotic lions with eyes that glowed purple, robotic bears that could roll around, and robotic parrots that sang in a metallic voice. Everywhere you looked, robots were interacting with each other and it was strange yet oddly fascinating. \n\nAs you walked through the zoo, you saw robots cleaning the exhibits, assembling new displays, and performing maintenance tasks. Some robots were even working alongside humans, helping guide visitors and answering questions about the animals. The air was filled with the sound of",
    "after": "Generate a scene description for a zoo full of robots.\n\nThe zoo was filled with a variety of robotic creatures, all of them moving and whirring in strange and unexpected ways. There were robotic lions with eyes that glowed purple, robotic bears that could roll around, and robotic parrots that sang in a metallic voice. Everywhere you looked, robots were interacting with each other and it was strange yet oddly fascinating. \n\nAs you walked through the enclosure, you saw robots playing games together on giant platforms, robots dancing to electronic beats, and robots racing against each other in obstacle courses. Some robots had large mechanical arms and legs, while others had smaller body parts that"
  },
  "feature_stats": {
    "indices": [
      1,
      0,
      2,
      5836,
      2346,
      8843,
      2225,
      4587,
      4028,
      8499,
      2627
    ],
    "f_before": [
      0.0,
      0.0,
      0.18067920207977295,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.0,
      0.28070786595344543,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 1.852175078306347,
    "train_mean_l2": 0.6640887608444318,
    "train_mean_l1": 0.8559672760283574,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-163903/feature_std_layer_12.html",
    "mean_std": 0.20368662476539612,
    "max_std": 26.30705451965332
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          1,
          0,
          2,
          5836,
          2346,
          8843,
          2225,
          4587,
          4028,
          8499,
          2627
        ],
        "f_before": [
          0.0,
          0.0,
          0.18067920207977295,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.28070786595344543,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 634,
            "f_before": 7.125733375549316,
            "f_after": 4.842513561248779,
            "delta_f": -2.283219814300537
          },
          {
            "index": 2126,
            "f_before": 7.566887855529785,
            "f_after": 5.477908134460449,
            "delta_f": -2.088979721069336
          },
          {
            "index": 7274,
            "f_before": 1.3674067258834839,
            "f_after": 0.0,
            "delta_f": -1.3674067258834839
          },
          {
            "index": 4558,
            "f_before": 1.021317481994629,
            "f_after": 0.0,
            "delta_f": -1.021317481994629
          },
          {
            "index": 4296,
            "f_before": 1.0040448904037476,
            "f_after": 0.0,
            "delta_f": -1.0040448904037476
          },
          {
            "index": 3851,
            "f_before": 0.7553592324256897,
            "f_after": 0.0,
            "delta_f": -0.7553592324256897
          },
          {
            "index": 1979,
            "f_before": 0.33414706587791443,
            "f_after": 0.0,
            "delta_f": -0.33414706587791443
          },
          {
            "index": 1027,
            "f_before": 0.0,
            "f_after": 0.19264696538448334,
            "delta_f": 0.19264696538448334
          },
          {
            "index": 7205,
            "f_before": 0.18987612426280975,
            "f_after": 0.0,
            "delta_f": -0.18987612426280975
          },
          {
            "index": 3888,
            "f_before": 0.0,
            "f_after": 0.1754901260137558,
            "delta_f": 0.1754901260137558
          },
          {
            "index": 4095,
            "f_before": 0.1696513146162033,
            "f_after": 0.0,
            "delta_f": -0.1696513146162033
          },
          {
            "index": 944,
            "f_before": 0.0,
            "f_after": 0.16682441532611847,
            "delta_f": 0.16682441532611847
          },
          {
            "index": 365,
            "f_before": 0.6528562903404236,
            "f_after": 0.5071585774421692,
            "delta_f": -0.1456977128982544
          },
          {
            "index": 8222,
            "f_before": 0.0471750907599926,
            "f_after": 0.18601980805397034,
            "delta_f": 0.13884471729397774
          },
          {
            "index": 2141,
            "f_before": 0.034595049917697906,
            "f_after": 0.17270611226558685,
            "delta_f": 0.13811106234788895
          },
          {
            "index": 897,
            "f_before": 0.041523367166519165,
            "f_after": 0.17801687121391296,
            "delta_f": 0.1364935040473938
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Generate a scene description for a zoo full of robots.\n\nThe zoo was filled with a variety of robotic creatures, all of them moving and whirring in strange and unexpected ways. There were robotic lions with eyes that glowed purple, robotic bears that could roll around, and robotic parrots that sang in a metallic voice. Everywhere you looked, robots were interacting with each other and it was strange yet oddly fascinating. \n\nAs you walked through the zoo, you came across a group of robots playing a musical instrument together. They were programmed to create a beautiful melody using complex algorithms and their movements were precise and fluid. The instruments included a robot violin, a robot c",
        "after": "Generate a scene description for a zoo full of robots.\n\nThe zoo was filled with a variety of robotic creatures, all of them moving and whirring in strange and unexpected ways. There were robotic lions with eyes that glowed purple, robotic bears that could roll around, and robotic parrots that sang in a metallic voice. Everywhere you looked, robots were interacting with each other and it was strange yet oddly fascinating. Some robots were controlled by humans who were guiding them through the exhibits, while others were autonomous drones that buzzed around, keeping track of their surroundings.\nAs you walked through the zoo, you couldn't help but notice the intricate designs on the robots'"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          1,
          0,
          2,
          5836,
          2346,
          8843,
          2225,
          4587,
          4028,
          8499,
          2627
        ],
        "f_before": [
          0.0,
          0.0,
          0.18067920207977295,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.18067920207977295,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.005450963042676449,
            "f_after": 0.005450963042676449,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.010996349155902863,
            "f_after": 0.010996349155902863,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.18067920207977295,
            "f_after": 0.18067920207977295,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Generate a scene description for a zoo full of robots.\n\nThe zoo was filled with a variety of robotic creatures, all of them moving and whirring in strange and unexpected ways. There were robotic lions with eyes that glowed purple, robotic bears that could roll around, and robotic parrots that sang in a metallic voice. Everywhere you looked, robots were interacting with each other and it was strange yet oddly fascinating. \n\nAs you walked through the exhibits, you saw robots performing various acts, from balancing on their hind legs to holding hands with children. Some robots were even programmed to dance and sway, creating a mesmerizing display that left people in awe. The sound",
        "after": "Generate a scene description for a zoo full of robots.\n\nThe zoo was filled with a variety of robotic creatures, all of them moving and whirring in strange and unexpected ways. There were robotic lions with eyes that glowed purple, robotic bears that could roll around, and robotic parrots that sang in a metallic voice. Everywhere you looked, robots were interacting with each other and it was strange yet oddly fascinating. Some robots had mechanical arms that they used to hold onto objects or manipulate objects with precision, while others had long, flexible bodies that allowed them to move through the environment without much effort.\nThere were also robots that were designed for entertainment purposes, like a"
      }
    }
  }
}