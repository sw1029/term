{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 12,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=12 experiment.layer_sweep=[12]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Create a sentence using the given verb and adjective.\n\nVerb: glow\nAdjective: luminous\n\nThe sky was illuminated with a luminous glow.",
  "output": {
    "before": "Create a sentence using the given verb and adjective.\n\nVerb: glow\nAdjective: luminous\n\nThe sky was illuminated with a luminous glow. \n\nIn this sentence, \"glow\" is the verb that describes the action of the sky shining brightly with a bright and shining light. The adjective \"luminous\" describes the quality of this glow, emphasizing its brightness and how it illuminates",
    "after": "Create a sentence using the given verb and adjective.\n\nVerb: glow\nAdjective: luminous\n\nThe sky was illuminated with a luminous glow. \n\nExplanation: \nThe verb \"glow\" means to emit light or shine brightly, and the adjective \"luminous\" describes something that shines brightly and is not obscured by darkness. In this sentence, the sky is described as being illuminated with"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      1,
      8843,
      5836,
      2225,
      2346,
      4028,
      4587,
      8499,
      4766
    ],
    "f_before": [
      0.002298483159393072,
      0.0,
      0.0,
      0.0,
      0.23410755395889282,
      0.1847189962863922,
      0.20078293979167938,
      0.5183507800102234,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.3224220871925354,
      0.0,
      0.0,
      0.0,
      0.2882608473300934,
      0.19869208335876465,
      0.2854657769203186,
      0.6398316025733948,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 1.852175078306347,
    "train_mean_l2": 0.6640887608444318,
    "train_mean_l1": 0.8559672760283574,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-163903/feature_std_layer_12.html",
    "mean_std": 0.20368662476539612,
    "max_std": 26.30705451965332
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          2,
          0,
          1,
          8843,
          5836,
          2225,
          2346,
          4028,
          4587,
          8499,
          4766
        ],
        "f_before": [
          0.002298483159393072,
          0.0,
          0.0,
          0.0,
          0.23410755395889282,
          0.1847189962863922,
          0.20078293979167938,
          0.5183507800102234,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.3224220871925354,
          0.0,
          0.0,
          0.0,
          0.2882608473300934,
          0.19869208335876465,
          0.2854657769203186,
          0.6398316025733948,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 4558,
            "f_before": 8.646282196044922,
            "f_after": 1.8971378803253174,
            "delta_f": -6.7491443157196045
          },
          {
            "index": 4296,
            "f_before": 4.804083347320557,
            "f_after": 2.0525968074798584,
            "delta_f": -2.7514865398406982
          },
          {
            "index": 3851,
            "f_before": 4.802324295043945,
            "f_after": 2.0726959705352783,
            "delta_f": -2.729628324508667
          },
          {
            "index": 634,
            "f_before": 10.425281524658203,
            "f_after": 7.705930233001709,
            "delta_f": -2.719351291656494
          },
          {
            "index": 948,
            "f_before": 2.4800972938537598,
            "f_after": 0.5450158715248108,
            "delta_f": -1.935081422328949
          },
          {
            "index": 7274,
            "f_before": 3.8231654167175293,
            "f_after": 1.8881298303604126,
            "delta_f": -1.9350355863571167
          },
          {
            "index": 2126,
            "f_before": 9.70122241973877,
            "f_after": 7.911957740783691,
            "delta_f": -1.7892646789550781
          },
          {
            "index": 1905,
            "f_before": 3.1977298259735107,
            "f_after": 1.5122301578521729,
            "delta_f": -1.685499668121338
          },
          {
            "index": 4493,
            "f_before": 2.4683616161346436,
            "f_after": 0.8044919967651367,
            "delta_f": -1.6638696193695068
          },
          {
            "index": 7205,
            "f_before": 3.2563815116882324,
            "f_after": 1.665496587753296,
            "delta_f": -1.5908849239349365
          },
          {
            "index": 1979,
            "f_before": 2.3231656551361084,
            "f_after": 1.2477928400039673,
            "delta_f": -1.0753728151321411
          },
          {
            "index": 2862,
            "f_before": 1.4857897758483887,
            "f_after": 0.4619494378566742,
            "delta_f": -1.0238403379917145
          },
          {
            "index": 4095,
            "f_before": 1.1934746503829956,
            "f_after": 0.3280065953731537,
            "delta_f": -0.8654680550098419
          },
          {
            "index": 27,
            "f_before": 0.6956295371055603,
            "f_after": 0.059670086950063705,
            "delta_f": -0.6359594501554966
          },
          {
            "index": 5179,
            "f_before": 1.7377502918243408,
            "f_after": 1.2376911640167236,
            "delta_f": -0.5000591278076172
          },
          {
            "index": 365,
            "f_before": 1.2816041707992554,
            "f_after": 1.7157516479492188,
            "delta_f": 0.4341474771499634
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Create a sentence using the given verb and adjective.\n\nVerb: glow\nAdjective: luminous\n\nThe sky was illuminated with a luminous glow.",
        "after": "Create a sentence using the given verb and adjective.\n\nVerb: glow\nAdjective: luminous\n\nThe sky was illuminated with a luminous glow. \n\nExplanation:\nIn this sentence, \"glow\" is the verb that describes the action of emitting light or brightness, and \"luminous\" is the adjective that adds descriptive detail to the noun \"glow.\" The phrase \"the sky was"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          2,
          0,
          1,
          8843,
          5836,
          2225,
          2346,
          4028,
          4587,
          8499,
          4766
        ],
        "f_before": [
          0.002298483159393072,
          0.0,
          0.0,
          0.0,
          0.23410755395889282,
          0.1847189962863922,
          0.20078293979167938,
          0.5183507800102234,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.002298483159393072,
          0.0,
          0.0,
          0.0,
          0.23410755395889282,
          0.1847189962863922,
          0.20078293979167938,
          0.5183507800102234,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.11278308928012848,
            "f_after": 0.11278308928012848,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.5871439576148987,
            "f_after": 0.5871439576148987,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.17178957164287567,
            "f_after": 0.17178957164287567,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.002298483159393072,
            "f_after": 0.002298483159393072,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Create a sentence using the given verb and adjective.\n\nVerb: glow\nAdjective: luminous\n\nThe sky was illuminated with a luminous glow. \n\nIn this sentence, \"glow\" is the verb that describes the action of the sky shining or shining brightly. The adjective \"luminous\" adds to the description by specifying what the sky looks like in terms of brightness and color. The",
        "after": "Create a sentence using the given verb and adjective.\n\nVerb: glow\nAdjective: luminous\n\nThe sky was illuminated with a luminous glow."
      }
    }
  }
}