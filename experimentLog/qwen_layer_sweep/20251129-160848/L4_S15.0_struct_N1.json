{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 4,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=4 experiment.layer_sweep=[4]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      4
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 3
  },
  "prompt": "Design a logo for the \"Green Earth Society\".\n\nA logo for the \"Green Earth Society\" could be an image of a globe surrounded by green vines and leaves, with the words \"Green Earth Society\" underneath.",
  "output": {
    "before": "Design a logo for the \"Green Earth Society\".\n\nA logo for the \"Green Earth Society\" could be an image of a globe surrounded by green vines and leaves, with the words \"Green Earth Society\" underneath. Here's a description of how this logo might look:\n\n1. Globe: The globe symbolizes the planet earth as the center of the design. It can be depicted in various sizes, from a small circle to a larger globe, depending on the desired",
    "after": "Design a logo for the \"Green Earth Society\".\n\nA logo for the \"Green Earth Society\" could be an image of a globe surrounded by green vines and leaves, with the words \"Green Earth Society\" underneath.\n\n\n\n\nimage\nfrozen\n\ndef_ Green Earth Society\na image_Frozen_Frozen_\n\n\nimage_Frozen_Frozen_\n---)\n\n---    Green_Formalization_Solution_a_Frozen_Frozen------\n\n------    Green_F"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      1,
      47,
      1322,
      6255,
      4920,
      2725,
      925,
      171,
      7702
    ],
    "f_before": [
      0.12887606024742126,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.011244546622037888,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      1.1848392486572266,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.009888553991913795,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 0.31080414372868836,
    "train_mean_l2": 0.0539769138097763,
    "train_mean_l1": 0.02312958190504287,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-160848/feature_std_layer_4.html",
    "mean_std": 0.0009577227174304426,
    "max_std": 0.05453735962510109
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 3,
      "feature_stats": {
        "indices": [
          2,
          0,
          1,
          47,
          1322,
          6255,
          4920,
          2725,
          925,
          171,
          7702
        ],
        "f_before": [
          0.12887606024742126,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.011244546622037888,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          1.1848392486572266,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.009888553991913795,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8314,
            "f_before": 0.0,
            "f_after": 1.685036540031433,
            "delta_f": 1.685036540031433
          },
          {
            "index": 7593,
            "f_before": 0.0,
            "f_after": 1.4877036809921265,
            "delta_f": 1.4877036809921265
          },
          {
            "index": 6260,
            "f_before": 0.0,
            "f_after": 1.481555700302124,
            "delta_f": 1.481555700302124
          },
          {
            "index": 7562,
            "f_before": 0.0,
            "f_after": 1.4564763307571411,
            "delta_f": 1.4564763307571411
          },
          {
            "index": 7577,
            "f_before": 0.0,
            "f_after": 1.4330955743789673,
            "delta_f": 1.4330955743789673
          },
          {
            "index": 2065,
            "f_before": 0.0,
            "f_after": 1.408208966255188,
            "delta_f": 1.408208966255188
          },
          {
            "index": 6029,
            "f_before": 0.0,
            "f_after": 1.370098352432251,
            "delta_f": 1.370098352432251
          },
          {
            "index": 5349,
            "f_before": 0.0,
            "f_after": 1.3678522109985352,
            "delta_f": 1.3678522109985352
          },
          {
            "index": 6487,
            "f_before": 0.0,
            "f_after": 1.2850468158721924,
            "delta_f": 1.2850468158721924
          },
          {
            "index": 1842,
            "f_before": 0.0,
            "f_after": 1.2220532894134521,
            "delta_f": 1.2220532894134521
          },
          {
            "index": 8008,
            "f_before": 0.0,
            "f_after": 1.219563364982605,
            "delta_f": 1.219563364982605
          },
          {
            "index": 7581,
            "f_before": 0.0,
            "f_after": 1.2161213159561157,
            "delta_f": 1.2161213159561157
          },
          {
            "index": 2164,
            "f_before": 0.0,
            "f_after": 1.2124590873718262,
            "delta_f": 1.2124590873718262
          },
          {
            "index": 4324,
            "f_before": 0.0,
            "f_after": 1.2025915384292603,
            "delta_f": 1.2025915384292603
          },
          {
            "index": 8815,
            "f_before": 0.0,
            "f_after": 1.1995950937271118,
            "delta_f": 1.1995950937271118
          },
          {
            "index": 2977,
            "f_before": 0.0,
            "f_after": 1.1830060482025146,
            "delta_f": 1.1830060482025146
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Design a logo for the \"Green Earth Society\".\n\nA logo for the \"Green Earth Society\" could be an image of a globe surrounded by green vines and leaves, with the words \"Green Earth Society\" underneath. The globe could be depicted as a circular shape, with the outer edges of the globe symbolizing the four seasons (spring, summer, fall, winter) and their corresponding colors (green for spring, yellow for summer, red for fall, blue for",
        "after": "Design a logo for the \"Green Earth Society\".\n\nA logo for the \"Green Earth Society\" could be an image of a globe surrounded by green vines and leaves, with the words \"Green Earth Society\" underneath._image\n\n\ncolorization\n\n_\ncolumnen_Green_Foliot\n\n_\ncolumnen_Gr_Foliot\n\n\n_image)\n\n_columnen_Green_Foliot___\n\n_columnen_Green_Foliot___\n\n_c"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 4,
      "feature_stats": {
        "indices": [
          2,
          0,
          1,
          47,
          1322,
          6255,
          4920,
          2725,
          925,
          171,
          7702
        ],
        "f_before": [
          0.12887606024742126,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.011244546622037888,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.12887606024742126,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.011244546622037888,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0037294963840395212,
            "f_after": 0.0037294963840395212,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.008315314538776875,
            "f_after": 0.008315314538776875,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.12887606024742126,
            "f_after": 0.12887606024742126,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Design a logo for the \"Green Earth Society\".\n\nA logo for the \"Green Earth Society\" could be an image of a globe surrounded by green vines and leaves, with the words \"Green Earth Society\" underneath. The globe could be depicted in shades of green, representing the earth's natural beauty and biodiversity. The vines could represent growth and renewal, symbolizing the society's commitment to promoting sustainable practices and protecting the environment.\n\nIn addition to the globe and vines,",
        "after": "Design a logo for the \"Green Earth Society\".\n\nA logo for the \"Green Earth Society\" could be an image of a globe surrounded by green vines and leaves, with the words \"Green Earth Society\" underneath.\n\n\n_Flow_Grid\n_Signification_\n\n_Flow_Grid_\n_Signification_\n\n_Flow_Grid_\n\n\n_Flow_Grid_\n\n_Signification_\n_Flow_Grid_\n\n_Signification_\n\n_Flow_Grid_\n\n\n_F"
      }
    }
  }
}