{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 4,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=4 experiment.layer_sweep=[4]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      4
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 3
  },
  "prompt": "# -*- coding: future_fstrings -*-\n# This is the version string assigned to the entire egg post\n# setup.py install\n\n# Ownership and Copyright Information.\nfrom __future__ import absolute_import\n__author__ = \"Parag Baxi <parag.baxi@gmail.com>\"\n__copyright__ = \"Copyright 2011-2013, Parag Baxi\"\n__license__ = \"BSD-new\"\n\nfrom qualysapi.util import connect\n",
  "output": {
    "before": "# -*- coding: future_fstrings -*-\n# This is the version string assigned to the entire egg post\n# setup.py install\n\n# Ownership and Copyright Information.\nfrom __future__ import absolute_import\n__author__ = \"Parag Baxi <parag.baxi@gmail.com>\"\n__copyright__ = \"Copyright 2011-2013, Parag Baxi\"\n__license__ = \"BSD-new\"\n\nfrom qualysapi.util import connect\nfrom qualysapi.client import QualysAPIException\nimport logging\n\nlog = logging.getLogger(__name__)\n\nclass QualysAPI(object):\n    \"\"\"\n    The Qualys API client.\n\n    :param username: Your Qualys API username\n    :type",
    "after": "# -*- coding: future_fstrings -*-\n# This is the version string assigned to the entire egg post\n# setup.py install\n\n# Ownership and Copyright Information.\nfrom __future__ import absolute_import\n__author__ = \"Parag Baxi <parag.baxi@gmail.com>\"\n__copyright__ = \"Copyright 2011-2013, Parag Baxi\"\n__license__ = \"BSD-new\"\n\nfrom qualysapi.util import connect\n to the parag baxi like a parag bai who's to the parag bai to the thing who's to the parag bai to the thing who's to the parag bai to the thing who's to the"
  },
  "feature_stats": {
    "indices": [
      1,
      0,
      2,
      470,
      8528,
      636,
      8198,
      5701,
      8483,
      6183,
      7024
    ],
    "f_before": [
      0.0,
      0.0,
      0.13850422203540802,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.038440294563770294,
      0.08978084474802017,
      0.0,
      0.07759439945220947,
      0.09009610861539841,
      0.135956272482872,
      0.2710724472999573,
      0.02710259146988392,
      0.4179096817970276,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 0.31080414372868836,
    "train_mean_l2": 0.0539769138097763,
    "train_mean_l1": 0.02312958190504287,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-160848/feature_std_layer_4.html",
    "mean_std": 0.0009577227174304426,
    "max_std": 0.05453735962510109
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 3,
      "feature_stats": {
        "indices": [
          1,
          0,
          2,
          470,
          8528,
          636,
          8198,
          5701,
          8483,
          6183,
          7024
        ],
        "f_before": [
          0.0,
          0.0,
          0.13850422203540802,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.038440294563770294,
          0.08978084474802017,
          0.0,
          0.07759439945220947,
          0.09009610861539841,
          0.135956272482872,
          0.2710724472999573,
          0.02710259146988392,
          0.4179096817970276,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 2977,
            "f_before": 0.0,
            "f_after": 1.779295563697815,
            "delta_f": 1.779295563697815
          },
          {
            "index": 6029,
            "f_before": 0.0,
            "f_after": 1.750429391860962,
            "delta_f": 1.750429391860962
          },
          {
            "index": 8008,
            "f_before": 0.0,
            "f_after": 1.7276262044906616,
            "delta_f": 1.7276262044906616
          },
          {
            "index": 7593,
            "f_before": 0.0,
            "f_after": 1.7246652841567993,
            "delta_f": 1.7246652841567993
          },
          {
            "index": 7577,
            "f_before": 0.0,
            "f_after": 1.723203182220459,
            "delta_f": 1.723203182220459
          },
          {
            "index": 2282,
            "f_before": 0.0,
            "f_after": 1.6814790964126587,
            "delta_f": 1.6814790964126587
          },
          {
            "index": 5349,
            "f_before": 0.0,
            "f_after": 1.6310611963272095,
            "delta_f": 1.6310611963272095
          },
          {
            "index": 7562,
            "f_before": 0.0,
            "f_after": 1.5970479249954224,
            "delta_f": 1.5970479249954224
          },
          {
            "index": 2042,
            "f_before": 0.0,
            "f_after": 1.541209101676941,
            "delta_f": 1.541209101676941
          },
          {
            "index": 1011,
            "f_before": 0.0,
            "f_after": 1.5369793176651,
            "delta_f": 1.5369793176651
          },
          {
            "index": 6356,
            "f_before": 0.0,
            "f_after": 1.5333644151687622,
            "delta_f": 1.5333644151687622
          },
          {
            "index": 8314,
            "f_before": 0.0,
            "f_after": 1.5118156671524048,
            "delta_f": 1.5118156671524048
          },
          {
            "index": 6838,
            "f_before": 0.0,
            "f_after": 1.5081819295883179,
            "delta_f": 1.5081819295883179
          },
          {
            "index": 5023,
            "f_before": 0.0,
            "f_after": 1.4983124732971191,
            "delta_f": 1.4983124732971191
          },
          {
            "index": 1727,
            "f_before": 0.0,
            "f_after": 1.4786275625228882,
            "delta_f": 1.4786275625228882
          },
          {
            "index": 6260,
            "f_before": 0.0,
            "f_after": 1.474860668182373,
            "delta_f": 1.474860668182373
          }
        ],
        "k": 16
      },
      "output": {
        "before": "# -*- coding: future_fstrings -*-\n# This is the version string assigned to the entire egg post\n# setup.py install\n\n# Ownership and Copyright Information.\nfrom __future__ import absolute_import\n__author__ = \"Parag Baxi <parag.baxi@gmail.com>\"\n__copyright__ = \"Copyright 2011-2013, Parag Baxi\"\n__license__ = \"BSD-new\"\n\nfrom qualysapi.util import connect\nimport six\n\nfrom .compat import StringIO as _StringIO, \\\n    parse_qs, urlparse\n\nimport six.moves.urllib.parse as urlparse\n\nfrom .base import *\nfrom .exceptions import *\nfrom .util import *\n\nclass PyQuery(object):\n   ",
        "after": "# -*- coding: future_fstrings -*-\n# This is the version string assigned to the entire egg post\n# setup.py install\n\n# Ownership and Copyright Information.\nfrom __future__ import absolute_import\n__author__ = \"Parag Baxi <parag.baxi@gmail.com>\"\n__copyright__ = \"Copyright 2011-2013, Parag Baxi\"\n__license__ = \"BSD-new\"\n\nfrom qualysapi.util import connect\n you are the one who has a hold on top new for a body behind it but the person responsible for your own who's just there in the middle with the board like a good for someone who is about the head of the board about the whole because"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 4,
      "feature_stats": {
        "indices": [
          1,
          0,
          2,
          470,
          8528,
          636,
          8198,
          5701,
          8483,
          6183,
          7024
        ],
        "f_before": [
          0.0,
          0.0,
          0.13850422203540802,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.13850422203540802,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.13850422203540802,
            "f_after": 0.13850422203540802,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "# -*- coding: future_fstrings -*-\n# This is the version string assigned to the entire egg post\n# setup.py install\n\n# Ownership and Copyright Information.\nfrom __future__ import absolute_import\n__author__ = \"Parag Baxi <parag.baxi@gmail.com>\"\n__copyright__ = \"Copyright 2011-2013, Parag Baxi\"\n__license__ = \"BSD-new\"\n\nfrom qualysapi.util import connect\nimport logging\n\nlogger = logging.getLogger(__name__)\n\n# Import the Qualys API client\nqualysapi = connect('https://www.qualys.com/api/')\n\n# Create a new service instance\nservice = qualysapi.v1.Service.create(\n",
        "after": "# -*- coding: future_fstrings -*-\n# This is the version string assigned to the entire egg post\n# setup.py install\n\n# Ownership and Copyright Information.\nfrom __future__ import absolute_import\n__author__ = \"Parag Baxi <parag.baxi@gmail.com>\"\n__copyright__ = \"Copyright 2011-2013, Parag Baxi\"\n__license__ = \"BSD-new\"\n\nfrom qualysapi.util import connect\n from this is a what is the main host' parag baxi you think you are like it is who thinks it's own process to say you are what about who else.' to do anything else and like parag baxi like you"
      }
    }
  }
}