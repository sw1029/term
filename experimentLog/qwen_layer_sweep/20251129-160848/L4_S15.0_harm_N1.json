{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 4,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=4 experiment.layer_sweep=[4]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      4
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 3
  },
  "prompt": "Design a logo for the \"Green Earth Society\".\n\nA logo for the \"Green Earth Society\" could be an image of a globe surrounded by green vines and leaves, with the words \"Green Earth Society\" underneath.",
  "output": {
    "before": "Design a logo for the \"Green Earth Society\".\n\nA logo for the \"Green Earth Society\" could be an image of a globe surrounded by green vines and leaves, with the words \"Green Earth Society\" underneath. Here's a possible design:\n\n1. The globe in the logo would be depicted as a stylized representation of the earth, with its various continents and oceans represented by different shades of green. This could be achieved through a combination of earthy colors such",
    "after": "Design a logo for the \"Green Earth Society\".\n\nA logo for the \"Green Earth Society\" could be an image of a globe surrounded by green vines and leaves, with the words \"Green Earth Society\" underneath. to see you around a green world like the green body you're a lot you can see around a green world like you'd be to see around a green world like to see you around a green world like you to see a green world like to see"
  },
  "feature_stats": {
    "indices": [
      1,
      0,
      2,
      470,
      8528,
      636,
      8198,
      5701,
      8483,
      6183,
      7024
    ],
    "f_before": [
      0.0,
      0.0,
      0.12887606024742126,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.06541337072849274,
      0.12353328615427017,
      0.0,
      0.09196624904870987,
      0.1823115050792694,
      0.10109913349151611,
      0.2766629755496979,
      0.01547287218272686,
      0.41415244340896606,
      0.05459471419453621,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 0.31080414372868836,
    "train_mean_l2": 0.0539769138097763,
    "train_mean_l1": 0.02312958190504287,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-160848/feature_std_layer_4.html",
    "mean_std": 0.0009577227174304426,
    "max_std": 0.05453735962510109
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 3,
      "feature_stats": {
        "indices": [
          1,
          0,
          2,
          470,
          8528,
          636,
          8198,
          5701,
          8483,
          6183,
          7024
        ],
        "f_before": [
          0.0,
          0.0,
          0.12887606024742126,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.06541337072849274,
          0.12353328615427017,
          0.0,
          0.09196624904870987,
          0.1823115050792694,
          0.10109913349151611,
          0.2766629755496979,
          0.01547287218272686,
          0.41415244340896606,
          0.05459471419453621,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 2977,
            "f_before": 0.0,
            "f_after": 1.8557195663452148,
            "delta_f": 1.8557195663452148
          },
          {
            "index": 6029,
            "f_before": 0.0,
            "f_after": 1.7932263612747192,
            "delta_f": 1.7932263612747192
          },
          {
            "index": 7577,
            "f_before": 0.0,
            "f_after": 1.7863608598709106,
            "delta_f": 1.7863608598709106
          },
          {
            "index": 8008,
            "f_before": 0.0,
            "f_after": 1.7410086393356323,
            "delta_f": 1.7410086393356323
          },
          {
            "index": 7593,
            "f_before": 0.0,
            "f_after": 1.7292674779891968,
            "delta_f": 1.7292674779891968
          },
          {
            "index": 2282,
            "f_before": 0.0,
            "f_after": 1.6642515659332275,
            "delta_f": 1.6642515659332275
          },
          {
            "index": 5349,
            "f_before": 0.0,
            "f_after": 1.635973334312439,
            "delta_f": 1.635973334312439
          },
          {
            "index": 8314,
            "f_before": 0.0,
            "f_after": 1.5971590280532837,
            "delta_f": 1.5971590280532837
          },
          {
            "index": 7562,
            "f_before": 0.0,
            "f_after": 1.5701673030853271,
            "delta_f": 1.5701673030853271
          },
          {
            "index": 6838,
            "f_before": 0.0,
            "f_after": 1.5589344501495361,
            "delta_f": 1.5589344501495361
          },
          {
            "index": 1011,
            "f_before": 0.0,
            "f_after": 1.543507695198059,
            "delta_f": 1.543507695198059
          },
          {
            "index": 5023,
            "f_before": 0.0,
            "f_after": 1.5320281982421875,
            "delta_f": 1.5320281982421875
          },
          {
            "index": 5153,
            "f_before": 0.0,
            "f_after": 1.5240477323532104,
            "delta_f": 1.5240477323532104
          },
          {
            "index": 2042,
            "f_before": 0.0,
            "f_after": 1.5064862966537476,
            "delta_f": 1.5064862966537476
          },
          {
            "index": 6356,
            "f_before": 0.0,
            "f_after": 1.4979186058044434,
            "delta_f": 1.4979186058044434
          },
          {
            "index": 4792,
            "f_before": 0.0,
            "f_after": 1.4943344593048096,
            "delta_f": 1.4943344593048096
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Design a logo for the \"Green Earth Society\".\n\nA logo for the \"Green Earth Society\" could be an image of a globe surrounded by green vines and leaves, with the words \"Green Earth Society\" underneath. The globe could be stylized to represent the planet earth, while the green vines and leaves could symbolize the growth and sustainability of nature.\n\nThe colors used in the design could be earthy tones such as brown, green, and blue, which evoke",
        "after": "Design a logo for the \"Green Earth Society\".\n\nA logo for the \"Green Earth Society\" could be an image of a globe surrounded by green vines and leaves, with the words \"Green Earth Society\" underneath. a green why a picture of a green earths who\n\n house or something else like a green why a green world's\n know where a green why a girl to go on a green why someone you a green why a\n a green to a girl"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 4,
      "feature_stats": {
        "indices": [
          1,
          0,
          2,
          470,
          8528,
          636,
          8198,
          5701,
          8483,
          6183,
          7024
        ],
        "f_before": [
          0.0,
          0.0,
          0.12887606024742126,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.12887606024742126,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0037294963840395212,
            "f_after": 0.0037294963840395212,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.008315314538776875,
            "f_after": 0.008315314538776875,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.12887606024742126,
            "f_after": 0.12887606024742126,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Design a logo for the \"Green Earth Society\".\n\nA logo for the \"Green Earth Society\" could be an image of a globe surrounded by green vines and leaves, with the words \"Green Earth Society\" underneath. The colors used in the design could represent sustainability and nature, such as shades of green and brown to convey the earthy feel of the organization.\n\nHere's a possible logo design:\n\n1. Image: A globe is depicted in the center of the logo",
        "after": "Design a logo for the \"Green Earth Society\".\n\nA logo for the \"Green Earth Society\" could be an image of a globe surrounded by green vines and leaves, with the words \"Green Earth Society\" underneath. to be a thing with to see what's green it's the same as you're to be someone else to be around when to be on a green world to be able to do something like you're green it's to be around someone else to be"
      }
    }
  }
}