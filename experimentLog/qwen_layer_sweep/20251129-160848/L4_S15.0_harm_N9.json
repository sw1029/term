{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 4,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=4 experiment.layer_sweep=[4]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      4
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 3
  },
  "prompt": "Find the answer to this equation: 8 + 2 x 3\n\n14",
  "output": {
    "before": "Find the answer to this equation: 8 + 2 x 3\n\n14 The solution to the equation 8 + 2 x 3 is 14. This can be calculated by performing the multiplication and addition operations on the given expression:\n\n8 + 2 x 3 = 8 + 6\n\nNow,",
    "after": "Find the answer to this equation: 8 + 2 x 3\n\n14 and anyone who is in charge of something's doing it, to make them want to think of wants to do something to kill them and just wants to think about themselves why they have to do it wants to kill them too.\n what else but for someone"
  },
  "feature_stats": {
    "indices": [
      1,
      0,
      2,
      470,
      8528,
      636,
      8198,
      5701,
      8483,
      6183,
      7024
    ],
    "f_before": [
      0.0,
      0.0,
      0.1344061642885208,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.05644630640745163,
      0.13360626995563507,
      0.0,
      0.10848207026720047,
      0.14395175874233246,
      0.1459718495607376,
      0.30823463201522827,
      0.05328387767076492,
      0.415981650352478,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 0.31080414372868836,
    "train_mean_l2": 0.0539769138097763,
    "train_mean_l1": 0.02312958190504287,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-160848/feature_std_layer_4.html",
    "mean_std": 0.0009577227174304426,
    "max_std": 0.05453735962510109
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 3,
      "feature_stats": {
        "indices": [
          1,
          0,
          2,
          470,
          8528,
          636,
          8198,
          5701,
          8483,
          6183,
          7024
        ],
        "f_before": [
          0.0,
          0.0,
          0.1344061642885208,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.05644630640745163,
          0.13360626995563507,
          0.0,
          0.10848207026720047,
          0.14395175874233246,
          0.1459718495607376,
          0.30823463201522827,
          0.05328387767076492,
          0.415981650352478,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 6029,
            "f_before": 0.0,
            "f_after": 1.7653319835662842,
            "delta_f": 1.7653319835662842
          },
          {
            "index": 8008,
            "f_before": 0.0,
            "f_after": 1.7522804737091064,
            "delta_f": 1.7522804737091064
          },
          {
            "index": 2977,
            "f_before": 0.0,
            "f_after": 1.7329421043395996,
            "delta_f": 1.7329421043395996
          },
          {
            "index": 2282,
            "f_before": 0.0,
            "f_after": 1.6827986240386963,
            "delta_f": 1.6827986240386963
          },
          {
            "index": 7577,
            "f_before": 0.0,
            "f_after": 1.643867015838623,
            "delta_f": 1.643867015838623
          },
          {
            "index": 7593,
            "f_before": 0.0,
            "f_after": 1.6418579816818237,
            "delta_f": 1.6418579816818237
          },
          {
            "index": 6838,
            "f_before": 0.0,
            "f_after": 1.567826509475708,
            "delta_f": 1.567826509475708
          },
          {
            "index": 5349,
            "f_before": 0.0,
            "f_after": 1.5482608079910278,
            "delta_f": 1.5482608079910278
          },
          {
            "index": 8314,
            "f_before": 0.0,
            "f_after": 1.5062986612319946,
            "delta_f": 1.5062986612319946
          },
          {
            "index": 2042,
            "f_before": 0.0,
            "f_after": 1.4887924194335938,
            "delta_f": 1.4887924194335938
          },
          {
            "index": 7562,
            "f_before": 0.0,
            "f_after": 1.4745454788208008,
            "delta_f": 1.4745454788208008
          },
          {
            "index": 1011,
            "f_before": 0.0,
            "f_after": 1.4677597284317017,
            "delta_f": 1.4677597284317017
          },
          {
            "index": 5153,
            "f_before": 0.0,
            "f_after": 1.4594863653182983,
            "delta_f": 1.4594863653182983
          },
          {
            "index": 5023,
            "f_before": 0.0,
            "f_after": 1.4456915855407715,
            "delta_f": 1.4456915855407715
          },
          {
            "index": 1727,
            "f_before": 0.0,
            "f_after": 1.441725254058838,
            "delta_f": 1.441725254058838
          },
          {
            "index": 5849,
            "f_before": 0.0,
            "f_after": 1.4180316925048828,
            "delta_f": 1.4180316925048828
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Find the answer to this equation: 8 + 2 x 3\n\n14 The answer to the equation 8 + 2 x 3 is 14. This can be calculated by following these steps:\n\nStep 1: Multiply 2 by 3\n2 x 3 = 6\n\nStep 2:",
        "after": "Find the answer to this equation: 8 + 2 x 3\n\n14 where you are and what to be why you should avoid your thoughts how to find out what's hiding yourself and help yourself out when it is at the place to go back home.\n it's up here when it is\n around the when you're looking"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 4,
      "feature_stats": {
        "indices": [
          1,
          0,
          2,
          470,
          8528,
          636,
          8198,
          5701,
          8483,
          6183,
          7024
        ],
        "f_before": [
          0.0,
          0.0,
          0.1344061642885208,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.1344061642885208,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.009154867380857468,
            "f_after": 0.009154867380857468,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0021296341437846422,
            "f_after": 0.0021296341437846422,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.1344061642885208,
            "f_after": 0.1344061642885208,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Find the answer to this equation: 8 + 2 x 3\n\n14 To solve for the value of the expression 8 + 2 x 3, we can follow these steps:\n\nStep 1: Distribute the 2 x 3\n2 x 3 = 6\n\nNow, the equation becomes:\n",
        "after": "Find the answer to this equation: 8 + 2 x 3\n\n14 and you, who is looking for a reason why he's in here and what he needs to kill him and wants to kill him out there and wants to kill him out there wants to kill him and wants to kill him wants to kill him out there"
      }
    }
  }
}