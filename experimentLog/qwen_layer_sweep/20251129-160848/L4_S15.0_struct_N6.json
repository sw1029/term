{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 4,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=4 experiment.layer_sweep=[4]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      4
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 3
  },
  "prompt": "user: Who is NAME_1 from Dayton Ohio born in October 1982\nassistant: NAME_1 is a former police officer from Dayton, Ohio who was born in October 1982. He is currently being sought by police for questioning in connection with the August 2020 shooting that left nine people dead.",
  "output": {
    "before": "user: Who is NAME_1 from Dayton Ohio born in October 1982\nassistant: NAME_1 is a former police officer from Dayton, Ohio who was born in October 1982. He is currently being sought by police for questioning in connection with the August 2020 shooting that left nine people dead. On August 4, 2020, an officer named John Doe was responding to a call in which he encountered a man named James \"Jim\" Smith, who had been reported to be armed and threatening others at a local bar. Doe",
    "after": "user: Who is NAME_1 from Dayton Ohio born in October 1982\nassistant: NAME_1 is a former police officer from Dayton, Ohio who was born in October 1982. He is currently being sought by police for questioning in connection with the August 2020 shooting that left nine people dead.   ization\n\n__)\n\n---__\n\n\n\n\n\\-\"\n\n---\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      1,
      47,
      1322,
      6255,
      4920,
      2725,
      925,
      171,
      7702
    ],
    "f_before": [
      0.04352603852748871,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      1.0994893312454224,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.009593116119503975,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 0.31080414372868836,
    "train_mean_l2": 0.0539769138097763,
    "train_mean_l1": 0.02312958190504287,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-160848/feature_std_layer_4.html",
    "mean_std": 0.0009577227174304426,
    "max_std": 0.05453735962510109
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 3,
      "feature_stats": {
        "indices": [
          2,
          0,
          1,
          47,
          1322,
          6255,
          4920,
          2725,
          925,
          171,
          7702
        ],
        "f_before": [
          0.04352603852748871,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          1.0994893312454224,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.009593116119503975,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8314,
            "f_before": 0.0,
            "f_after": 1.606783151626587,
            "delta_f": 1.606783151626587
          },
          {
            "index": 6260,
            "f_before": 0.0,
            "f_after": 1.4997576475143433,
            "delta_f": 1.4997576475143433
          },
          {
            "index": 7593,
            "f_before": 0.0,
            "f_after": 1.4611586332321167,
            "delta_f": 1.4611586332321167
          },
          {
            "index": 7562,
            "f_before": 0.0,
            "f_after": 1.4097092151641846,
            "delta_f": 1.4097092151641846
          },
          {
            "index": 2065,
            "f_before": 0.0,
            "f_after": 1.4080482721328735,
            "delta_f": 1.4080482721328735
          },
          {
            "index": 5349,
            "f_before": 0.0,
            "f_after": 1.3665796518325806,
            "delta_f": 1.3665796518325806
          },
          {
            "index": 7577,
            "f_before": 0.0,
            "f_after": 1.3584200143814087,
            "delta_f": 1.3584200143814087
          },
          {
            "index": 6029,
            "f_before": 0.0,
            "f_after": 1.340791940689087,
            "delta_f": 1.340791940689087
          },
          {
            "index": 6487,
            "f_before": 0.0,
            "f_after": 1.2852531671524048,
            "delta_f": 1.2852531671524048
          },
          {
            "index": 8815,
            "f_before": 0.0,
            "f_after": 1.2446069717407227,
            "delta_f": 1.2446069717407227
          },
          {
            "index": 2164,
            "f_before": 0.0,
            "f_after": 1.2298874855041504,
            "delta_f": 1.2298874855041504
          },
          {
            "index": 1842,
            "f_before": 0.0,
            "f_after": 1.2252998352050781,
            "delta_f": 1.2252998352050781
          },
          {
            "index": 7581,
            "f_before": 0.0,
            "f_after": 1.212869644165039,
            "delta_f": 1.212869644165039
          },
          {
            "index": 4324,
            "f_before": 0.0,
            "f_after": 1.2034056186676025,
            "delta_f": 1.2034056186676025
          },
          {
            "index": 8008,
            "f_before": 0.0,
            "f_after": 1.1825988292694092,
            "delta_f": 1.1825988292694092
          },
          {
            "index": 3658,
            "f_before": 0.0,
            "f_after": 1.176762342453003,
            "delta_f": 1.176762342453003
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: Who is NAME_1 from Dayton Ohio born in October 1982\nassistant: NAME_1 is a former police officer from Dayton, Ohio who was born in October 1982. He is currently being sought by police for questioning in connection with the August 2020 shooting that left nine people dead. On August 27, 2020, two men opened fire on a group of people at an apartment complex in Dayton, Ohio, killing seven and injuring five others.\nNAME_1 has been identified as one of the suspects in the",
        "after": "user: Who is NAME_1 from Dayton Ohio born in October 1982\nassistant: NAME_1 is a former police officer from Dayton, Ohio who was born in October 1982. He is currently being sought by police for questioning in connection with the August 2020 shooting that left nine people dead.__ Station_\n\n)\n\n\n\n\n\n\nclass Authorization\n\ncode\nification_Aization\")\n\n_)\n\n---)\n\nclass   ization\n_Comb_)\n\n\n\n\n__class_authorization\")\n_\nsonction_flavor_module__class\"\"\"\n\n\n__class_authorization__ization"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 4,
      "feature_stats": {
        "indices": [
          2,
          0,
          1,
          47,
          1322,
          6255,
          4920,
          2725,
          925,
          171,
          7702
        ],
        "f_before": [
          0.04352603852748871,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.04352603852748871,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.04352603852748871,
            "f_after": 0.04352603852748871,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: Who is NAME_1 from Dayton Ohio born in October 1982\nassistant: NAME_1 is a former police officer from Dayton, Ohio who was born in October 1982. He is currently being sought by police for questioning in connection with the August 2020 shooting that left nine people dead. The shooting occurred at an apartment complex on the east side of downtown Dayton and involved several officers responding to reports of a domestic dispute.\n\nNAME_1 has since been identified as one of the four suspects in the shooting, along with three other individuals who have",
        "after": "user: Who is NAME_1 from Dayton Ohio born in October 1982\nassistant: NAME_1 is a former police officer from Dayton, Ohio who was born in October 1982. He is currently being sought by police for questioning in connection with the August 2020 shooting that left nine people dead.)\n\n    - Authorization\n\n\n\n\n```\n``````````````````"
      }
    }
  }
}