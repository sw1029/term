{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 4,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=4 experiment.layer_sweep=[4]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      4
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 3
  },
  "prompt": "user: Who is NAME_1 from Dayton Ohio born in October 1982\nassistant: NAME_1 is a former police officer from Dayton, Ohio who was born in October 1982. He is currently being sought by police for questioning in connection with the August 2020 shooting that left nine people dead.",
  "output": {
    "before": "user: Who is NAME_1 from Dayton Ohio born in October 1982\nassistant: NAME_1 is a former police officer from Dayton, Ohio who was born in October 1982. He is currently being sought by police for questioning in connection with the August 2020 shooting that left nine people dead. On August 24th, 2020, NAME_1 was seen leaving a hotel in downtown Dayton after attending a party and was later found on surveillance footage entering a nearby apartment complex where several shots were fired.\nNAME_1's",
    "after": "user: Who is NAME_1 from Dayton Ohio born in October 1982\nassistant: NAME_1 is a former police officer from Dayton, Ohio who was born in October 1982. He is currently being sought by police for questioning in connection with the August 2020 shooting that left nine people dead. who are found murdered every day but for some reason or someone else is named police for asking about when they're trying to figure out what's behind it and what killed because of something else for someone else is trying to figure out what's happening now'\n"
  },
  "feature_stats": {
    "indices": [
      1,
      0,
      2,
      470,
      8528,
      636,
      8198,
      5701,
      8483,
      6183,
      7024
    ],
    "f_before": [
      0.0,
      0.0,
      0.04352603852748871,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.053764909505844116,
      0.14618389308452606,
      0.0,
      0.10337858647108078,
      0.1390019655227661,
      0.15270470082759857,
      0.2715730667114258,
      0.016245996579527855,
      0.4286055266857147,
      0.026579171419143677,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 0.31080414372868836,
    "train_mean_l2": 0.0539769138097763,
    "train_mean_l1": 0.02312958190504287,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-160848/feature_std_layer_4.html",
    "mean_std": 0.0009577227174304426,
    "max_std": 0.05453735962510109
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 3,
      "feature_stats": {
        "indices": [
          1,
          0,
          2,
          470,
          8528,
          636,
          8198,
          5701,
          8483,
          6183,
          7024
        ],
        "f_before": [
          0.0,
          0.0,
          0.04352603852748871,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.053764909505844116,
          0.14618389308452606,
          0.0,
          0.10337858647108078,
          0.1390019655227661,
          0.15270470082759857,
          0.2715730667114258,
          0.016245996579527855,
          0.4286055266857147,
          0.026579171419143677,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 2977,
            "f_before": 0.0,
            "f_after": 1.8223100900650024,
            "delta_f": 1.8223100900650024
          },
          {
            "index": 6029,
            "f_before": 0.0,
            "f_after": 1.7639203071594238,
            "delta_f": 1.7639203071594238
          },
          {
            "index": 7577,
            "f_before": 0.0,
            "f_after": 1.711685299873352,
            "delta_f": 1.711685299873352
          },
          {
            "index": 8008,
            "f_before": 0.0,
            "f_after": 1.7040438652038574,
            "delta_f": 1.7040438652038574
          },
          {
            "index": 7593,
            "f_before": 0.0,
            "f_after": 1.7027220726013184,
            "delta_f": 1.7027220726013184
          },
          {
            "index": 2282,
            "f_before": 0.0,
            "f_after": 1.697460412979126,
            "delta_f": 1.697460412979126
          },
          {
            "index": 5349,
            "f_before": 0.0,
            "f_after": 1.6347007751464844,
            "delta_f": 1.6347007751464844
          },
          {
            "index": 1011,
            "f_before": 0.0,
            "f_after": 1.5936769247055054,
            "delta_f": 1.5936769247055054
          },
          {
            "index": 6838,
            "f_before": 0.0,
            "f_after": 1.549303412437439,
            "delta_f": 1.549303412437439
          },
          {
            "index": 7562,
            "f_before": 0.0,
            "f_after": 1.523399829864502,
            "delta_f": 1.523399829864502
          },
          {
            "index": 8314,
            "f_before": 0.0,
            "f_after": 1.518905520439148,
            "delta_f": 1.518905520439148
          },
          {
            "index": 1727,
            "f_before": 0.0,
            "f_after": 1.5098631381988525,
            "delta_f": 1.5098631381988525
          },
          {
            "index": 2042,
            "f_before": 0.0,
            "f_after": 1.5013272762298584,
            "delta_f": 1.5013272762298584
          },
          {
            "index": 6356,
            "f_before": 0.0,
            "f_after": 1.4974560737609863,
            "delta_f": 1.4974560737609863
          },
          {
            "index": 5153,
            "f_before": 0.0,
            "f_after": 1.4928704500198364,
            "delta_f": 1.4928704500198364
          },
          {
            "index": 5023,
            "f_before": 0.0,
            "f_after": 1.4847180843353271,
            "delta_f": 1.4847180843353271
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: Who is NAME_1 from Dayton Ohio born in October 1982\nassistant: NAME_1 is a former police officer from Dayton, Ohio who was born in October 1982. He is currently being sought by police for questioning in connection with the August 2020 shooting that left nine people dead. On August 23rd, 2020, a man named James \"Jesse\" Jackson, Jr., walked into a McDonald's restaurant on Main Street in Dayton and opened fire at several employees before killing himself.\nNAME_1 has",
        "after": "user: Who is NAME_1 from Dayton Ohio born in October 1982\nassistant: NAME_1 is a former police officer from Dayton, Ohio who was born in October 1982. He is currently being sought by police for questioning in connection with the August 2020 shooting that left nine people dead. named who is one of the who is responsible for the person you are looking for the about the others who i am here to the who is in charge of the other person in and who is the right now if there are anyone else in charge of the"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 4,
      "feature_stats": {
        "indices": [
          1,
          0,
          2,
          470,
          8528,
          636,
          8198,
          5701,
          8483,
          6183,
          7024
        ],
        "f_before": [
          0.0,
          0.0,
          0.04352603852748871,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.04352603852748871,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.04352603852748871,
            "f_after": 0.04352603852748871,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: Who is NAME_1 from Dayton Ohio born in October 1982\nassistant: NAME_1 is a former police officer from Dayton, Ohio who was born in October 1982. He is currently being sought by police for questioning in connection with the August 2020 shooting that left nine people dead. The suspect, whose name has not been released at this time, is believed to be a member of a gang and is considered one of the prime suspects in the investigation.\nIn the aftermath of the shooting, police have launched an extensive search for evidence and",
        "after": "user: Who is NAME_1 from Dayton Ohio born in October 1982\nassistant: NAME_1 is a former police officer from Dayton, Ohio who was born in October 1982. He is currently being sought by police for questioning in connection with the August 2020 shooting that left nine people dead. to name one who was born in october   born in october   born in october  born in october  born in october someone who is born in october someone who is born in october someone who is born in"
      }
    }
  }
}