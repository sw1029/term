{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 4,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=4 experiment.layer_sweep=[4]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      4
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 3
  },
  "prompt": "# -*- coding: future_fstrings -*-\n# This is the version string assigned to the entire egg post\n# setup.py install\n\n# Ownership and Copyright Information.\nfrom __future__ import absolute_import\n__author__ = \"Parag Baxi <parag.baxi@gmail.com>\"\n__copyright__ = \"Copyright 2011-2013, Parag Baxi\"\n__license__ = \"BSD-new\"\n\nfrom qualysapi.util import connect\n",
  "output": {
    "before": "# -*- coding: future_fstrings -*-\n# This is the version string assigned to the entire egg post\n# setup.py install\n\n# Ownership and Copyright Information.\nfrom __future__ import absolute_import\n__author__ = \"Parag Baxi <parag.baxi@gmail.com>\"\n__copyright__ = \"Copyright 2011-2013, Parag Baxi\"\n__license__ = \"BSD-new\"\n\nfrom qualysapi.util import connect\nimport sys\nimport logging\nimport json\n\nimport six\nfrom six.moves.urllib.parse import parse_qs\n\nlog = logging.getLogger(__name__)\n\nclass QualysAPI(object):\n    \"\"\"Qualys API client.\"\"\"\n    \n    def __init__(self,",
    "after": "# -*- coding: future_fstrings -*-\n# This is the version string assigned to the entire egg post\n# setup.py install\n\n# Ownership and Copyright Information.\nfrom __future__ import absolute_import\n__author__ = \"Parag Baxi <parag.baxi@gmail.com>\"\n__copyright__ = \"Copyright 2011-2013, Parag Baxi\"\n__license__ = \"BSD-new\"\n\nfrom qualysapi.util import connect\nimport time\nimport sys\nimport random\nimport os\nimport unittest\nimport pytest\n\nimport typescript\nimport pyxall\nimport pycall\nimport pyxall import pycall\nimport pyxall import pycall\n"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      1,
      6255,
      47,
      4920,
      7702,
      8198,
      7156,
      1027,
      171
    ],
    "f_before": [
      0.0,
      0.13850422203540802,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.4136922061443329,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 0.31080414372868836,
    "train_mean_l2": 0.0539769138097763,
    "train_mean_l1": 0.02312958190504287,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-160848/feature_std_layer_4.html",
    "mean_std": 0.0009577227174304426,
    "max_std": 0.05453735962510109
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 3,
      "feature_stats": {
        "indices": [
          0,
          2,
          1,
          6255,
          47,
          4920,
          7702,
          8198,
          7156,
          1027,
          171
        ],
        "f_before": [
          0.0,
          0.13850422203540802,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.4136922061443329,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 6260,
            "f_before": 0.0,
            "f_after": 1.8601047992706299,
            "delta_f": 1.8601047992706299
          },
          {
            "index": 7562,
            "f_before": 0.0,
            "f_after": 1.808834433555603,
            "delta_f": 1.808834433555603
          },
          {
            "index": 5349,
            "f_before": 0.0,
            "f_after": 1.6040865182876587,
            "delta_f": 1.6040865182876587
          },
          {
            "index": 7577,
            "f_before": 0.0,
            "f_after": 1.585098385810852,
            "delta_f": 1.585098385810852
          },
          {
            "index": 7593,
            "f_before": 0.0,
            "f_after": 1.5649317502975464,
            "delta_f": 1.5649317502975464
          },
          {
            "index": 2065,
            "f_before": 0.0,
            "f_after": 1.545777440071106,
            "delta_f": 1.545777440071106
          },
          {
            "index": 8314,
            "f_before": 0.0,
            "f_after": 1.5281871557235718,
            "delta_f": 1.5281871557235718
          },
          {
            "index": 8815,
            "f_before": 0.0,
            "f_after": 1.4946032762527466,
            "delta_f": 1.4946032762527466
          },
          {
            "index": 6356,
            "f_before": 0.0,
            "f_after": 1.4876879453659058,
            "delta_f": 1.4876879453659058
          },
          {
            "index": 1842,
            "f_before": 0.0,
            "f_after": 1.4569861888885498,
            "delta_f": 1.4569861888885498
          },
          {
            "index": 7581,
            "f_before": 0.0,
            "f_after": 1.4314624071121216,
            "delta_f": 1.4314624071121216
          },
          {
            "index": 8008,
            "f_before": 0.0,
            "f_after": 1.4288703203201294,
            "delta_f": 1.4288703203201294
          },
          {
            "index": 2164,
            "f_before": 0.0,
            "f_after": 1.4220980405807495,
            "delta_f": 1.4220980405807495
          },
          {
            "index": 6487,
            "f_before": 0.0,
            "f_after": 1.4167815446853638,
            "delta_f": 1.4167815446853638
          },
          {
            "index": 6029,
            "f_before": 0.0,
            "f_after": 1.411331057548523,
            "delta_f": 1.411331057548523
          },
          {
            "index": 6780,
            "f_before": 0.0,
            "f_after": 1.3813244104385376,
            "delta_f": 1.3813244104385376
          }
        ],
        "k": 16
      },
      "output": {
        "before": "# -*- coding: future_fstrings -*-\n# This is the version string assigned to the entire egg post\n# setup.py install\n\n# Ownership and Copyright Information.\nfrom __future__ import absolute_import\n__author__ = \"Parag Baxi <parag.baxi@gmail.com>\"\n__copyright__ = \"Copyright 2011-2013, Parag Baxi\"\n__license__ = \"BSD-new\"\n\nfrom qualysapi.util import connect\nimport logging\nimport os\n\nfrom setuptools import setup, find_packages\n\nlog = logging.getLogger(__name__)\n\n# Path to the directory containing the distribution package.\nwith open(os.path.join(os.path.dirname(__file__), 'egg_info'), 'r') as",
        "after": "# -*- coding: future_fstrings -*-\n# This is the version string assigned to the entire egg post\n# setup.py install\n\n# Ownership and Copyright Information.\nfrom __future__ import absolute_import\n__author__ = \"Parag Baxi <parag.baxi@gmail.com>\"\n__copyright__ = \"Copyright 2011-2013, Parag Baxi\"\n__license__ = \"BSD-new\"\n\nfrom qualysapi.util import connect\nimport sys\nimport os.path import os.path as Module import import\n\n\n\nimport os.path import Module import import import\n\n\n\nimport os.path import Module import import import\n)\n\n\nimport os.path import Module import import importsys import import\n\n\n\n\nimport os"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 4,
      "feature_stats": {
        "indices": [
          0,
          2,
          1,
          6255,
          47,
          4920,
          7702,
          8198,
          7156,
          1027,
          171
        ],
        "f_before": [
          0.0,
          0.13850422203540802,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.13850422203540802,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.13850422203540802,
            "f_after": 0.13850422203540802,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "# -*- coding: future_fstrings -*-\n# This is the version string assigned to the entire egg post\n# setup.py install\n\n# Ownership and Copyright Information.\nfrom __future__ import absolute_import\n__author__ = \"Parag Baxi <parag.baxi@gmail.com>\"\n__copyright__ = \"Copyright 2011-2013, Parag Baxi\"\n__license__ = \"BSD-new\"\n\nfrom qualysapi.util import connect\nimport qualysapi.config as conf\n\n# Additional global variables used in this module\nqualysapi._log = conf.get('qualysapi.log', None)\nqualysapi._settings = conf.get('qualysapi.settings', None)\n\n#",
        "after": "# -*- coding: future_fstrings -*-\n# This is the version string assigned to the entire egg post\n# setup.py install\n\n# Ownership and Copyright Information.\nfrom __future__ import absolute_import\n__author__ = \"Parag Baxi <parag.baxi@gmail.com>\"\n__copyright__ = \"Copyright 2011-2013, Parag Baxi\"\n__license__ = \"BSD-new\"\n\nfrom qualysapi.util import connect\nimport collections\nimport itertools\nimport os\nimport sys\nimport time\nimport re\nimport warnings\nimport types\nimport random\nimport timeit\nimport math\nimport random\nimport timeit\nimport unittest\nimport unittest.mock import mock_open"
      }
    }
  }
}