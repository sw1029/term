{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 8,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=8 experiment.layer_sweep=[8]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      8
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 7
  },
  "prompt": "Classify the following movie as either a horror movie or a romantic comedy.\n\nThe Notebook\n\nRomantic Comedy",
  "output": {
    "before": "Classify the following movie as either a horror movie or a romantic comedy.\n\nThe Notebook\n\nRomantic Comedy The Notebook is a romantic comedy movie that follows the story of two high school sweethearts, Noah and Allie, who fall in love while attending college. The movie primarily focuses on their relationship and how it evolves over time, rather than on any",
    "after": "Classify the following movie as either a horror movie or a romantic comedy.\n\nThe Notebook\n\nRomantic Comedy The Notebook\nhorror movie romance comedy Romance Comedy"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      1,
      3753,
      1527,
      37,
      5707,
      8080,
      2852,
      7531,
      4641
    ],
    "f_before": [
      0.06097831949591637,
      0.0,
      0.0,
      0.0,
      1.0274404287338257,
      0.0,
      0.0,
      0.028516465798020363,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.3054392337799072,
      0.0,
      0.0,
      0.0,
      1.151469349861145,
      0.0,
      0.0,
      0.038842879235744476,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 4.318020832970738,
    "train_mean_l2": 2.232514812302776,
    "train_mean_l1": 1.4813821620140224,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-162401/feature_std_layer_8.html",
    "mean_std": 0.41402214765548706,
    "max_std": 58.45426940917969
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 7,
      "feature_stats": {
        "indices": [
          2,
          0,
          1,
          3753,
          1527,
          37,
          5707,
          8080,
          2852,
          7531,
          4641
        ],
        "f_before": [
          0.06097831949591637,
          0.0,
          0.0,
          0.0,
          1.0274404287338257,
          0.0,
          0.0,
          0.028516465798020363,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.3054392337799072,
          0.0,
          0.0,
          0.0,
          1.151469349861145,
          0.0,
          0.0,
          0.038842879235744476,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 2494,
            "f_before": 22.53597640991211,
            "f_after": 11.812065124511719,
            "delta_f": -10.72391128540039
          },
          {
            "index": 3193,
            "f_before": 0.8865073919296265,
            "f_after": 0.040819182991981506,
            "delta_f": -0.845688208937645
          },
          {
            "index": 9055,
            "f_before": 1.1882035732269287,
            "f_after": 0.42304208874702454,
            "delta_f": -0.7651614844799042
          },
          {
            "index": 7476,
            "f_before": 1.4203739166259766,
            "f_after": 0.7859141826629639,
            "delta_f": -0.6344597339630127
          },
          {
            "index": 6527,
            "f_before": 1.4457149505615234,
            "f_after": 0.9368060231208801,
            "delta_f": -0.5089089274406433
          },
          {
            "index": 1531,
            "f_before": 1.1416840553283691,
            "f_after": 0.72694993019104,
            "delta_f": -0.4147341251373291
          },
          {
            "index": 3372,
            "f_before": 0.8069877028465271,
            "f_after": 0.44519397616386414,
            "delta_f": -0.36179372668266296
          },
          {
            "index": 5420,
            "f_before": 0.8424617052078247,
            "f_after": 0.4924689531326294,
            "delta_f": -0.3499927520751953
          },
          {
            "index": 5928,
            "f_before": 1.274617314338684,
            "f_after": 0.9256215691566467,
            "delta_f": -0.34899574518203735
          },
          {
            "index": 4667,
            "f_before": 1.9953981637954712,
            "f_after": 1.654807448387146,
            "delta_f": -0.3405907154083252
          },
          {
            "index": 8255,
            "f_before": 1.7502373456954956,
            "f_after": 1.4282110929489136,
            "delta_f": -0.32202625274658203
          },
          {
            "index": 2678,
            "f_before": 1.0858455896377563,
            "f_after": 0.7679557800292969,
            "delta_f": -0.3178898096084595
          },
          {
            "index": 2229,
            "f_before": 1.7424571514129639,
            "f_after": 1.447392463684082,
            "delta_f": -0.29506468772888184
          },
          {
            "index": 2582,
            "f_before": 1.8477360010147095,
            "f_after": 1.5540505647659302,
            "delta_f": -0.2936854362487793
          },
          {
            "index": 2,
            "f_before": 0.06097831949591637,
            "f_after": 0.3054392337799072,
            "delta_f": 0.24446091428399086
          },
          {
            "index": 4860,
            "f_before": 1.866054654121399,
            "f_after": 1.6314234733581543,
            "delta_f": -0.23463118076324463
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Classify the following movie as either a horror movie or a romantic comedy.\n\nThe Notebook\n\nRomantic Comedy\n\nStephanie's Answer: Romantic Comedy\nThe Notebook is a romantic comedy that tells the story of two young people, Jack and Mary, who fall in love while studying at the same university. The film follows their journey from college to marriage,",
        "after": "Classify the following movie as either a horror movie or a romantic comedy.\n\nThe Notebook\n\nRomantic Comedy"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 8,
      "feature_stats": {
        "indices": [
          2,
          0,
          1,
          3753,
          1527,
          37,
          5707,
          8080,
          2852,
          7531,
          4641
        ],
        "f_before": [
          0.06097831949591637,
          0.0,
          0.0,
          0.0,
          1.0274404287338257,
          0.0,
          0.0,
          0.028516465798020363,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.06097831949591637,
          0.0,
          0.0,
          0.0,
          1.0274404287338257,
          0.0,
          0.0,
          0.028516465798020363,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.097615547478199,
            "f_after": 0.097615547478199,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.16417630016803741,
            "f_after": 0.16417630016803741,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.06097831949591637,
            "f_after": 0.06097831949591637,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.33872705698013306,
            "f_after": 0.33872705698013306,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0770886242389679,
            "f_after": 0.0770886242389679,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Classify the following movie as either a horror movie or a romantic comedy.\n\nThe Notebook\n\nRomantic Comedy\n\nThe Notebook is a romantic comedy, as it primarily revolves around two characters, Noah and Rachel, who fall in love while spending their days together at the lake. The film features moments of laughter, heartfelt conversations, and chemistry between Noah and Rachel that",
        "after": "Classify the following movie as either a horror movie or a romantic comedy.\n\nThe Notebook\n\nRomantic Comedy\nhorror movie\nhorror movie\nromantic comedy\nromantic comedy\nhorror movie\nromantic comedy\nhorror movie\nhorror movie\nhorror movie\nhorror movie\nhorror moviehorror moviehorror movie"
      }
    }
  }
}