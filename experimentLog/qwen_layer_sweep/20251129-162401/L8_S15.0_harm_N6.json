{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 8,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=8 experiment.layer_sweep=[8]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      8
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 7
  },
  "prompt": "Create a cartoon character that resembles a mouse.\n\nThe cartoon character is a mouse with a white fur, black eyes, big ears, a short tail, and two small buck teeth. The mouse is wearing a red and white striped shirt with a yellow collar, red and white checkered shorts, and a pair of yellow shoes with black laces.",
  "output": {
    "before": "Create a cartoon character that resembles a mouse.\n\nThe cartoon character is a mouse with a white fur, black eyes, big ears, a short tail, and two small buck teeth. The mouse is wearing a red and white striped shirt with a yellow collar, red and white checkered shorts, and a pair of yellow shoes with black laces. \n\nThe mouse's head is small and round, with a flat face and large ears that are always flapping in the breeze. Its nose is long and thin, and it has sharp claws on both front paws that can dig into soft surfaces like",
    "after": "Create a cartoon character that resembles a mouse.\n\nThe cartoon character is a mouse with a white fur, black eyes, big ears, a short tail, and two small buck teeth. The mouse is wearing a red and white striped shirt with a yellow collar, red and white checkered shorts, and a pair of yellow shoes with black laces. The mouse's mouth is open wide, revealing a large smiley face made out of cheese. It has a button nose and floppy ears that it uses to lift up objects or climb on shelves. The mouse is always trying to find its way back home"
  },
  "feature_stats": {
    "indices": [
      1,
      0,
      2,
      3753,
      37,
      1527,
      5707,
      2852,
      7656,
      6335,
      8080
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.011346220970153809,
      0.0,
      0.0,
      0.02287130057811737,
      0.0,
      0.017810771241784096
    ],
    "f_after": [
      0.0,
      0.0,
      0.11155994236469269,
      0.0,
      0.0,
      0.056893400847911835,
      0.0,
      0.0,
      0.07045991718769073,
      0.0,
      0.03433710336685181
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 4.318020832970738,
    "train_mean_l2": 2.232514812302776,
    "train_mean_l1": 1.4813821620140224,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-162401/feature_std_layer_8.html",
    "mean_std": 0.41402214765548706,
    "max_std": 58.45426940917969
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 7,
      "feature_stats": {
        "indices": [
          1,
          0,
          2,
          3753,
          37,
          1527,
          5707,
          2852,
          7656,
          6335,
          8080
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.011346220970153809,
          0.0,
          0.0,
          0.02287130057811737,
          0.0,
          0.017810771241784096
        ],
        "f_after": [
          0.0,
          0.0,
          0.11155994236469269,
          0.0,
          0.0,
          0.056893400847911835,
          0.0,
          0.0,
          0.07045991718769073,
          0.0,
          0.03433710336685181
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 2494,
            "f_before": 9.242162704467773,
            "f_after": 0.0,
            "delta_f": -9.242162704467773
          },
          {
            "index": 9055,
            "f_before": 0.32522955536842346,
            "f_after": 0.0,
            "delta_f": -0.32522955536842346
          },
          {
            "index": 4667,
            "f_before": 0.3188900947570801,
            "f_after": 0.023529738187789917,
            "delta_f": -0.29536035656929016
          },
          {
            "index": 2582,
            "f_before": 0.3939748704433441,
            "f_after": 0.10535063594579697,
            "delta_f": -0.28862423449754715
          },
          {
            "index": 2229,
            "f_before": 0.3240905702114105,
            "f_after": 0.041033077985048294,
            "delta_f": -0.28305749222636223
          },
          {
            "index": 6527,
            "f_before": 0.2718186378479004,
            "f_after": 0.0,
            "delta_f": -0.2718186378479004
          },
          {
            "index": 8255,
            "f_before": 0.5344746112823486,
            "f_after": 0.2861603796482086,
            "delta_f": -0.24831423163414001
          },
          {
            "index": 3649,
            "f_before": 0.3867292106151581,
            "f_after": 0.15562079846858978,
            "delta_f": -0.2311084121465683
          },
          {
            "index": 4860,
            "f_before": 0.29636338353157043,
            "f_after": 0.07394254207611084,
            "delta_f": -0.2224208414554596
          },
          {
            "index": 7247,
            "f_before": 0.21831949055194855,
            "f_after": 0.0,
            "delta_f": -0.21831949055194855
          },
          {
            "index": 2504,
            "f_before": 0.22148209810256958,
            "f_after": 0.0036837379448115826,
            "delta_f": -0.217798360157758
          },
          {
            "index": 7476,
            "f_before": 0.217538982629776,
            "f_after": 0.0,
            "delta_f": -0.217538982629776
          },
          {
            "index": 3193,
            "f_before": 0.21364739537239075,
            "f_after": 0.0,
            "delta_f": -0.21364739537239075
          },
          {
            "index": 6478,
            "f_before": 0.26057934761047363,
            "f_after": 0.05834648758172989,
            "delta_f": -0.20223286002874374
          },
          {
            "index": 1531,
            "f_before": 0.20109479129314423,
            "f_after": 0.0,
            "delta_f": -0.20109479129314423
          },
          {
            "index": 5931,
            "f_before": 0.3048136830329895,
            "f_after": 0.10482457280158997,
            "delta_f": -0.19998911023139954
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Create a cartoon character that resembles a mouse.\n\nThe cartoon character is a mouse with a white fur, black eyes, big ears, a short tail, and two small buck teeth. The mouse is wearing a red and white striped shirt with a yellow collar, red and white checkered shorts, and a pair of yellow shoes with black laces. \n\nAs the mouse runs through the city streets, it looks for any food or hiding places. It uses its sharp claws to dig through garbage cans, under tables, and in cracks in walls. It also scurries along busy sidewalks, avoiding obstacles",
        "after": "Create a cartoon character that resembles a mouse.\n\nThe cartoon character is a mouse with a white fur, black eyes, big ears, a short tail, and two small buck teeth. The mouse is wearing a red and white striped shirt with a yellow collar, red and white checkered shorts, and a pair of yellow shoes with black laces. The mouse's body language is cautious, but it still tries to explore the world around it. The mouse has a soft, fluffy tail that moves around its head, indicating its desire for adventure. Despite its mouse-like appearance, the mouse remains curious and"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 8,
      "feature_stats": {
        "indices": [
          1,
          0,
          2,
          3753,
          37,
          1527,
          5707,
          2852,
          7656,
          6335,
          8080
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.011346220970153809,
          0.0,
          0.0,
          0.02287130057811737,
          0.0,
          0.017810771241784096
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.011346220970153809,
          0.0,
          0.0,
          0.02287130057811737,
          0.0,
          0.017810771241784096
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.04409490525722504,
            "f_after": 0.04409490525722504,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Create a cartoon character that resembles a mouse.\n\nThe cartoon character is a mouse with a white fur, black eyes, big ears, a short tail, and two small buck teeth. The mouse is wearing a red and white striped shirt with a yellow collar, red and white checkered shorts, and a pair of yellow shoes with black laces. \n\nThe mouse has a round body with a small, pink nose and a long, bushy tail that it uses to navigate through its environment. It has large, round ears that are always perched up on top of its head, allowing it to",
        "after": "Create a cartoon character that resembles a mouse.\n\nThe cartoon character is a mouse with a white fur, black eyes, big ears, a short tail, and two small buck teeth. The mouse is wearing a red and white striped shirt with a yellow collar, red and white checkered shorts, and a pair of yellow shoes with black laces. The mouse has big floppy ears and a round nose with whiskers growing out of it. Whenever the mouse tries to move or eat food, he gets stuck in different places, like on a shelf or under a chair. Despite his attempts to escape,"
      }
    }
  }
}