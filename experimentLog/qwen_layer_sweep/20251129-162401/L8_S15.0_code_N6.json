{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 8,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=8 experiment.layer_sweep=[8]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      8
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 7
  },
  "prompt": "Create a cartoon character that resembles a mouse.\n\nThe cartoon character is a mouse with a white fur, black eyes, big ears, a short tail, and two small buck teeth. The mouse is wearing a red and white striped shirt with a yellow collar, red and white checkered shorts, and a pair of yellow shoes with black laces.",
  "output": {
    "before": "Create a cartoon character that resembles a mouse.\n\nThe cartoon character is a mouse with a white fur, black eyes, big ears, a short tail, and two small buck teeth. The mouse is wearing a red and white striped shirt with a yellow collar, red and white checkered shorts, and a pair of yellow shoes with black laces. \n\nIn the background, there is a cluttered room with various objects scattered on the floor, such as books, papers, and a desk with a computer monitor on it. The mouse is depicted standing on one leg, looking at the screen with a",
    "after": "Create a cartoon character that resembles a mouse.\n\nThe cartoon character is a mouse with a white fur, black eyes, big ears, a short tail, and two small buck teeth. The mouse is wearing a red and white striped shirt with a yellow collar, red and white checkered shorts, and a pair of yellow shoes with black laces. In the background, there are various household items like a vacuum cleaner, a microwave oven, a trash can, and a bookshelf. The mouse has a friendly expression on its face as it tries to explore the house by clicking on furniture and using its"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      1,
      3753,
      1527,
      37,
      8080,
      5707,
      2852,
      4641,
      7531
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.011346220970153809,
      0.0,
      0.017810771241784096,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      0.18509602546691895,
      0.0,
      0.0,
      0.13366487622261047,
      0.0,
      0.026148134842514992,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 4.318020832970738,
    "train_mean_l2": 2.232514812302776,
    "train_mean_l1": 1.4813821620140224,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-162401/feature_std_layer_8.html",
    "mean_std": 0.41402214765548706,
    "max_std": 58.45426940917969
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 7,
      "feature_stats": {
        "indices": [
          0,
          2,
          1,
          3753,
          1527,
          37,
          8080,
          5707,
          2852,
          4641,
          7531
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.011346220970153809,
          0.0,
          0.017810771241784096,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.18509602546691895,
          0.0,
          0.0,
          0.13366487622261047,
          0.0,
          0.026148134842514992,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 2494,
            "f_before": 9.242162704467773,
            "f_after": 0.0,
            "delta_f": -9.242162704467773
          },
          {
            "index": 9055,
            "f_before": 0.32522955536842346,
            "f_after": 0.0,
            "delta_f": -0.32522955536842346
          },
          {
            "index": 8255,
            "f_before": 0.5344746112823486,
            "f_after": 0.21423938870429993,
            "delta_f": -0.3202352225780487
          },
          {
            "index": 4667,
            "f_before": 0.3188900947570801,
            "f_after": 0.0,
            "delta_f": -0.3188900947570801
          },
          {
            "index": 2229,
            "f_before": 0.3240905702114105,
            "f_after": 0.006123807746917009,
            "delta_f": -0.3179667624644935
          },
          {
            "index": 2582,
            "f_before": 0.3939748704433441,
            "f_after": 0.10487168282270432,
            "delta_f": -0.2891031876206398
          },
          {
            "index": 6527,
            "f_before": 0.2718186378479004,
            "f_after": 0.0,
            "delta_f": -0.2718186378479004
          },
          {
            "index": 4860,
            "f_before": 0.29636338353157043,
            "f_after": 0.04647999256849289,
            "delta_f": -0.24988339096307755
          },
          {
            "index": 3649,
            "f_before": 0.3867292106151581,
            "f_after": 0.1550377458333969,
            "delta_f": -0.23169146478176117
          },
          {
            "index": 7476,
            "f_before": 0.217538982629776,
            "f_after": 0.0,
            "delta_f": -0.217538982629776
          },
          {
            "index": 3193,
            "f_before": 0.21364739537239075,
            "f_after": 0.0,
            "delta_f": -0.21364739537239075
          },
          {
            "index": 7247,
            "f_before": 0.21831949055194855,
            "f_after": 0.010344931855797768,
            "delta_f": -0.20797455869615078
          },
          {
            "index": 3657,
            "f_before": 0.23285932838916779,
            "f_after": 0.02517346851527691,
            "delta_f": -0.20768585987389088
          },
          {
            "index": 1758,
            "f_before": 0.3558114469051361,
            "f_after": 0.5610685348510742,
            "delta_f": 0.2052570879459381
          },
          {
            "index": 1531,
            "f_before": 0.20109479129314423,
            "f_after": 0.0,
            "delta_f": -0.20109479129314423
          },
          {
            "index": 6518,
            "f_before": 0.21922260522842407,
            "f_after": 0.01911451481282711,
            "delta_f": -0.20010809041559696
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Create a cartoon character that resembles a mouse.\n\nThe cartoon character is a mouse with a white fur, black eyes, big ears, a short tail, and two small buck teeth. The mouse is wearing a red and white striped shirt with a yellow collar, red and white checkered shorts, and a pair of yellow shoes with black laces. \n\nAs the mouse runs through the city streets, it can be seen using its webbed feet to navigate through the busy sidewalks and alleys. It often stops at food stores and markets to sniff out tasty treats, but it's also known for being",
        "after": "Create a cartoon character that resembles a mouse.\n\nThe cartoon character is a mouse with a white fur, black eyes, big ears, a short tail, and two small buck teeth. The mouse is wearing a red and white striped shirt with a yellow collar, red and white checkered shorts, and a pair of yellow shoes with black laces. \n\nDespite its small size, the mouse's personality shines through. Its eyes are large and expressive, reflecting the mouse's curious nature. It loves to investigate new places and explore every nook and cranny. However, this enthusiasm can sometimes lead it"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 8,
      "feature_stats": {
        "indices": [
          0,
          2,
          1,
          3753,
          1527,
          37,
          8080,
          5707,
          2852,
          4641,
          7531
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.011346220970153809,
          0.0,
          0.017810771241784096,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.011346220970153809,
          0.0,
          0.017810771241784096,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.04409490525722504,
            "f_after": 0.04409490525722504,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Create a cartoon character that resembles a mouse.\n\nThe cartoon character is a mouse with a white fur, black eyes, big ears, a short tail, and two small buck teeth. The mouse is wearing a red and white striped shirt with a yellow collar, red and white checkered shorts, and a pair of yellow shoes with black laces. \n\nIn the cartoon, the mouse is seen walking around in a cityscape, looking for food and shelter. It's a busy city with tall buildings, busy streets, and people rushing to their jobs and errands. As the mouse approaches a building",
        "after": "Create a cartoon character that resembles a mouse.\n\nThe cartoon character is a mouse with a white fur, black eyes, big ears, a short tail, and two small buck teeth. The mouse is wearing a red and white striped shirt with a yellow collar, red and white checkered shorts, and a pair of yellow shoes with black laces. The mouse has big round ears that flop when it moves, and its whiskers twitch as if they're thinking about something. When the mouse sees food, it runs over to where the food is and starts gnawing at it, but suddenly stops"
      }
    }
  }
}