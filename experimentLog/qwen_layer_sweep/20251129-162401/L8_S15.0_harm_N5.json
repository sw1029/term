{
  "model_name": "Qwen/Qwen1.5-1.8B-Chat",
  "layer_idx": 8,
  "command": "main.py experiment.model_name=Qwen/Qwen1.5-1.8B-Chat experiment.hf_loader.use_qwen_remote_code=true experiment.use_multi_contrast=true sae.loss_option=4 sae.loss_module=option4_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.03 sae.alpha_concept.harm=0.06 sae.alpha_concept.struct=0.0 sae.l1_coeff=0.003 sae.use_l0=true sae.l0_coeff=0.0005 sae.role_sep_coeff=0.003 +sae.align_coeff=0.5 +sae.align_pos_margin=0.25 +sae.align_neg_margin=0.05 experiment.strength_sweep=[15.0] paths.logs_root=experimentLog/layer_sweep sae.layer_idx=8 experiment.layer_sweep=[8]",
  "sae": {
    "input_dim": 2048,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.003,
    "l0_coeff": 0.0005,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 4,
    "loss_module": "option4_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.03,
      "harm": 0.06,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.003
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      8
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 7
  },
  "prompt": "Classify the following movie as either a horror movie or a romantic comedy.\n\nThe Notebook\n\nRomantic Comedy",
  "output": {
    "before": "Classify the following movie as either a horror movie or a romantic comedy.\n\nThe Notebook\n\nRomantic Comedy",
    "after": "Classify the following movie as either a horror movie or a romantic comedy.\n\nThe Notebook\n\nRomantic Comedy, Horror Movie\nThe Notebook is a romantic comedy that often features elements of romance and love triangles, but it does not primarily focus on these themes. Instead, the story revolves around Noah and Allie, two young people from different backgrounds who fall in"
  },
  "feature_stats": {
    "indices": [
      1,
      0,
      2,
      3753,
      37,
      1527,
      5707,
      2852,
      7656,
      6335,
      8080
    ],
    "f_before": [
      0.0,
      0.0,
      0.06097831949591637,
      0.0,
      0.0,
      1.0274404287338257,
      0.0,
      0.0,
      0.533183217048645,
      0.0,
      0.028516465798020363
    ],
    "f_after": [
      0.0,
      0.0,
      0.18417634069919586,
      0.0,
      0.0,
      1.0729870796203613,
      0.0,
      0.0,
      0.5807717442512512,
      0.0,
      0.04504281282424927
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 4.318020832970738,
    "train_mean_l2": 2.232514812302776,
    "train_mean_l1": 1.4813821620140224,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251129-162401/feature_std_layer_8.html",
    "mean_std": 0.41402214765548706,
    "max_std": 58.45426940917969
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 7,
      "feature_stats": {
        "indices": [
          1,
          0,
          2,
          3753,
          37,
          1527,
          5707,
          2852,
          7656,
          6335,
          8080
        ],
        "f_before": [
          0.0,
          0.0,
          0.06097831949591637,
          0.0,
          0.0,
          1.0274404287338257,
          0.0,
          0.0,
          0.533183217048645,
          0.0,
          0.028516465798020363
        ],
        "f_after": [
          0.0,
          0.0,
          0.18417634069919586,
          0.0,
          0.0,
          1.0729870796203613,
          0.0,
          0.0,
          0.5807717442512512,
          0.0,
          0.04504281282424927
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 2494,
            "f_before": 22.53597640991211,
            "f_after": 12.542189598083496,
            "delta_f": -9.993786811828613
          },
          {
            "index": 3193,
            "f_before": 0.8865073919296265,
            "f_after": 0.2637903690338135,
            "delta_f": -0.622717022895813
          },
          {
            "index": 9055,
            "f_before": 1.1882035732269287,
            "f_after": 0.6318508982658386,
            "delta_f": -0.5563526749610901
          },
          {
            "index": 7476,
            "f_before": 1.4203739166259766,
            "f_after": 0.9498663544654846,
            "delta_f": -0.47050756216049194
          },
          {
            "index": 6527,
            "f_before": 1.4457149505615234,
            "f_after": 1.0680811405181885,
            "delta_f": -0.37763381004333496
          },
          {
            "index": 1531,
            "f_before": 1.1416840553283691,
            "f_after": 0.7954392433166504,
            "delta_f": -0.34624481201171875
          },
          {
            "index": 5928,
            "f_before": 1.274617314338684,
            "f_after": 0.9538833498954773,
            "delta_f": -0.3207339644432068
          },
          {
            "index": 4667,
            "f_before": 1.9953981637954712,
            "f_after": 1.700037956237793,
            "delta_f": -0.2953602075576782
          },
          {
            "index": 2582,
            "f_before": 1.8477360010147095,
            "f_after": 1.5591113567352295,
            "delta_f": -0.28862464427948
          },
          {
            "index": 2229,
            "f_before": 1.7424571514129639,
            "f_after": 1.4593995809555054,
            "delta_f": -0.2830575704574585
          },
          {
            "index": 3372,
            "f_before": 0.8069877028465271,
            "f_after": 0.5373507142066956,
            "delta_f": -0.26963698863983154
          },
          {
            "index": 2678,
            "f_before": 1.0858455896377563,
            "f_after": 0.8172564506530762,
            "delta_f": -0.2685891389846802
          },
          {
            "index": 5420,
            "f_before": 0.8424617052078247,
            "f_after": 0.5749773979187012,
            "delta_f": -0.26748430728912354
          },
          {
            "index": 8255,
            "f_before": 1.7502373456954956,
            "f_after": 1.501923680305481,
            "delta_f": -0.24831366539001465
          },
          {
            "index": 3649,
            "f_before": 1.8814754486083984,
            "f_after": 1.6503665447235107,
            "delta_f": -0.2311089038848877
          },
          {
            "index": 7247,
            "f_before": 1.5355043411254883,
            "f_after": 1.3130091428756714,
            "delta_f": -0.2224951982498169
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Classify the following movie as either a horror movie or a romantic comedy.\n\nThe Notebook\n\nRomantic Comedy\n\nStephenson's \"The Proposal\"\n\nHorror Movie\n\n\"The Silence of the Lambs\" Step 1: Analyze the plot and themes of each movie\n- The Notebook: A love story set in the early 20th century",
        "after": "Classify the following movie as either a horror movie or a romantic comedy.\n\nThe Notebook\n\nRomantic Comedy"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 8,
      "feature_stats": {
        "indices": [
          1,
          0,
          2,
          3753,
          37,
          1527,
          5707,
          2852,
          7656,
          6335,
          8080
        ],
        "f_before": [
          0.0,
          0.0,
          0.06097831949591637,
          0.0,
          0.0,
          1.0274404287338257,
          0.0,
          0.0,
          0.533183217048645,
          0.0,
          0.028516465798020363
        ],
        "f_after": [
          0.0,
          0.0,
          0.06097831949591637,
          0.0,
          0.0,
          1.0274404287338257,
          0.0,
          0.0,
          0.533183217048645,
          0.0,
          0.028516465798020363
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.097615547478199,
            "f_after": 0.097615547478199,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.16417630016803741,
            "f_after": 0.16417630016803741,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.06097831949591637,
            "f_after": 0.06097831949591637,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.33872705698013306,
            "f_after": 0.33872705698013306,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0770886242389679,
            "f_after": 0.0770886242389679,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Classify the following movie as either a horror movie or a romantic comedy.\n\nThe Notebook\n\nRomantic Comedy\nSure, The Notebook is classified as a romantic comedy. The movie follows the story of Noah and Allie, two young people who fall in love during World War II. They have a deep connection and try to maintain their relationship despite the challenges they",
        "after": "Classify the following movie as either a horror movie or a romantic comedy.\n\nThe Notebook\n\nRomantic Comedyhorror moviehorror movieromantic comedyhorror movieromantic comedy\nHorror movieromantic comedyhorror movieromantic comedyhorror movieromantic comedyhorror movieromantic comedyhorror movieromantic comedyhorror movierom"
      }
    }
  }
}