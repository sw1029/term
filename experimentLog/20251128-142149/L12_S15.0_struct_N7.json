{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "python main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.05 sae.alpha_concept.harm=0.03 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.00037731631260996427 sae.role_sep_coeff=0.0095",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.00037731631260996427,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.05,
      "harm": 0.03,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0095
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Summarise in one sentence why the given technology is so important.\n\nArtificial intelligence\n\nAI is an essential technology for automating many of the cognitive tasks that are essential to modern society.",
  "output": {
    "before": "Summarise in one sentence why the given technology is so important.\n\nArtificial intelligence\n\nAI is an essential technology for automating many of the cognitive tasks that are essential to modern society. \n",
    "after": "Summarise in one sentence why the given technology is so important.\n\nArtificial intelligence\n\nAI is an essential technology for automating many of the cognitive tasks that are essential to modern society. \n\n**Explanation:**\n* **Automating Cognitive Tasks:** AI allows machines to perform tasks that typically require human intelligence, such as decision-making, learning, and problem-solving.\n* **Modern Society Needs:** AI's ability to"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      1541,
      859,
      7564,
      5662,
      3370,
      6732,
      6493,
      5445,
      3226
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.12182368338108063,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.0,
      69.12236785888672,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 10.01762550815125,
    "train_mean_l2": 7.948200629286468,
    "train_mean_l1": 2.7709025331735613,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251128-142149/feature_std_layer_12.html",
    "mean_std": 1.2138572931289673,
    "max_std": 39.272926330566406
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          2,
          0,
          1541,
          859,
          7564,
          5662,
          3370,
          6732,
          6493,
          5445,
          3226
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.12182368338108063,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          69.12236785888672,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 69.12236785888672,
            "delta_f": 69.12236785888672
          },
          {
            "index": 7458,
            "f_before": 115.87738800048828,
            "f_after": 88.82148742675781,
            "delta_f": -27.05590057373047
          },
          {
            "index": 7276,
            "f_before": 35.351654052734375,
            "f_after": 14.164393424987793,
            "delta_f": -21.187260627746582
          },
          {
            "index": 2497,
            "f_before": 0.0,
            "f_after": 10.324251174926758,
            "delta_f": 10.324251174926758
          },
          {
            "index": 6384,
            "f_before": 0.0,
            "f_after": 8.538145065307617,
            "delta_f": 8.538145065307617
          },
          {
            "index": 4437,
            "f_before": 0.0,
            "f_after": 7.532478332519531,
            "delta_f": 7.532478332519531
          },
          {
            "index": 1184,
            "f_before": 0.0,
            "f_after": 7.451255798339844,
            "delta_f": 7.451255798339844
          },
          {
            "index": 1,
            "f_before": 25.045068740844727,
            "f_after": 17.625843048095703,
            "delta_f": -7.419225692749023
          },
          {
            "index": 2929,
            "f_before": 0.0,
            "f_after": 7.139196872711182,
            "delta_f": 7.139196872711182
          },
          {
            "index": 8305,
            "f_before": 0.0,
            "f_after": 7.138206481933594,
            "delta_f": 7.138206481933594
          },
          {
            "index": 240,
            "f_before": 0.0,
            "f_after": 7.078470706939697,
            "delta_f": 7.078470706939697
          },
          {
            "index": 4430,
            "f_before": 0.0,
            "f_after": 6.277918338775635,
            "delta_f": 6.277918338775635
          },
          {
            "index": 7736,
            "f_before": 0.0,
            "f_after": 6.197482585906982,
            "delta_f": 6.197482585906982
          },
          {
            "index": 898,
            "f_before": 0.0,
            "f_after": 6.150256156921387,
            "delta_f": 6.150256156921387
          },
          {
            "index": 4612,
            "f_before": 0.0,
            "f_after": 6.085569381713867,
            "delta_f": 6.085569381713867
          },
          {
            "index": 7805,
            "f_before": 0.0,
            "f_after": 6.073745250701904,
            "delta_f": 6.073745250701904
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Summarise in one sentence why the given technology is so important.\n\nArtificial intelligence\n\nAI is an essential technology for automating many of the cognitive tasks that are essential to modern society. \n",
        "after": "Summarise in one sentence why the given technology is so important.\n\nArtificial intelligence\n\nAI is an essential technology for automating many of the cognitive tasks that are essential to modern society.\n\n\n**Please note:** This is a sample summary. You can modify it based on your needs.\n"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          2,
          0,
          1541,
          859,
          7564,
          5662,
          3370,
          6732,
          6493,
          5445,
          3226
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.12182368338108063,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.12182368338108063,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.05953018739819527,
            "f_after": 0.05953018739819527,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 25.045068740844727,
            "f_after": 25.045068740844727,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Summarise in one sentence why the given technology is so important.\n\nArtificial intelligence\n\nAI is an essential technology for automating many of the cognitive tasks that are essential to modern society. \n",
        "after": "Summarise in one sentence why the given technology is so important.\n\nArtificial intelligence\n\nAI is an essential technology for automating many of the cognitive tasks that are essential to modern society.\n\n\n**Note:** This is just a summary. Feel free to modify the summary based on your understanding and preferences.\n"
      }
    }
  }
}