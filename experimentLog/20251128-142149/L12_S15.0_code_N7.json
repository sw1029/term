{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "python main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.05 sae.alpha_concept.harm=0.03 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.00037731631260996427 sae.role_sep_coeff=0.0095",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.00037731631260996427,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.05,
      "harm": 0.03,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0095
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "code",
    "feature_idx": 0,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Summarise in one sentence why the given technology is so important.\n\nArtificial intelligence\n\nAI is an essential technology for automating many of the cognitive tasks that are essential to modern society.",
  "output": {
    "before": "Summarise in one sentence why the given technology is so important.\n\nArtificial intelligence\n\nAI is an essential technology for automating many of the cognitive tasks that are essential to modern society.\n\n\n",
    "after": "Summarise in one sentence why the given technology is so important.\n\nArtificial intelligence\n\nAI is an essential technology for automating many of the cognitive tasks that are essential to modern society.\n\n\n"
  },
  "feature_stats": {
    "indices": [
      0,
      2,
      7564,
      859,
      1114,
      4101,
      7528,
      6732,
      749,
      1047,
      5445
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.12182368338108063,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      83.34095001220703,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 10.01762550815125,
    "train_mean_l2": 7.948200629286468,
    "train_mean_l1": 2.7709025331735613,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251128-142149/feature_std_layer_12.html",
    "mean_std": 1.2138572931289673,
    "max_std": 39.272926330566406
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          0,
          2,
          7564,
          859,
          1114,
          4101,
          7528,
          6732,
          749,
          1047,
          5445
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.12182368338108063,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          83.34095001220703,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 83.34095001220703,
            "delta_f": 83.34095001220703
          },
          {
            "index": 7276,
            "f_before": 35.351654052734375,
            "f_after": 10.830255508422852,
            "delta_f": -24.521398544311523
          },
          {
            "index": 7458,
            "f_before": 115.87738800048828,
            "f_after": 103.71011352539062,
            "delta_f": -12.167274475097656
          },
          {
            "index": 6384,
            "f_before": 0.0,
            "f_after": 9.028650283813477,
            "delta_f": 9.028650283813477
          },
          {
            "index": 2929,
            "f_before": 0.0,
            "f_after": 7.875770568847656,
            "delta_f": 7.875770568847656
          },
          {
            "index": 1184,
            "f_before": 0.0,
            "f_after": 7.802029132843018,
            "delta_f": 7.802029132843018
          },
          {
            "index": 8305,
            "f_before": 0.0,
            "f_after": 7.4973955154418945,
            "delta_f": 7.4973955154418945
          },
          {
            "index": 240,
            "f_before": 0.0,
            "f_after": 7.4040327072143555,
            "delta_f": 7.4040327072143555
          },
          {
            "index": 4437,
            "f_before": 0.0,
            "f_after": 7.100314617156982,
            "delta_f": 7.100314617156982
          },
          {
            "index": 790,
            "f_before": 0.0,
            "f_after": 6.962672233581543,
            "delta_f": 6.962672233581543
          },
          {
            "index": 7805,
            "f_before": 0.0,
            "f_after": 6.787383079528809,
            "delta_f": 6.787383079528809
          },
          {
            "index": 1,
            "f_before": 25.045068740844727,
            "f_after": 18.28180694580078,
            "delta_f": -6.763261795043945
          },
          {
            "index": 4430,
            "f_before": 0.0,
            "f_after": 6.494361400604248,
            "delta_f": 6.494361400604248
          },
          {
            "index": 4612,
            "f_before": 0.0,
            "f_after": 6.29980993270874,
            "delta_f": 6.29980993270874
          },
          {
            "index": 1100,
            "f_before": 0.0,
            "f_after": 6.265872478485107,
            "delta_f": 6.265872478485107
          },
          {
            "index": 6623,
            "f_before": 0.0,
            "f_after": 6.265510559082031,
            "delta_f": 6.265510559082031
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Summarise in one sentence why the given technology is so important.\n\nArtificial intelligence\n\nAI is an essential technology for automating many of the cognitive tasks that are essential to modern society.\n\n\nThis technology is important because it can automate tasks and free up human resources for more creative and complex tasks. \n",
        "after": "Summarise in one sentence why the given technology is so important.\n\nArtificial intelligence\n\nAI is an essential technology for automating many of the cognitive tasks that are essential to modern society. \n\n"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          0,
          2,
          7564,
          859,
          1114,
          4101,
          7528,
          6732,
          749,
          1047,
          5445
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.12182368338108063,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.12182368338108063,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.05953018739819527,
            "f_after": 0.05953018739819527,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 25.045068740844727,
            "f_after": 25.045068740844727,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Summarise in one sentence why the given technology is so important.\n\nArtificial intelligence\n\nAI is an essential technology for automating many of the cognitive tasks that are essential to modern society. \n\n\n",
        "after": "Summarise in one sentence why the given technology is so important.\n\nArtificial intelligence\n\nAI is an essential technology for automating many of the cognitive tasks that are essential to modern society.\n\n**Explanation:**\n\nThis is a very good summary of the importance of AI.\n\nLet me know if you need any further information.\n\n**Explanation:**\n\nThe provided summary is a good summary. It concisely explains why AI is important."
      }
    }
  }
}