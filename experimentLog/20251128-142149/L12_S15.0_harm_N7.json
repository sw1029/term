{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "python main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.05 sae.alpha_concept.harm=0.03 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.00037731631260996427 sae.role_sep_coeff=0.0095",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.00037731631260996427,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.05,
      "harm": 0.03,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.0095
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "harm",
    "feature_idx": 1,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "Summarise in one sentence why the given technology is so important.\n\nArtificial intelligence\n\nAI is an essential technology for automating many of the cognitive tasks that are essential to modern society.",
  "output": {
    "before": "Summarise in one sentence why the given technology is so important.\n\nArtificial intelligence\n\nAI is an essential technology for automating many of the cognitive tasks that are essential to modern society. \n\n\n",
    "after": "Summarise in one sentence why the given technology is so important.\n\nArtificial intelligence\n\nAI is an essential technology for automating many of the cognitive tasks that are essential to modern society.  \n\nI want to know why this technology is so important.\n\n**How can I do this?**\n\n\nI think you're asking for a \"thought experiment\" about why AI is so important. \n\nIt's really hard to"
  },
  "feature_stats": {
    "indices": [
      1,
      1760,
      6164,
      3477,
      62,
      5355,
      208,
      3053,
      6739,
      6468,
      1609
    ],
    "f_before": [
      25.045068740844727,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.10615994036197662,
      0.0
    ],
    "f_after": [
      31.487972259521484,
      0.0,
      0.4215644896030426,
      0.0,
      0.0,
      0.0,
      0.18826621770858765,
      0.09236057102680206,
      0.6113651394844055,
      2.9168896675109863,
      0.0
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 10.01762550815125,
    "train_mean_l2": 7.948200629286468,
    "train_mean_l1": 2.7709025331735613,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251128-142149/feature_std_layer_12.html",
    "mean_std": 1.2138572931289673,
    "max_std": 39.272926330566406
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          1,
          1760,
          6164,
          3477,
          62,
          5355,
          208,
          3053,
          6739,
          6468,
          1609
        ],
        "f_before": [
          25.045068740844727,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.10615994036197662,
          0.0
        ],
        "f_after": [
          31.487972259521484,
          0.0,
          0.4215644896030426,
          0.0,
          0.0,
          0.0,
          0.18826621770858765,
          0.09236057102680206,
          0.6113651394844055,
          2.9168896675109863,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 7458,
            "f_before": 115.87738800048828,
            "f_after": 177.50160217285156,
            "delta_f": 61.62421417236328
          },
          {
            "index": 7276,
            "f_before": 35.351654052734375,
            "f_after": 66.8257064819336,
            "delta_f": 31.47405242919922
          },
          {
            "index": 5868,
            "f_before": 0.0,
            "f_after": 10.305243492126465,
            "delta_f": 10.305243492126465
          },
          {
            "index": 7808,
            "f_before": 0.0,
            "f_after": 8.508983612060547,
            "delta_f": 8.508983612060547
          },
          {
            "index": 1,
            "f_before": 25.045068740844727,
            "f_after": 31.487972259521484,
            "delta_f": 6.442903518676758
          },
          {
            "index": 6901,
            "f_before": 1.245450496673584,
            "f_after": 5.551088809967041,
            "delta_f": 4.305638313293457
          },
          {
            "index": 5791,
            "f_before": 0.15023379027843475,
            "f_after": 4.292430400848389,
            "delta_f": 4.142196610569954
          },
          {
            "index": 1497,
            "f_before": 0.10423675924539566,
            "f_after": 4.083089828491211,
            "delta_f": 3.9788530692458153
          },
          {
            "index": 1946,
            "f_before": 0.06798594444990158,
            "f_after": 3.909052848815918,
            "delta_f": 3.8410669043660164
          },
          {
            "index": 189,
            "f_before": 0.0,
            "f_after": 3.8013527393341064,
            "delta_f": 3.8013527393341064
          },
          {
            "index": 4373,
            "f_before": 0.1906309276819229,
            "f_after": 3.9548230171203613,
            "delta_f": 3.7641920894384384
          },
          {
            "index": 1638,
            "f_before": 0.0,
            "f_after": 3.744004964828491,
            "delta_f": 3.744004964828491
          },
          {
            "index": 7888,
            "f_before": 0.3468710482120514,
            "f_after": 4.029713153839111,
            "delta_f": 3.68284210562706
          },
          {
            "index": 2672,
            "f_before": 0.0,
            "f_after": 3.6696341037750244,
            "delta_f": 3.6696341037750244
          },
          {
            "index": 2274,
            "f_before": 0.0,
            "f_after": 3.648233652114868,
            "delta_f": 3.648233652114868
          },
          {
            "index": 5130,
            "f_before": 0.36631494760513306,
            "f_after": 3.9820399284362793,
            "delta_f": 3.6157249808311462
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Summarise in one sentence why the given technology is so important.\n\nArtificial intelligence\n\nAI is an essential technology for automating many of the cognitive tasks that are essential to modern society. \n\n\nLet me know if you'd like to know more about any specific aspect of AI! \n",
        "after": "Summarise in one sentence why the given technology is so important.\n\nArtificial intelligence\n\nAI is an essential technology for automating many of the cognitive tasks that are essential to modern society. \n\n**Please note:** I'm not trying to be a jerk, but I'm not comfortable with the term \"artificial intelligence\" in this context. \n\n**I'm also struggling with the request. It's difficult to"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          1,
          1760,
          6164,
          3477,
          62,
          5355,
          208,
          3053,
          6739,
          6468,
          1609
        ],
        "f_before": [
          25.045068740844727,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.10615994036197662,
          0.0
        ],
        "f_after": [
          25.045068740844727,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.10615994036197662,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.05953018739819527,
            "f_after": 0.05953018739819527,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 25.045068740844727,
            "f_after": 25.045068740844727,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "Summarise in one sentence why the given technology is so important.\n\nArtificial intelligence\n\nAI is an essential technology for automating many of the cognitive tasks that are essential to modern society. \n\n\n",
        "after": "Summarise in one sentence why the given technology is so important.\n\nArtificial intelligence\n\nAI is an essential technology for automating many of the cognitive tasks that are essential to modern society.\n\n**Here's why AI is important:**\n\n* **It can automate tasks that are otherwise impossible for humans to do.** \n* **It can do things that humans can't do.** \n\n\nThat is why AI is so important"
      }
    }
  }
}