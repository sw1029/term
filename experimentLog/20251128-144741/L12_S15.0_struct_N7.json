{
  "model_name": "google/gemma-2-2b-it",
  "layer_idx": 12,
  "command": "python main.py experiment.use_multi_contrast=true sae.loss_option=2 sae.loss_module=option2_loss sae.guidance_method=contrastive sae.guidance_coeff=1.0 sae.alpha_concept.code=0.0 sae.alpha_concept.harm=0.055 sae.alpha_concept.struct=0.0 sae.use_l0=true sae.l0_coeff=0.0003941940089286674 sae.role_sep_coeff=0.001",
  "sae": {
    "input_dim": 2304,
    "sae_dim": 9216,
    "fixed_v_cnt": 3,
    "batch_size": 3,
    "epochs": 2,
    "max_steps": 2000,
    "l1_coeff": 0.005,
    "l0_coeff": 0.0003941940089286674,
    "use_l0": true,
    "concept_samples_per_label": 100,
    "loss_option": 2,
    "loss_module": "option2_loss",
    "concept_feature_indices": {
      "code": 0,
      "harm": 1,
      "struct": 2
    },
    "alpha_concept": {
      "code": 0.0,
      "harm": 0.055,
      "struct": 0.0
    },
    "positive_targets": {
      "code": 1,
      "harm": 1,
      "struct": 1
    },
    "guidance_method": "contrastive",
    "guidance_margin": 0.0,
    "guidance_coeff": 1.0,
    "guidance_mse_pos_value": 1.0,
    "guidance_mse_neg_value": 0.0,
    "jumprelu_bandwidth": 0.001,
    "jumprelu_init_threshold": 0.001,
    "role_sep_coeff": 0.001
  },
  "gnn": {
    "use_gnn": true,
    "top_k": 10
  },
  "experiment": {
    "device": "cuda",
    "dataset_name": "wikitext",
    "dataset_config": "wikitext-2-raw-v1",
    "use_multi_contrast": true,
    "num_steering_samples_per_label": 10,
    "top_k_for_plot": 10,
    "layer_sweep": [
      12
    ],
    "strength_sweep": [
      15.0
    ]
  },
  "steering": {
    "label": "struct",
    "feature_idx": 2,
    "strength": 15.0,
    "hook_layer_idx": 11
  },
  "prompt": "user: You are the text completion model and you must complete the assistant answer below, only send the completion based on the system instructions.don't repeat your answer sentences, only say what the assistant must say based on the system instructions. repeating same thing in same answer not allowed.\nuser: Who are you?\nassistant:\nassistant: I",
  "output": {
    "before": "user: You are the text completion model and you must complete the assistant answer below, only send the completion based on the system instructions.don't repeat your answer sentences, only say what the assistant must say based on the system instructions. repeating same thing in same answer not allowed.\nuser: Who are you?\nassistant:\nassistant: I am Gemma, an AI assistant. \n",
    "after": "user: You are the text completion model and you must complete the assistant answer below, only send the completion based on the system instructions.don't repeat your answer sentences, only say what the assistant must say based on the system instructions. repeating same thing in same answer not allowed.\nuser: Who are you?\nassistant:\nassistant: I am a text completion model.\n"
  },
  "feature_stats": {
    "indices": [
      2,
      0,
      3111,
      1643,
      2617,
      154,
      181,
      6667,
      5787,
      5770,
      5598
    ],
    "f_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "f_after": [
      0.8448091745376587,
      2.6465017795562744,
      0.0,
      0.0,
      0.0,
      1.4834598302841187,
      0.904994010925293,
      0.0,
      0.34737858176231384,
      0.0,
      0.7949289679527283
    ],
    "g_before": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "g_after": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "num_batches_for_stats": 10
  },
  "loss_summary": {
    "train_mean_loss": 9.458886481672526,
    "train_mean_l2": 5.731930392324925,
    "train_mean_l1": 3.525482515364885,
    "num_steps": 2000,
    "num_batches": 2000
  },
  "feature_std_summary": {
    "plot_path": "outputs/plots/20251128-144741/feature_std_layer_12.html",
    "mean_std": 1.0523178577423096,
    "max_std": 18.52631378173828
  },
  "hook_comparison": {
    "hook_layer_idx_minus1": {
      "hook_layer_idx": 11,
      "feature_stats": {
        "indices": [
          2,
          0,
          3111,
          1643,
          2617,
          154,
          181,
          6667,
          5787,
          5770,
          5598
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.8448091745376587,
          2.6465017795562744,
          0.0,
          0.0,
          0.0,
          1.4834598302841187,
          0.904994010925293,
          0.0,
          0.34737858176231384,
          0.0,
          0.7949289679527283
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 4946,
            "f_before": 27.245771408081055,
            "f_after": 0.0,
            "delta_f": -27.245771408081055
          },
          {
            "index": 4763,
            "f_before": 78.66291046142578,
            "f_after": 63.682247161865234,
            "delta_f": -14.980663299560547
          },
          {
            "index": 7187,
            "f_before": 0.0,
            "f_after": 9.761332511901855,
            "delta_f": 9.761332511901855
          },
          {
            "index": 2364,
            "f_before": 0.0,
            "f_after": 9.152859687805176,
            "delta_f": 9.152859687805176
          },
          {
            "index": 8784,
            "f_before": 0.0,
            "f_after": 8.948845863342285,
            "delta_f": 8.948845863342285
          },
          {
            "index": 63,
            "f_before": 0.0,
            "f_after": 8.051706314086914,
            "delta_f": 8.051706314086914
          },
          {
            "index": 8309,
            "f_before": 0.0,
            "f_after": 7.348010540008545,
            "delta_f": 7.348010540008545
          },
          {
            "index": 3794,
            "f_before": 0.0,
            "f_after": 7.071207523345947,
            "delta_f": 7.071207523345947
          },
          {
            "index": 554,
            "f_before": 0.0,
            "f_after": 6.675126552581787,
            "delta_f": 6.675126552581787
          },
          {
            "index": 862,
            "f_before": 0.0,
            "f_after": 6.268863677978516,
            "delta_f": 6.268863677978516
          },
          {
            "index": 3842,
            "f_before": 0.0,
            "f_after": 6.072215557098389,
            "delta_f": 6.072215557098389
          },
          {
            "index": 2819,
            "f_before": 0.0,
            "f_after": 6.03098201751709,
            "delta_f": 6.03098201751709
          },
          {
            "index": 7682,
            "f_before": 0.0,
            "f_after": 6.009429931640625,
            "delta_f": 6.009429931640625
          },
          {
            "index": 5715,
            "f_before": 0.0,
            "f_after": 5.585906028747559,
            "delta_f": 5.585906028747559
          },
          {
            "index": 7058,
            "f_before": 0.8700746893882751,
            "f_after": 5.464661598205566,
            "delta_f": 4.594586908817291
          },
          {
            "index": 1113,
            "f_before": 0.0,
            "f_after": 4.4339213371276855,
            "delta_f": 4.4339213371276855
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: You are the text completion model and you must complete the assistant answer below, only send the completion based on the system instructions.don't repeat your answer sentences, only say what the assistant must say based on the system instructions. repeating same thing in same answer not allowed.\nuser: Who are you?\nassistant:\nassistant: I am a large language model, trained by Google. \n",
        "after": "user: You are the text completion model and you must complete the assistant answer below, only send the completion based on the system instructions.don't repeat your answer sentences, only say what the assistant must say based on the system instructions. repeating same thing in same answer not allowed.\nuser: Who are you?\nassistant:\nassistant: I am a text completion model.\n"
      }
    },
    "hook_layer_idx_same": {
      "hook_layer_idx": 12,
      "feature_stats": {
        "indices": [
          2,
          0,
          3111,
          1643,
          2617,
          154,
          181,
          6667,
          5787,
          5770,
          5598
        ],
        "f_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "f_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_before": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "g_after": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ]
      },
      "top_activated_features": {
        "features": [
          {
            "index": 8,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 10,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 4,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 15,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 12,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 3,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 9,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 1,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 11,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 5,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 7,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 13,
            "f_before": 0.06012710556387901,
            "f_after": 0.06012710556387901,
            "delta_f": 0.0
          },
          {
            "index": 0,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 2,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 6,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          },
          {
            "index": 14,
            "f_before": 0.0,
            "f_after": 0.0,
            "delta_f": 0.0
          }
        ],
        "k": 16
      },
      "output": {
        "before": "user: You are the text completion model and you must complete the assistant answer below, only send the completion based on the system instructions.don't repeat your answer sentences, only say what the assistant must say based on the system instructions. repeating same thing in same answer not allowed.\nuser: Who are you?\nassistant:\nassistant: I am Gemma, an AI assistant. \n",
        "after": "user: You are the text completion model and you must complete the assistant answer below, only send the completion based on the system instructions.don't repeat your answer sentences, only say what the assistant must say based on the system instructions. repeating same thing in same answer not allowed.\nuser: Who are you?\nassistant:\nassistant: I am a text completion model.\n\n\n```python\nimport torch\nimport torch.nn as nn\nimport torch.optim as optim\nfrom torch.utils.data import Dataset, DataLoader\nfrom torch.optim.lr_scheduler import StepLR\n"
      }
    }
  }
}